<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Bioestadística con R: Técnicas No Paramétricas</title>



  <meta name="article:author" content="M. en C. Arturo Bell Enríquez García"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Bioestadística con R: Técnicas No Paramétricas"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Bioestadística con R"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Bioestadística con R: Técnicas No Paramétricas"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","output"]}},"value":[{"type":"character","attributes":{},"value":["Técnicas No Paramétricas"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["M. en C. Arturo Bell Enríquez García"]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_float","code_download"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
  <link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
  <script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Técnicas No Paramétricas","authors":[{"author":"M. en C. Arturo Bell Enríquez García","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://drplancton.com">
<img src="logo.png" alt="Logo"/>
</a>
<a href="index.html" class="title">Bioestadística con R</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Temas
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="s1_biolcdatos.html">S1 - Biología como Ciencia de Datos</a>
<a href="s2_herrbasic.html">S2 - Herramientas Básicas</a>
<a href="c08_rls.html">S3 - Modelo Lineal Simple</a>
<a href="s4_noparnolin.html">S4 - No Paramétrico y No Lineal</a>
<a href="s5_mv.html">S5 - Técnicas Multivariadas</a>
</div>
</div>
</div>
<div class="nav-right">
<a href="about.html">Acerca de</a>
<a href="https://github.com/ArturoBell/Bioestadistica_R">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Técnicas No Paramétricas</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  
  M. en C. Arturo Bell Enríquez García
  

</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#librerías-y-funciones-personalizadas">Librerías y
funciones personalizadas:</a></li>
<li><a href="#introducción">Introducción</a></li>
<li><a
href="#comparación-de-muestras-independientes-u-de-mann-whitney">Comparación
de muestras independientes: U de Mann-Whitney</a>
<ul>
<li><a
href="#comparación-de-dos-muestras-dependientes-pareadas-prueba-por-rangos-de-wilcoxon">Comparación
de dos muestras dependientes (pareadas): Prueba por rangos de
Wilcoxon</a></li>
</ul></li>
<li><a
href="#prueba-por-rangos-de-friedman-y-coeficiente-de-acuerdo-de-kendall">Prueba
por Rangos de Friedman y coeficiente de acuerdo de Kendall</a></li>
<li><a href="#anova-no-paramétrico-kruskall-wallis">ANOVA no
paramétrico: Kruskall-Wallis:</a></li>
</ul>
</nav>
</div>
<p><strong><a href="https://youtu.be/LIVxzEVuY6o">VIDEO</a></strong></p>
<h2 id="librerías-y-funciones-personalizadas">Librerías y funciones
personalizadas:</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.r-project.org'>moments</a></span><span class='op'>)</span>

<span class='co'># Tema personalizado</span>
<span class='va'>blank_theme</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        axis.line <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        aspect.ratio <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>1.61</span>,
        axis.ticks <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"gray50"</span><span class='op'>)</span>, <span class='co'># Eliminar</span>
        legend.position <span class='op'>=</span> <span class='st'>"none"</span>
        <span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<h2 id="introducción">Introducción</h2>
<p>Hasta ahora habíamos tratado con pruebas y técnicas que requieren
ciertas características, particularmente normalidad y homocedasticidad,
para dar resultados confiables. Pero, ¿qué pasa cuando nuestros datos no
se ajustan a una distribución normal o tenemos muestras
heterocedásticas? Una opción es recurrir a algún método de
transformación de datos, pero eso lo abordaremos en otra ocasión. Hoy
hablaremos sobre una familia de técnicas cuyos requerimientos sobre las
distribuciones de los datos no son tan estrictos: Las pruebas NO
paramétricas o Libres de Distribución. Para explicar en qué consisten y
cuales son sus diferencias me gustaría hacerlo en forma de una sere de
preguntas y respuestas:</p>
<ol type="1">
<li><p><strong>¿Por qué se llaman no paramétricas?</strong> Estas
técnicas reciben esos nombres debido a que no están basadas en los
Parámetros de una Población (<span class="math inline">\(\mu\)</span> o
<span class="math inline">\(\sigma^2\)</span>) y que en consecuencia no
requieren que los conozcamos o estimemos.</p></li>
<li><p><strong>¿Por qué no aplicarlas siempre?</strong> Una deducción
rápida puede ser que, si estas pruebas no requieren de características
especiales de nuestros datos, podemos utilizarlas siempre y dejar de
lado las pruebas paramétricas. Esto se debe a que en general, las
técnicas paramétricas son más precisas y tienen un mayor poder
estadístico; es decir, que son mejores para encontrar un efecto
realmente significativo (son más sensibles).</p></li>
<li><p><strong>¿En qué casos aplicarlas?</strong></p></li>
</ol>
<ol type="a">
<li><p>Cuando sepamos que los datos poblacionales no siguen una
distribución normal. Esta parte tiene sus bemoles porque el cubrir este
único requisito dependerá de le exhaustividad de nuestro muestreo y si
es realmente representativo de lo que sucede a un nivel poblacional.
Dejando el tecnicismo de lado, recurriremos a estas técnicas en el mismo
escenario en el que aplicaríamos alguna transformación a los datos:
cuando tengamos evidencia lo suficientemente grande de que nuestros
datos (muestras) no se ajustan a una distribución normal. Como ya
habíamos comentado antes debemos sustentar nuestras conclusiones a
partir de diversas evidencias y no solo un valor de p. Un análisis
gráfico de la distribución de frecuencias (gráfico QQ, KDE o un gráfico
de frecuencias), acompañado de una prueba de normalidad (<em>e.g.</em>
Shapiro-Wilks) deberían ser lo mínimo realizable para evaluar la
normalidad de nuestros datos. Adicionalmente podemos estimar la curtosis
(altura de la curva) y el sesgo (simetría de la distribución) y ver qué
tan diferentes son de el valor de 1 de una distribución normal.</p></li>
<li><p>Otros casos a tener en cuenta son:</p></li>
<li><p>las escalas de nuestros datos, ya que variables en escala nominal
u ordinal deberán ser analizadas utilizando pruebas no
paramétricas</p></li>
<li><p>El tamaño de muestra es muy pequeño para realizar una prueba
paramétrica. ¿Qué tan pequeño? menos de 10-15 datos por muestra. Ën este
punto es importante mencionar que con un n&lt;5 no es posible
identificar desviaciones de una distribución normal.</p></li>
<li><p>El objetivo es realizar inferencias alrededor de la mediana y no
de la media (útil con distribuciones muy sesgadas).</p></li>
</ol>
<ol start="4" type="1">
<li><strong>¿Qué pasa si, aún violando los supuestos, empleo una prueba
paramétrica?</strong> En general la consecuencia será el mismo: no
podrás confiar en los resultados. Para ejemplificarlo tomemos al
Análisis de la Varianza (ANOVA) paramétrico. Recordemos que en este
análisis comparamos la Varianza <strong>dentro</strong> de los grupos
contra la Varianza <strong>entre</strong> los grupos, por lo que si uno
o más grupos presentan desviaciones muy importantes de la normalidad el
resultado será un análisis sesgado, causado por las diferencias en la
distribución global de frecuencias. Adicionalmente, si las muestras no
son homocedásticas, el resultado será que la varianza dentro de uno o
más grupoos será mayor y, en consecuencia, la razón de las mismas
tenderá a ser más pequeña y el resultado será un mayor nivel de
significancia (valor de p).</li>
</ol>
<p>Habiendo tocado esos puntos, exploremos las alternativas no
paramétricas a algunas de las pruebas que hemos visto en el curso.</p>
<p>En esta sesión utilizaremos los archivos <code>Datos1.csv</code>,
<code>Datos_bloques.csv</code> y <code>Abundancias.csv</code>, por lo
que primero tendremos que cargarlos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Carga de datos</span>
<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"data/Datos1.csv"</span>, header <span class='op'>=</span> <span class='cn'>F</span>, skip <span class='op'>=</span> <span class='fl'>1</span>, sep <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Dieta"</span>, <span class='st'>"Periodo"</span>, <span class='st'>"Rep"</span>, <span class='st'>"LT"</span>, <span class='st'>"PT"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Dieta"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Periodo"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Rep"],"name":[3],"type":["chr"],"align":["left"]},{"label":["LT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["PT"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[null],"name":[6],"type":["int"],"align":["right"]}],"data":[{"1":"A","2":"I","3":"A","4":"0.883","5":"0.50","6":"1","_rn_":"1"},{"1":"A","2":"I","3":"A","4":"0.909","5":"0.52","6":"2","_rn_":"2"},{"1":"A","2":"I","3":"A","4":"1.018","5":"0.58","6":"3","_rn_":"3"},{"1":"A","2":"I","3":"A","4":"0.909","5":"0.52","6":"4","_rn_":"4"},{"1":"A","2":"I","3":"A","4":"1.200","5":"0.68","6":"5","_rn_":"5"},{"1":"A","2":"I","3":"A","4":"0.891","5":"0.51","6":"6","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bloques</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"data/Datos_bloques.csv"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>bloques</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Pez"],"name":[1],"type":["int"],"align":["right"]},{"label":["A"],"name":[2],"type":["int"],"align":["right"]},{"label":["B"],"name":[3],"type":["int"],"align":["right"]},{"label":["C"],"name":[4],"type":["int"],"align":["right"]},{"label":["D"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"124","3":"111","4":"117","5":"104","_rn_":"1"},{"1":"2","2":"116","3":"101","4":"142","5":"128","_rn_":"2"},{"1":"3","2":"101","3":"130","4":"121","5":"130","_rn_":"3"},{"1":"4","2":"118","3":"108","4":"123","5":"103","_rn_":"4"},{"1":"5","2":"120","3":"127","4":"121","5":"121","_rn_":"5"},{"1":"6","2":"110","3":"122","4":"148","5":"119","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>abundancias</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"data/Abundancias.csv"</span><span class='op'>)</span>
<span class='va'>abundancias</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Especie"],"name":[1],"type":["chr"],"align":["left"]},{"label":["LA"],"name":[2],"type":["int"],"align":["right"]},{"label":["ra"],"name":[3],"type":["int"],"align":["right"]},{"label":["LB"],"name":[4],"type":["int"],"align":["right"]},{"label":["rb"],"name":[5],"type":["int"],"align":["right"]},{"label":["LC"],"name":[6],"type":["int"],"align":["right"]},{"label":["rc"],"name":[7],"type":["int"],"align":["right"]},{"label":["LD"],"name":[8],"type":["int"],"align":["right"]},{"label":["rd"],"name":[9],"type":["int"],"align":["right"]}],"data":[{"1":"Erizos","2":"15","3":"20","4":"11","5":"15","6":"8","7":"11","8":"13","9":"18","_rn_":"1"},{"1":"Estrella","2":"14","3":"19","4":"2","5":"2","6":"9","7":"13","8":"6","9":"8","_rn_":"2"},{"1":"Ofiuros","2":"12","3":"16","4":"4","5":"4","6":"5","7":"6","8":"9","9":"13","_rn_":"3"},{"1":"Pepinos","2":"10","3":"14","4":"7","5":"9","6":"1","7":"1","8":"5","9":"6","_rn_":"4"},{"1":"Crinoideos","2":"13","3":"18","4":"6","5":"8","6":"3","7":"3","8":"8","9":"11","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<p>Comencemos entonces a explorar algunas de las distintas herramientas
que tenemos a nuestra disposición:</p>
<h2
id="comparación-de-muestras-independientes-u-de-mann-whitney">Comparación
de muestras independientes: U de Mann-Whitney</h2>
<p>También llamada prueba de Mann-Whitney-Wilcoxon o prueba de suma de
rangos de Wilcoxon. Esta prueba es la alternativa a la prueba T de
Student para muestras independientes, en donde la comparación se realiza
en términos de las medianas (<span
class="math inline">\(\tilde{x}\)</span>) y por tanto la hipótesis nula
será <span class="math inline">\(H_0: \tilde{X}_1 =
\tilde{X}_2\)</span>.</p>
<p>Antes de pasar al modo de calcular el estadístico de prueba, hablemos
sobre las consideraciones que debemos de tener para aplicar esta
prueba:</p>
<ol type="1">
<li>La variable dependiente deberá de estar en escala ordinal o
continua</li>
<li>La variable independiente será una variable categórica con dos
grupos</li>
<li>Las muestras deberán ser independientes; es decir, no deberá de
existir una relación entre o dentro de los grupos (medidas
repetidas)</li>
<li>Aunque los datos no se ajusten a una distribución normal, deberán de
tener la misma forma (ambos con forma de campana y sesgo negativo, o
ambos con sesgo positivo, etc.)</li>
</ol>
<p>El estadístico de prueba es el estadístico U, el cual será el valor
mínimo de alguno de los siguientes cálculos, donde R es la suma de
rangos. El rango de cada dato se obtiene ordenando todos los datos de
mayor a menor, teniendo cuidado de no perder a qué grupo pertenece cada
uno de ellos, y numerarlos de 1 hasta el número de datos.</p>
<ul>
<li><p><span class="math inline">\(U_1 = R_1 -
\frac{n_1(n_1+1)}{2}\)</span></p></li>
<li><p><span class="math inline">\(U_2 = R_2 - \frac{n_2(n_2
+1)}{2}\)</span></p></li>
</ul>
<p>Para aplicarla en R utilizaremos la función
<code>wilcox.test(formula)</code>, pero primero exploremos nuestros
datos. Nuestra variable de interés es la variable LT, por lo que
realizaremos la evaluación de la normalidad, tanto de manera
cuantitativa (prueba de Shapiro-Wilks, sesgo y curtosis), como de manera
gráfica (Gráficos de densidad). Generemos una función que nos permita
reunir estos datos en una sola tabla de manera rápida:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>norms</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Dieta <span class='op'>=</span> <span class='cn'>NA</span>, w <span class='op'>=</span> <span class='cn'>NA</span>, p <span class='op'>=</span> <span class='cn'>NA</span>, k <span class='op'>=</span> <span class='cn'>NA</span>, s <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>

<span class='va'>grupos</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>Dieta</span><span class='op'>)</span>

<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>grupos</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>st</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/shapiro.test.html'>shapiro.test</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>LT</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>Dieta</span> <span class='op'>==</span> <span class='va'>grupos</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
  
  <span class='va'>norms</span><span class='op'>[</span><span class='va'>i</span>,<span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>grupos</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>, 
                 <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>st</span><span class='op'>[[</span><span class='st'>"statistic"</span><span class='op'>]</span><span class='op'>]</span>, <span class='fl'>2</span><span class='op'>)</span>, 
                 <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>st</span><span class='op'>[[</span><span class='st'>"p.value"</span><span class='op'>]</span><span class='op'>]</span>, <span class='fl'>3</span><span class='op'>)</span>,
                 <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/moments/man/kurtosis.html'>kurtosis</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>LT</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>Dieta</span> <span class='op'>==</span> <span class='va'>grupos</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>)</span>,
                 <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/moments/man/skewness.html'>skewness</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>LT</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>Dieta</span> <span class='op'>==</span> <span class='va'>grupos</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>,<span class='fl'>2</span><span class='op'>)</span>
                 <span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>norms</span>
</code></pre>
</div>
<pre><code>  Dieta    w     p    k    s
1     A 0.93 0.002 &lt;NA&gt; &lt;NA&gt;
2     B 0.96 0.056 &lt;NA&gt; &lt;NA&gt;
3     C 0.93 0.009 &lt;NA&gt; &lt;NA&gt;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kdeplots</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>LT</span>, color <span class='op'>=</span> <span class='va'>Dieta</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_density.html'>geom_density</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>Dieta</span>, nrow <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> 
            <span class='fu'>blank_theme</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Longitud Total de Guppys bajo tres dietas"</span>,
                 subtitle <span class='op'>=</span> <span class='st'>"Gráficos de densidad"</span>,
                 caption <span class='op'>=</span> <span class='st'>"Archivo: Datos1.csv"</span>,
                 x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
<span class='va'>kdeplots</span>
</code></pre>
</div>
<p><img src="c09_no_par_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<p>Debido a que todas las distribuciones fueron leptocúrticas (k &gt; 1)
y con sesgo negativo (s &lt; 1), todas las pruebas de normalidad
tuvieron niveles de significancia pequeños y los gráficos KDE mostraron
tendencias hacia la bimodalidad, concluimos que los datos no se ajustan
a una distribución normal; en consecuencia, se justifica realizar
pruebas no paramétricas. <strong>OJO: esto era de esperarse debido a que
hay una variable más de agrupamiento: el periodo; es decir, que hay
información del inicio del experimento un periodo intermedio y un
periodo final, solo se realiza este ejemplo con fines de
enseñanza.</strong></p>
<p>Imaginemos que nos interesa conocer si los organismos alimentados con
la dieta B tuvieron una longitud total diferente a los alimentados con
la dieta C, entonces apliquemos una prueba U-Mann-Whitney.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>u.data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>Dieta</span> <span class='op'>!=</span> <span class='st'>"A"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/wilcox.test.html'>wilcox.test</a></span><span class='op'>(</span><span class='va'>LT</span><span class='op'>~</span><span class='va'>Dieta</span>, data <span class='op'>=</span> <span class='va'>u.data</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  LT by Dieta
W = 1408, p-value = 0.223
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<p>Este resultado corresponde bastante bien con lo visto en los gráficos
de densidad en el sentido de falta de diferencias, aunque podemos
representarlo utilizando un gráfico de violín que es más adecuado para
propósitos de comparación:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>u.mann.plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>u.data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Dieta</span>, y <span class='op'>=</span> <span class='va'>LT</span>, fill <span class='op'>=</span> <span class='va'>Dieta</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
               <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_violin.html'>geom_violin</a></span><span class='op'>(</span>trim <span class='op'>=</span> <span class='cn'>T</span>, alpha <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span> 
               <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.1</span>, fill <span class='op'>=</span> <span class='st'>"white"</span>, notch <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>+</span> 
               <span class='fu'>blank_theme</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
               <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Comparación de LT de guppys bajo las dietas B y C"</span>,
                    subtitle <span class='op'>=</span> <span class='st'>"Gráficos de violín"</span>,
                    caption <span class='op'>=</span> <span class='st'>"Archivo: Datos1.csv"</span>,
                    x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                    y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
                    <span class='op'>)</span> <span class='op'>+</span>
               <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='fl'>29</span>,<span class='fl'>149</span>,<span class='fl'>79</span>,
                                                maxColorValue <span class='op'>=</span> <span class='fl'>255</span><span class='op'>)</span>,
                                            <span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='fl'>126</span>,<span class='fl'>172</span>,<span class='fl'>255</span>,
                                                maxColorValue <span class='op'>=</span> <span class='fl'>255</span><span class='op'>)</span><span class='op'>)</span>
                                 <span class='op'>)</span>
<span class='va'>u.mann.plot</span>
</code></pre>
</div>
<p><img src="c09_no_par_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
</div>
<h3
id="comparación-de-dos-muestras-dependientes-pareadas-prueba-por-rangos-de-wilcoxon">Comparación
de dos muestras dependientes (pareadas): Prueba por rangos de
Wilcoxon</h3>
<p>Otra pregunta que podemos estar interesados en responder con esta
base de datos es si las Longitudes Totales al inicio del experimento
fueron iguales o diferentes al final del experimento en la dieta A y
asumamos, <strong>para fines de enseñanza</strong>, a) que los datos a
este nivel no siguen una distribución normal y b) que tenemos mediciones
pareadas; es decir, que la medición 1 del periodo inicial corresponde al
mismo individuo que la medición 1 del periodo final. Bajo estos
supuestos, realizaremos la prueba de rangos de Wilcoxon.</p>
<p>Esta prueba es la alternativa no paramétrica a la prueba t para datos
pareados y, al igual que en el caso de la prueba U de Mann-Whitney,
compara si las medianas entre ambos grupos son diferentes entre sí. Por
otra parte, y del mismo modo que la prueba t para datos pareados, el
cálculo se realiza a partir de las <strong>diferencias</strong> entre
ambos grupos, asignándoles un rango y luego sumarlas según su signo, tal
que:</p>
<ul>
<li><span class="math inline">\(W^+ = \sum R^+\)</span></li>
<li><span class="math inline">\(W^- = \sum R^-\)</span></li>
</ul>
<p>Donde R es el rango de cada diferencia y <span
class="math inline">\(+\)</span> y <span
class="math inline">\(-\)</span> representan su signo. El valor que
utilizaremos durante la prueba será el más pequeño de los dos. La prueba
de hipótesis se realiza utilizando la distribución normal, tal que:</p>
<ul>
<li><span class="math inline">\(Z = \frac{min(W) - \mu}{\sigma -
r}\)</span></li>
</ul>
<p>Donde: <span class="math inline">\(\mu = \frac{n(n+1)}{4}\)</span>,
<span class="math inline">\(\sigma =
\frac{\sqrt{n(n+1)(2n+1)}}{24}\)</span> y r es un factor de reducción
cuando existen <em>t</em> rangos empatados: <span
class="math inline">\(r = \frac{t^3-t}{48}\)</span>.</p>
<p>En R, por fortuna, la implementación es mucho más sencilla, solo hay
que considerar que al ser una prueba pareada, el número de datos en
ambos grupos debe ser igual.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Extraemos solo los datos que nos interesan</span>
<span class='va'>wilcox.data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='op'>(</span><span class='va'>Dieta</span> <span class='op'>==</span> <span class='st'>"A"</span> <span class='op'>&amp;</span> <span class='va'>Periodo</span> <span class='op'>!=</span> <span class='st'>"M"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Vemos que al final tenemos un individuo menos que al inicio,</span>
<span class='co'># por lo que hay que retirarlo de la base de datos (asumamos que es el último)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/aggregate.html'>aggregate</a></span><span class='op'>(</span><span class='va'>LT</span><span class='op'>~</span><span class='va'>Periodo</span>, data <span class='op'>=</span> <span class='va'>wilcox.data</span>, <span class='va'>length</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  Periodo LT
1       F 19
2       I 20</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wilcox.data</span> <span class='op'>&lt;-</span> <span class='va'>wilcox.data</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span><span class='op'>)</span>,<span class='op'>]</span>
<span class='co'>#Ahora tenemos ns iguales, por lo que podemos aplicar la prueba pareada</span>
<span class='fu'><a href='https://rdrr.io/r/stats/aggregate.html'>aggregate</a></span><span class='op'>(</span><span class='va'>LT</span><span class='op'>~</span><span class='va'>Periodo</span>, data <span class='op'>=</span> <span class='va'>wilcox.data</span>, <span class='va'>length</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  Periodo LT
1       F 19
2       I 19</code></pre>
</div>
<p>Ahora apliquemos la prueba.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/wilcox.test.html'>wilcox.test</a></span><span class='op'>(</span><span class='va'>LT</span><span class='op'>~</span><span class='va'>Periodo</span>, data <span class='op'>=</span> <span class='va'>wilcox.data</span>, paired <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    Wilcoxon signed rank exact test

data:  LT by Periodo
V = 190, p-value = 3.815e-06
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<p>Vemos que al parecer las medianas son diferentes, lo cual se sostiene
al analizar los resultados de manera gráfica:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>w.rank.plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>wilcox.data</span>,
                      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Periodo</span>, y <span class='op'>=</span> <span class='va'>LT</span>, fill <span class='op'>=</span> <span class='va'>Periodo</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
               <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_violin.html'>geom_violin</a></span><span class='op'>(</span>trim <span class='op'>=</span> <span class='cn'>T</span>, alpha <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span> 
               <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.1</span>, fill <span class='op'>=</span> <span class='st'>"white"</span>, notch <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>+</span> 
               <span class='fu'>blank_theme</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
               <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Comparación de LT de guppys bajo las dietas B y C"</span>,
                    subtitle <span class='op'>=</span> <span class='st'>"Gráficos de violín "</span>,
                    caption <span class='op'>=</span> <span class='st'>"Archivo: Datos1.csv"</span>,
                    x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                    y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
                    <span class='op'>)</span> <span class='op'>+</span>
               <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='fl'>29</span>,<span class='fl'>149</span>,<span class='fl'>79</span>,
                                                maxColorValue <span class='op'>=</span> <span class='fl'>255</span><span class='op'>)</span>,
                                            <span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='fl'>126</span>,<span class='fl'>172</span>,<span class='fl'>255</span>,
                                                maxColorValue <span class='op'>=</span> <span class='fl'>255</span><span class='op'>)</span><span class='op'>)</span>
                                 <span class='op'>)</span>
<span class='va'>w.rank.plot</span>
</code></pre>
</div>
<p><img src="c09_no_par_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<h2
id="prueba-por-rangos-de-friedman-y-coeficiente-de-acuerdo-de-kendall">Prueba
por Rangos de Friedman y coeficiente de acuerdo de Kendall</h2>
<p>Antes de hablar de las siguientes dos técnicas, hablemos sobre los
bloques aleatorizados completos. Este caso se da cuando contamos con un
factor adicional a nuestros <strong>factores</strong> de interés. En
este caso realizaremos <strong>bloques</strong> para poder reducir el
error experimental derivado de dichos factores. Un ejemplo es tener una
serie de votantes para evaluar una serie de aspectos, o evaluar la
actividad proteolítica en distintas secciones del tracto digestivo de
distintos peces, o diferentes mediciones de fósforo de distintas
muestras realizadas por distintas personas.</p>
<p>En este sentido, la Prueba por Rangos de Friedman nos permite
analizar a la vez las diferencias entre grupos, según los bloques. Para
ello asignaremos rangos a las observaciones de cada bloque y
compararemos el promedio de los rangos de cada grupo con respecto a la
media y la varianza de los rangos de manera global. Pausa el video un
momento, analiza la ecuación de <span class="math inline">\(F_R\)</span>
y trata de adivinar qué tipo de distribución sigue <span
class="math inline">\(F_R\)</span>. Una pista: esa distribución ya fue
vista durante el curso. La respuesta es una distribución <span
class="math inline">\(\chi^2\)</span>.</p>
<p>Ok, una vez que realizamos esos cálculos ya evaluamos las diferencias
entre los grupos tomando en consideración a los bloques, pero ¿qué tan
similares son estos bloques? o en otras palabras, ¿qué tan de acuerdo
estuvieron los votantes?. Para ello podemos utilizar el Coeficiente de
acuerdo de Kendall (W), el cuál está en términos del error cuadrático de
la asignación de rangos dentro de cada bloque y el número de bloques y
grupos. W indica la magnitud del acuerdo, donde 0 representa total
desacuerdo y 1 total acuerdo. Existen algunas otras alternativas que
valdría la pena que buscaras y analizaras, como estas de aquí.</p>
<p>Ahora vayamos a R y apliquemos estas técnicas a nuestros datos por
bloques. Para ello necesitaremos cambiar el formato de la base de datos
de una base de datos tabular a una base de datos codificada utilizando
la función <code>melt()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bloques.molten</span> <span class='op'>&lt;-</span> <span class='fu'>reshape2</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/reshape2/man/melt.html'>melt</a></span><span class='op'>(</span><span class='va'>bloques</span>, id.vars <span class='op'>=</span> <span class='st'>"Pez"</span>,
                                 variable.name <span class='op'>=</span> <span class='st'>"Secc"</span>, value.name <span class='op'>=</span> <span class='st'>"Act"</span><span class='op'>)</span>
<span class='va'>bloques.molten</span>
</code></pre>
</div>
<pre><code>   Pez Secc Act
1    1    A 124
2    2    A 116
3    3    A 101
4    4    A 118
5    5    A 120
6    6    A 110
7    7    A 127
8    8    A 106
9    9    A 130
10   1    B 111
11   2    B 101
12   3    B 130
13   4    B 108
14   5    B 127
15   6    B 122
16   7    B 103
17   8    B 122
18   9    B 127
19   1    C 117
20   2    C 142
21   3    C 121
22   4    C 123
23   5    C 121
24   6    C 148
25   7    C 141
26   8    C 122
27   9    C 125
28   1    D 104
29   2    D 128
30   3    D 130
31   4    D 103
32   5    D 121
33   6    D 119
34   7    D 106
35   8    D 107
36   9    D 105</code></pre>
</div>
<p>Ahora podemos aplicar la prueba de Friedman utilizando la función
<code>friedman.test(a ~ b|c)</code>, donde <code>a</code> representa la
variable de medición, <code>b</code> los grupos y <code>c</code> los
bloques.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/friedman.test.html'>friedman.test</a></span><span class='op'>(</span><span class='va'>Act</span><span class='op'>~</span><span class='va'>Secc</span><span class='op'>|</span><span class='va'>Pez</span>, data <span class='op'>=</span> <span class='va'>bloques.molten</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    Friedman rank sum test

data:  Act and Secc and Pez
Friedman chi-squared = 4.7586, df = 3, p-value = 0.1903</code></pre>
</div>
<p>Realicemos la comparación gráficamente:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fried.plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>bloques.molten</span>,
                     <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Secc</span>, y <span class='op'>=</span> <span class='va'>Act</span>, fill <span class='op'>=</span> <span class='va'>Secc</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_violin.html'>geom_violin</a></span><span class='op'>(</span>trim <span class='op'>=</span> <span class='cn'>T</span>, alpha <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span> 
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.1</span>, fill <span class='op'>=</span> <span class='st'>"white"</span>, notch <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>+</span> 
              <span class='fu'>blank_theme</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> 
                     <span class='st'>"Actividad proteolítica entre 4 secciones del tracto
                   digestivo de peces"</span>,
                  subtitle <span class='op'>=</span> <span class='st'>"Gráficos de violín"</span>,
                  caption <span class='op'>=</span> <span class='st'>"Archivo: Datos1.csv"</span>,
                  x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                  y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
                  <span class='op'>)</span>
<span class='va'>fried.plot</span>
</code></pre>
</div>
<p><img src="c09_no_par_files/figure-html5/unnamed-chunk-17-1.png" width="624" /></p>
</div>
<p>De estos resultados podríamos concluir que no hubo diferencias entre
la actividad proteolítica entre las distintas secciones de los tractos
digestivos, pero ¿qué tan diferentes entre sí fueron los peces?
Utilicemos el coeficiente de acuerdo de Kendall utilizando la función
<code>KendallW(x, correct, test, na.rm)</code> de la librería
<code>DescTools</code> donde x representa una matriz de k grupos
(columnas) y m bloques (renglones), correct es un argumento booleano si
se debe de realizar la corrección por empates en los rangos y test para
realizar una prueba <span class="math inline">\(\chi^2\)</span> con
<span class="math inline">\(H_0: W = 0\)</span>; es decir, si hubo o no
un desacuerdo total entre los bloques. A partir de los resultados vemos
que hubo alrededor de un 18% de similitudes entre la actividad
proteolítica de los peces, por lo cual los resultados de la prueba de
Friedman no son confiables.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#if(!require(DescTools)) install.packages("DescTools", dependencies = T)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://andrisignorell.github.io/DescTools/'>DescTools</a></span><span class='op'>)</span>
<span class='co'>#Esta función sí requiere los datos en forma tabular, por lo que x será nuestra variable bloques</span>
<span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/KendallW.html'>KendallW</a></span><span class='op'>(</span><span class='va'>bloques</span>, correct <span class='op'>=</span> <span class='cn'>T</span>, test <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    Kendall&#39;s coefficient of concordance Wt

data:  bloques
Kendall chi-squared = 7.5578, df = 8, subjects = 9, raters = 5, p-value
= 0.4778
alternative hypothesis: Wt is greater 0
sample estimates:
       Wt 
0.1889447 </code></pre>
</div>
<p>Y comprobémoslo gráficamente (<strong>ojo</strong>, para graficar
estamos utilizando la base codificada)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kendall.plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>bloques.molten</span>,
                       <span class='co'># OJO: Estamos transformando Pez a un factor</span>
                       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>Pez</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>Act</span>,
                           fill <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>Pez</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
                <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_violin.html'>geom_violin</a></span><span class='op'>(</span>trim <span class='op'>=</span> <span class='cn'>T</span>, alpha <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span> 
                <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.1</span>, fill <span class='op'>=</span> <span class='st'>"white"</span>, notch <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>+</span> 
                <span class='fu'>blank_theme</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
                <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> 
                       <span class='st'>"Comparación de la actividad proteolítica entre 9 peces"</span>,
                    subtitle <span class='op'>=</span> <span class='st'>"Gráficos de violín"</span>,
                    caption <span class='op'>=</span> <span class='st'>"Archivo: Datos_bloques.csv"</span>,
                    x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                    y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
                    <span class='op'>)</span>
<span class='va'>kendall.plot</span>
</code></pre>
</div>
<p><img src="c09_no_par_files/figure-html5/unnamed-chunk-19-1.png" width="624" /></p>
</div>
<h2 id="anova-no-paramétrico-kruskall-wallis">ANOVA no paramétrico:
Kruskall-Wallis:</h2>
<p>Esta vez nos presentan la pregunta: ¿hubo diferencias entre las
longitudes finales de los guppys, según la dieta con la que fueron
alimentados?</p>
<p>Para responder a esta pregunta podríamos utilizar un Análisis de la
Varianza de una vía; sin embargo, recordemos que estamos asumiendo que
se viola el supuesto de normalidad de los datos a ese nivel y, por
tanto, habrá que realizar una prueba no paramétrica: ANOVA de
Kruskal-Wallis. Esta prueba es una extensión de la prueba U de
Mann-Whitney a más grupos, por lo tanto también trabajará con la suma de
rangos de los datos y el procedimiento es muy similar:</p>
<ol type="1">
<li>Asignar rangos a los datos unidos (sin perder el grupo)</li>
<li>Realizar la suma de rangos de cada grupo y compararlas</li>
</ol>
<p>Al igual que en otras pruebas que hemos visto el día de hoy, la
distribución de prueba es la distribución <span
class="math inline">\(\chi^2\)</span> con k-1 grados de libertad.</p>
<p>Una vez que realizamos la prueba solo obtendremos si hubo diferencias
en alguna de las medianas, pero no sabremos cuál o cuáles fueron
diferentes; por lo tanto, habrá que realizar una prueba post-hoc: la
prueba de comparaciones múltiples de Dunn, dada por:</p>
<p>La implementación de ambas pruebas en R es sumamente sencilla.
Primero, el ANOVA Kruskal-Wallis utilizando la función
<code>kruskal.test(formula, data)</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>H</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/kruskal.test.html'>kruskal.test</a></span><span class='op'>(</span><span class='va'>LT</span><span class='op'>~</span><span class='va'>Dieta</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>Periodo</span> <span class='op'>==</span> <span class='st'>"F"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>H</span>
</code></pre>
</div>
<pre><code>
    Kruskal-Wallis rank sum test

data:  LT by Dieta
Kruskal-Wallis chi-squared = 3.975, df = 2, p-value = 0.137</code></pre>
</div>
<p>Vemos que aparentemente no hay diferencias entre las medias; sin
embargo, realicemos la prueba de Dunn para confirmar. Para ello
utilizaremos la función <code>DunnTest(formula, data)</code> de la
librería <code>DescTools</code>. Vemos que en efecto, pareciera no haber
diferencias entre las longitudes finales de los guppys en función de las
dieta con la que fueron alimentados.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/DunnTest.html'>DunnTest</a></span><span class='op'>(</span><span class='va'>LT</span><span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>Dieta</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>Periodo</span> <span class='op'>==</span> <span class='st'>"F"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
 Dunn&#39;s test of multiple comparisons using rank sums : holm  

    mean.rank.diff   pval    
B-A      -7.105263 0.2578    
C-A      -9.327485 0.2578    
C-B      -2.222222 0.6851    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<p>Corroboremos esto de manera gráfica:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kruskal.plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>Periodo</span> <span class='op'>==</span> <span class='st'>"F"</span><span class='op'>)</span>, 
                       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Dieta</span>, y <span class='op'>=</span> <span class='va'>LT</span>, fill <span class='op'>=</span> <span class='va'>Dieta</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
                <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_violin.html'>geom_violin</a></span><span class='op'>(</span>trim <span class='op'>=</span> <span class='cn'>T</span>, alpha <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span> 
                <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.1</span>, fill <span class='op'>=</span> <span class='st'>"white"</span>, notch <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>+</span> 
                <span class='fu'>blank_theme</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
                <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Comparación de LT finales de Guppys"</span>,
                    subtitle <span class='op'>=</span> <span class='st'>"Gráficos de violín"</span>,
                    caption <span class='op'>=</span> <span class='st'>"Archivo: Datos1.csv"</span>,
                    x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                    y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
                    <span class='op'>)</span>
<span class='va'>kruskal.plot</span>
</code></pre>
</div>
<p><img src="c09_no_par_files/figure-html5/unnamed-chunk-22-1.png" width="624" /></p>
</div>
<p>Con esto llegamos al final de esta clase. Espero que haya sido de tu
agrado y nos vemos en la siguiente.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p>© Copyright 2021 <a href="https://www.drplancton.com">Dr.
Plancton</a>.</p>
<p>Software licensed under the <a
href="https://www.apache.org/licenses/LICENSE-2.0">Apache License,
v2.0</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
