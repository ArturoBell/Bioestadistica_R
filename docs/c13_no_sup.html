<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Bioestadística con R: Agrupamientos y Reducción de la Dimensionalidad</title>



  <meta name="article:author" content="M. en C. Arturo Bell Enríquez García"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Bioestadística con R: Agrupamientos y Reducción de la Dimensionalidad"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Bioestadística con R"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Bioestadística con R: Agrupamientos y Reducción de la Dimensionalidad"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","output"]}},"value":[{"type":"character","attributes":{},"value":["Agrupamientos y Reducción de la Dimensionalidad"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["M. en C. Arturo Bell Enríquez García"]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_float"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Agrupamientos y Reducción de la Dimensionalidad","authors":[{"author":"M. en C. Arturo Bell Enríquez García","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://drplancton.com">
<img src="logo.png" alt="Logo"/>
</a>
<a href="index.html" class="title">Bioestadística con R</a>
<a href="temario.html">Temario</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Clases
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="s1_biolcdatos.html">S1 - Biología como Ciencia de Datos</a>
<a href="s2_herrbasic.html">S2 - Herramientas Básicas</a>
<a href="s3_rel_lin.html">S3 - Relaciones Lineales</a>
<a href="s4_noparnolin.html">S4 - No Paramétrico y No Lineal</a>
<a href="s5_mv.html">S5 - Técnicas Multivariadas</a>
</div>
</div>
</div>
<div class="nav-right">
<a href="about.html">Acerca de</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Agrupamientos y Reducción de la Dimensionalidad</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  
  M. en C. Arturo Bell Enríquez García
  

</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#funciones-personalizadas">Funciones personalizadas:</a></li>
<li><a href="#agrupamiento-jerárquico-clúster">Agrupamiento jerárquico (clúster)</a>
<ul>
<li><a href="#ejercicio-mv">Ejercicio Mv</a>
<ul>
<li><a href="#evaluación-de-los-agrupamientos">Evaluación de los agrupamientos</a></li>
</ul></li>
</ul></li>
<li><a href="#análisis-de-componentes-principales">Análisis de Componentes Principales</a>
<ul>
<li><a href="#evaluación-de-los-componentes-principales">Evaluación de los Componentes Principales</a></li>
</ul></li>
<li><a href="#escalamiento-multidimensional-no-métrico-nmds">Escalamiento Multidimensional No Métrico (NMDS)</a>
<ul>
<li><a href="#ejercicio">Ejercicio</a></li>
</ul></li>
</ul>
</nav>
</div>
<p><strong><a href="https://youtu.be/rJ2_STjvqx8">VIDEO</a></strong></p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="funciones-personalizadas">Funciones personalizadas:</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Tema personalizado</span>
<span class='va'>blank_theme</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>aspect.ratio</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>1.61</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        axis.line <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        aspect.ratio <span class='op'>=</span> <span class='va'>aspect.ratio</span>,
        axis.ticks <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"gray50"</span><span class='op'>)</span>, <span class='co'># Eliminar</span>
        legend.position <span class='op'>=</span> <span class='st'>"none"</span>
        <span class='op'>)</span>
<span class='op'>}</span>
<span class='co'># Función para la estimación de los CP óptimos:</span>

<span class='va'>evplot</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>ev</span><span class='op'>)</span><span class='op'>{</span>
    
    <span class='co'># Broken stick model (MacArthur 1957)</span>
      <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>ev</span><span class='op'>)</span>
      <span class='va'>bsm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>j<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>n</span><span class='op'>)</span>, p<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>
      <span class='va'>bsm</span><span class='op'>$</span><span class='va'>p</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>/</span><span class='va'>n</span> 
      <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>2</span><span class='op'>:</span><span class='va'>n</span><span class='op'>)</span> <span class='va'>bsm</span><span class='op'>$</span><span class='va'>p</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>bsm</span><span class='op'>$</span><span class='va'>p</span><span class='op'>[</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='va'>n</span> <span class='op'>+</span> <span class='fl'>1</span> <span class='op'>-</span> <span class='va'>i</span><span class='op'>)</span><span class='op'>)</span>
      <span class='va'>bsm</span><span class='op'>$</span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fl'>100</span><span class='op'>*</span><span class='va'>bsm</span><span class='op'>$</span><span class='va'>p</span><span class='op'>/</span><span class='va'>n</span>
    <span class='co'># Plot eigenvalues and % of variation for each axis</span>
      <span class='va'>op</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
      <span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>ev</span>, main<span class='op'>=</span><span class='st'>"Eigenvalues"</span>, col<span class='op'>=</span><span class='st'>"bisque"</span>, las<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
        <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>ev</span><span class='op'>)</span>, col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
        <span class='fu'><a href='https://rdrr.io/pkg/PerformanceAnalytics/man/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"topright"</span>, <span class='st'>"Average eigenvalue"</span>, lwd<span class='op'>=</span><span class='fl'>1</span>, col<span class='op'>=</span><span class='fl'>2</span>, bty<span class='op'>=</span><span class='st'>"n"</span><span class='op'>)</span>
      <span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>*</span><span class='va'>ev</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>ev</span><span class='op'>)</span>, <span class='va'>bsm</span><span class='op'>$</span><span class='va'>p</span><span class='op'>[</span><span class='va'>n</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>, beside<span class='op'>=</span><span class='cn'>TRUE</span>, 
              main<span class='op'>=</span><span class='st'>"% variation"</span>, col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"bisque"</span>,<span class='fl'>2</span><span class='op'>)</span>, las<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
        <span class='fu'><a href='https://rdrr.io/pkg/PerformanceAnalytics/man/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>"topright"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"% eigenvalue"</span>, <span class='st'>"Broken stick model"</span><span class='op'>)</span>, 
               pch<span class='op'>=</span><span class='fl'>15</span>, col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"bisque"</span>,<span class='fl'>2</span><span class='op'>)</span>, bty<span class='op'>=</span><span class='st'>"n"</span><span class='op'>)</span>
      <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>op</span><span class='op'>)</span>
  <span class='op'>}</span>
</code></pre>
</div>
</div>
<h1 id="agrupamiento-jerárquico-clúster">Agrupamiento jerárquico (clúster)</h1>
<p>Realizar un agrupamiento jerárquico en R es bastante sencillo, únicamente debemos de tener nuestro data.frame cuyos nombres de renglones sean las etiquetas de nuestras instancias a agrupar, calcular las distancias con la función <code>dist(x, method)</code> y unir los grupos con la función <code>hclust(dist, method)</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://cran.r-project.org'>vegan</a></span>, quietly <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>

<span class='va'>df1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>long <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>3.6</span>, <span class='fl'>6.5</span>, <span class='fl'>7.5</span>, <span class='fl'>15</span>, <span class='fl'>20</span><span class='op'>)</span>,
                  row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Tt"</span>, <span class='st'>"Gg"</span>, <span class='st'>"Gm"</span>, <span class='st'>"Oo"</span>, <span class='st'>"Mn"</span>, <span class='st'>"Bp"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dist.mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/dist.html'>dist</a></span><span class='op'>(</span><span class='va'>df1</span>, method <span class='op'>=</span> <span class='st'>"euclidean"</span><span class='op'>)</span>
<span class='va'>hc.av</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span><span class='op'>(</span><span class='va'>dist.mat</span>, method <span class='op'>=</span><span class='st'>"average"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Si graficamos este objeto tendremos un dendrograma muy sencillo:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span>, quietly <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/andrie/ggdendro'>ggdendro</a></span>, quietly <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/ggdendro/man/ggdendrogram.html'>ggdendrogram</a></span><span class='op'>(</span><span class='va'>hc.av</span>, labels <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-4-1.png" width="624" /></p>
</div>
<p>Podemos personalizar el dendrograma utilizando la función <code>set(object, what, value)</code> de la librería <code>dendextend</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://talgalili.github.io/dendextend/'>dendextend</a></span><span class='op'>)</span>
<span class='co'># Primero transformemos nuestro objeto a un dendrograma:</span>
<span class='va'>dend</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span><span class='op'>(</span><span class='va'>hc.av</span><span class='op'>)</span>

<span class='co'># Cambiemos el color a las ramas:</span>
<span class='va'>dend</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/set.html'>set</a></span><span class='op'>(</span><span class='va'>dend</span>, <span class='st'>"branches_k_color"</span>,
            value <span class='op'>=</span> <span class='st'>"deepskyblue4"</span>,
            k <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='co'>#dend &lt;- set(dend, "branches_k_color",</span>
<span class='co'>#            value = c(rgb(0,118, 186, maxColorValue = 255),</span>
<span class='co'>#                      rgb(0, 123, 118, maxColorValue = 255),</span>
<span class='co'>#                      rgb(255, 147, 0, maxColorValue = 255),</span>
<span class='co'>#                      rgb(181, 23, 0, maxColorValue = 255)), </span>
<span class='co'>#            k = 4)</span>
<span class='va'>dend</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/set.html'>set</a></span><span class='op'>(</span><span class='va'>dend</span>, <span class='st'>"branches_lwd"</span>, <span class='fl'>1</span><span class='op'>)</span>

<span class='co'># Cambiemos el color de las etiquetas:</span>
<span class='va'>dend</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/set.html'>set</a></span><span class='op'>(</span><span class='va'>dend</span>, <span class='st'>"labels_col"</span>,
            value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>118</span>, <span class='fl'>186</span>, maxColorValue <span class='op'>=</span> <span class='fl'>255</span><span class='op'>)</span>,
                      <span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>123</span>, <span class='fl'>118</span>, maxColorValue <span class='op'>=</span> <span class='fl'>255</span><span class='op'>)</span>,
                      <span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='fl'>255</span>, <span class='fl'>147</span>, <span class='fl'>0</span>, maxColorValue <span class='op'>=</span> <span class='fl'>255</span><span class='op'>)</span>,
                      <span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='fl'>181</span>, <span class='fl'>23</span>, <span class='fl'>0</span>, maxColorValue <span class='op'>=</span> <span class='fl'>255</span><span class='op'>)</span><span class='op'>)</span>, 
            k <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>

<span class='co'># Graficador base de R:</span>
<span class='fu'><a href='https://rdrr.io/pkg/pROC/man/plot.roc.html'>plot</a></span><span class='op'>(</span><span class='va'>dend</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<p>Por homogeneidad con el resto del curso, grafiquémoslo utilizando <code>ggplot2</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ggd1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/ggdend.html'>as.ggdend</a></span><span class='op'>(</span><span class='va'>dend</span><span class='op'>)</span>
<span class='va'>ggd1.plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>ggd1</span>, offset_labels <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>, theme <span class='op'>=</span> <span class='fu'>blank_theme</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.4</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='http://talgalili.github.io/dendextend/reference/get_branches_heights.html'>get_branches_heights</a></span><span class='op'>(</span><span class='va'>dend</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Dendrograma de especies de cetáceos"</span>,
                  subtitle <span class='op'>=</span> <span class='st'>"Agrupamientos por longitud (método: promedio)"</span>,
                  x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                  y <span class='op'>=</span> <span class='st'>"Distancia euclidiana"</span>,
                  caption <span class='op'>=</span> <span class='st'>"Datos de bit.ly/clust_medium"</span><span class='op'>)</span>

<span class='va'>ggd1.plot</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-6-1.png" width="624" /></p>
</div>
<h2 id="ejercicio-mv">Ejercicio Mv</h2>
<p>Habiendo comprendido cómo funciona el análisis de agrupamientos, apliquémoslo a una base de datos multivariada (<code>cluster.txt</code>), la cual consiste en mediciones de variables ambientales en distintos sitios de muestreo y el objetivo es agrupar aquellos que tengan características similares. En el resumen podemos ver que hay diferencias muy importantes en las escalas de las variables, por lo cual será necesario escalar los datos.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>clust.df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></span><span class='op'>(</span><span class='st'>"data/cluster.txt"</span>,
                       header <span class='op'>=</span> <span class='cn'>T</span>, row.names <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='co'># ¡OJO con row.names!</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>clust.df</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>      Temp            NH4             NO3              OD             Prof    
 Min.   :16.90   Min.   :0.540   Min.   :0.400   Min.   :0.810   Min.   : 27  
 1st Qu.:18.20   1st Qu.:0.900   1st Qu.:1.830   1st Qu.:2.650   1st Qu.: 76  
 Median :19.60   Median :0.980   Median :2.500   Median :3.800   Median :122  
 Mean   :20.31   Mean   :1.047   Mean   :2.394   Mean   :4.103   Mean   :109  
 3rd Qu.:21.40   3rd Qu.:1.250   3rd Qu.:3.120   3rd Qu.:5.840   3rd Qu.:148  
 Max.   :25.80   Max.   :1.570   Max.   :4.210   Max.   :8.010   Max.   :199  
     Trans            Caud             SST              STD       
 Min.   : 4.00   Min.   : 0.520   Min.   :   4.0   Min.   : 86.9  
 1st Qu.: 6.00   1st Qu.: 1.960   1st Qu.:  50.0   1st Qu.:101.5  
 Median :10.00   Median : 5.580   Median : 134.0   Median :104.3  
 Mean   :17.62   Mean   : 5.877   Mean   : 254.3   Mean   :108.7  
 3rd Qu.:18.00   3rd Qu.: 8.100   3rd Qu.: 298.7   3rd Qu.:113.7  
 Max.   :56.00   Max.   :15.440   Max.   :1163.3   Max.   :137.7  
      PO4             DBO5            DQO       
 Min.   :0.000   Min.   :20.21   Min.   : 5.00  
 1st Qu.:0.250   1st Qu.:21.29   1st Qu.:16.00  
 Median :0.400   Median :23.27   Median :32.00  
 Mean   :0.391   Mean   :27.45   Mean   :32.52  
 3rd Qu.:0.600   3rd Qu.:32.62   3rd Qu.:50.00  
 Max.   :0.870   Max.   :59.82   Max.   :62.00  </code></pre>
</div>
<p>Otro problema, tal vez no tan evidente, es que la distribución de SST se encuentra sumamente sesgada, por lo que habrá que a) aplicar una transformación para normalizar los datos, b) retirarla del análisis. Tomando en cuenta los valores, es bastante probable que las mediciones estén equivocadas, por lo que la retiraremos del análisis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mask</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>clust.df</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>clust.df</span><span class='op'>)</span> <span class='op'>!=</span> <span class='st'>"SST"</span><span class='op'>]</span>
<span class='va'>clust.filt</span> <span class='op'>&lt;-</span> <span class='va'>clust.df</span><span class='op'>[</span>,<span class='va'>mask</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>clust.filt</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1] &quot;Temp&quot;  &quot;NH4&quot;   &quot;NO3&quot;   &quot;OD&quot;    &quot;Prof&quot;  &quot;Trans&quot; &quot;Caud&quot;  &quot;STD&quot;   &quot;PO4&quot;  
[10] &quot;DBO5&quot;  &quot;DQO&quot;  </code></pre>
</div>
<p>Ahora escalemos todos nuestros datos. Al analizar rápidamente la distribución de cada una de las variables podemos ver que hay algunas con sesgos que pudieran ser importantes; sin embargo, podemos utilizar una medida de distancia que contienda con este tipo de distribuciones para evitar una transformación más agresiva que el escalamiento.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>clust.scale</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>clust.filt</span><span class='op'>)</span>
<span class='co'>#clust.scale &lt;- log(clust.filt +1) # "normalizar" los datos</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>clust.scale</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>      Temp             NH4               NO3                OD         
 Min.   :-1.315   Min.   :-1.8357   Min.   :-1.9515   Min.   :-1.4896  
 1st Qu.:-0.814   1st Qu.:-0.5326   1st Qu.:-0.5518   1st Qu.:-0.6573  
 Median :-0.275   Median :-0.2430   Median : 0.1039   Median :-0.1370  
 Mean   : 0.000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000  
 3rd Qu.: 0.418   3rd Qu.: 0.7343   3rd Qu.: 0.7108   3rd Qu.: 0.7859  
 Max.   : 2.112   Max.   : 1.8926   Max.   : 1.7776   Max.   : 1.7675  
      Prof             Trans              Caud               STD         
 Min.   :-1.5885   Min.   :-0.8294   Min.   :-1.19044   Min.   :-1.4307  
 1st Qu.:-0.6393   1st Qu.:-0.7076   1st Qu.:-0.87045   1st Qu.:-0.4734  
 Median : 0.2518   Median :-0.4640   Median :-0.06603   Median :-0.2898  
 Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000  
 3rd Qu.: 0.7555   3rd Qu.: 0.0232   3rd Qu.: 0.49395   3rd Qu.: 0.3266  
 Max.   : 1.7435   Max.   : 2.3373   Max.   : 2.12502   Max.   : 1.9003  
      PO4                DBO5              DQO          
 Min.   :-1.45097   Min.   :-0.7880   Min.   :-1.43661  
 1st Qu.:-0.52313   1st Qu.:-0.6704   1st Qu.:-0.86246  
 Median : 0.03358   Median :-0.4548   Median :-0.02734  
 Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.00000  
 3rd Qu.: 0.77585   3rd Qu.: 0.5631   3rd Qu.: 0.91217  
 Max.   : 1.77792   Max.   : 3.5244   Max.   : 1.53851  </code></pre>
</div>
<p>Ahora realicemos los agrupamientos. Utilizaremos la distancia Mahalanobis ya que esta no es tan sensible a los valores extremos. El método de agrupamiento será ward.D2, (distancias cuadráticas) para minimizar la varianza intra-grupos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist.mv1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/vegan/man/vegdist.html'>vegdist</a></span><span class='op'>(</span><span class='va'>clust.scale</span>, method <span class='op'>=</span> <span class='st'>"mahalanobis"</span><span class='op'>)</span>
<span class='va'>hc.mv1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span><span class='op'>(</span><span class='va'>dist.mv1</span>, method <span class='op'>=</span><span class='st'>"ward.D2"</span><span class='op'>)</span>

<span class='co'># Transformemos nuestro objeto a un dendrograma:</span>
<span class='va'>dend.mv1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span><span class='op'>(</span><span class='va'>hc.mv1</span><span class='op'>)</span>

<span class='co'># Cambiemos el color a las ramas:</span>
<span class='va'>dend.mv1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/set.html'>set</a></span><span class='op'>(</span><span class='va'>dend.mv1</span>, <span class='st'>"branches_k_color"</span>,
            value <span class='op'>=</span> <span class='st'>"deepskyblue4"</span>,
            k <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='va'>dend.mv1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/set.html'>set</a></span><span class='op'>(</span><span class='va'>dend.mv1</span>, <span class='st'>"branches_lwd"</span>, <span class='fl'>0.7</span><span class='op'>)</span>

<span class='va'>ggd1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/ggdend.html'>as.ggdend</a></span><span class='op'>(</span><span class='va'>dend.mv1</span><span class='op'>)</span>
<span class='va'>ggd1.plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>ggd1</span>, offset_labels <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>, theme <span class='op'>=</span> <span class='fu'>blank_theme</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expand_limits.html'>expand_limits</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>2.4</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span>
                                  <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='http://talgalili.github.io/dendextend/reference/get_branches_heights.html'>get_branches_heights</a></span><span class='op'>(</span><span class='va'>dend.mv1</span><span class='op'>)</span><span class='op'>)</span>,
                                      <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Dendrograma de sitios de muestreo"</span>,
                  subtitle <span class='op'>=</span> <span class='st'>"Método de agrupamiento: Ward.D2"</span>,
                  x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                  y <span class='op'>=</span> <span class='st'>"Distancia Mahalanobis"</span>,
                  caption <span class='op'>=</span> <span class='st'>"Datos: clust.txt"</span><span class='op'>)</span>

<span class='va'>ggd1.plot</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-10-1.png" width="624" /></p>
</div>
<p>Los agrupamientos con esa combinación de distancia y método de agrupamiento no son claros, veamos qué pasa si consideramos la distancia euclidiana:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist.mv2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/vegan/man/vegdist.html'>vegdist</a></span><span class='op'>(</span><span class='va'>clust.scale</span>, method <span class='op'>=</span> <span class='st'>"euclidean"</span><span class='op'>)</span>
<span class='va'>hc.mv2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span><span class='op'>(</span><span class='va'>dist.mv2</span>, method <span class='op'>=</span><span class='st'>"ward.D2"</span><span class='op'>)</span>

<span class='co'># Transformemos nuestro objeto a un dendrograma:</span>
<span class='va'>dend.mv2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span><span class='op'>(</span><span class='va'>hc.mv2</span><span class='op'>)</span>

<span class='co'># Cambiemos el color a las ramas:</span>
<span class='va'>dend.mv2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/set.html'>set</a></span><span class='op'>(</span><span class='va'>dend.mv2</span>, <span class='st'>"branches_k_color"</span>,
            value <span class='op'>=</span> <span class='st'>"deepskyblue4"</span>,
            k <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='va'>dend.mv2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/set.html'>set</a></span><span class='op'>(</span><span class='va'>dend.mv2</span>, <span class='st'>"branches_lwd"</span>, <span class='fl'>0.7</span><span class='op'>)</span>

<span class='va'>ggd2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/ggdend.html'>as.ggdend</a></span><span class='op'>(</span><span class='va'>dend.mv2</span><span class='op'>)</span>
<span class='va'>ggd2.plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>ggd2</span>, offset_labels <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>, theme <span class='op'>=</span> <span class='fu'>blank_theme</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expand_limits.html'>expand_limits</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>2.4</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> 
                                  <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,
                                      <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='http://talgalili.github.io/dendextend/reference/get_branches_heights.html'>get_branches_heights</a></span><span class='op'>(</span><span class='va'>dend.mv2</span><span class='op'>)</span><span class='op'>)</span>,
                                      <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Dendrograma de sitios de muestreo"</span>,
                  subtitle <span class='op'>=</span> <span class='st'>"Método de agrupamiento: Ward.D2"</span>,
                  x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                  y <span class='op'>=</span> <span class='st'>"Distancia Euclidiana"</span>,
                  caption <span class='op'>=</span> <span class='st'>"Datos: clust.txt"</span><span class='op'>)</span>

<span class='va'>ggd2.plot</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
</div>
<p>¿Y la distancia Manhattan? Las agrupaciones resultantes son similares; sin embargo, las medidas de distancia son muy diferentes. Utilicemos el caso anterior para evaluar las agrupaciones.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dist.mv3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/vegan/man/vegdist.html'>vegdist</a></span><span class='op'>(</span><span class='va'>clust.scale</span>, method <span class='op'>=</span> <span class='st'>"manhattan"</span><span class='op'>)</span>
<span class='va'>hc.mv3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span><span class='op'>(</span><span class='va'>dist.mv3</span>, method <span class='op'>=</span><span class='st'>"ward.D2"</span><span class='op'>)</span>

<span class='co'># Transformemos nuestro objeto a un dendrograma:</span>
<span class='va'>dend.mv3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span><span class='op'>(</span><span class='va'>hc.mv3</span><span class='op'>)</span>

<span class='co'># Cambiemos el color a las ramas:</span>
<span class='va'>dend.mv3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/set.html'>set</a></span><span class='op'>(</span><span class='va'>dend.mv3</span>, <span class='st'>"branches_k_color"</span>,
            value <span class='op'>=</span> <span class='st'>"deepskyblue4"</span>,
            k <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='va'>dend.mv3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/set.html'>set</a></span><span class='op'>(</span><span class='va'>dend.mv3</span>, <span class='st'>"branches_lwd"</span>, <span class='fl'>0.7</span><span class='op'>)</span>

<span class='va'>ggd3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/ggdend.html'>as.ggdend</a></span><span class='op'>(</span><span class='va'>dend.mv3</span><span class='op'>)</span>
<span class='va'>ggd3.plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>ggd3</span>, offset_labels <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>, theme <span class='op'>=</span> <span class='fu'>blank_theme</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expand_limits.html'>expand_limits</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>3.5</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span>
                                  <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='http://talgalili.github.io/dendextend/reference/get_branches_heights.html'>get_branches_heights</a></span><span class='op'>(</span><span class='va'>dend.mv3</span><span class='op'>)</span><span class='op'>)</span>,
                                             <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Dendrograma de sitios de muestreo"</span>,
                  subtitle <span class='op'>=</span> <span class='st'>"Método de agrupamiento: Ward.D2)"</span>,
                  x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                  y <span class='op'>=</span> <span class='st'>"Distancia Manhattan"</span>,
                  caption <span class='op'>=</span> <span class='st'>"Datos: clust.txt"</span><span class='op'>)</span>

<span class='va'>ggd3.plot</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<h3 id="evaluación-de-los-agrupamientos">Evaluación de los agrupamientos</h3>
<p>Para calcular los índices que estiman el número óptimo de agrupaciones utilizaremos la función <code>NbClust</code> de la librería con el mismo nombre.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://sites.google.com/site/malikacharrad/research/nbclust-package'>NbClust</a></span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/NbClust/man/NbClust.html'>NbClust</a></span><span class='op'>(</span><span class='va'>clust.scale</span>, diss <span class='op'>=</span> <span class='cn'>NULL</span>,
               distance <span class='op'>=</span> <span class='st'>"euclidean"</span>, method <span class='op'>=</span> <span class='st'>"ward.D2"</span>,
               index <span class='op'>=</span> <span class='st'>"all"</span>, max.nc <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
<pre><code>*** : The Hubert index is a graphical method of determining the number of clusters.
                In the plot of Hubert index, we seek a significant knee that corresponds to a 
                significant increase of the value of the measure i.e the significant peak in Hubert
                index second differences plot. 
 </code></pre>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-13-2.png" width="624" /></p>
<pre><code>*** : The D index is a graphical method of determining the number of clusters. 
                In the plot of D index, we seek a significant knee (the significant peak in Dindex
                second differences plot) that corresponds to a significant increase of the value of
                the measure. 
 
******************************************************************* 
* Among all indices:                                                
* 4 proposed 2 as the best number of clusters 
* 11 proposed 3 as the best number of clusters 
* 1 proposed 5 as the best number of clusters 
* 2 proposed 7 as the best number of clusters 
* 5 proposed 8 as the best number of clusters 

                   ***** Conclusion *****                            
 
* According to the majority rule, the best number of clusters is  3 
 
 
******************************************************************* </code></pre>
</div>
<p>Veamos ahora los grupos y calculemos el coeficiente de correlación cofenético. Una correlación de prácticamente el 70% es más que aceptable, si consideramos que no filtramos la totalidad de los datos. Como dato curioso, al aplicar una transformación logarítmica se mantienen estos grupos pero el coeficiente de correlación cofenético se eleva a 0.8.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>res</span><span class='op'>$</span><span class='va'>Best.partition</span>
</code></pre>
</div>
<pre><code> S1  S2  S3  S4  S5  S6  S7  S8  S9 S10 S11 S12 S13 S14 S15 S16 S17 S18 S19 S20 
  1   1   1   1   2   2   2   2   2   2   2   1   2   2   2   3   3   2   3   3 
S21 
  3 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hc.e</span> <span class='op'>&lt;-</span> <span class='fu'>cluster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/cluster/man/agnes.html'>agnes</a></span><span class='op'>(</span><span class='va'>dist.mv2</span>, diss <span class='op'>=</span> <span class='cn'>T</span>, method <span class='op'>=</span> <span class='st'>"ward"</span><span class='op'>)</span>
<span class='co'># Distancias en el dendrograma</span>
<span class='va'>ccc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cophenetic.html'>cophenetic</a></span><span class='op'>(</span><span class='va'>hc.e</span><span class='op'>)</span>
<span class='co'># Correlación entre distancias reales y graficadas</span>
<span class='va'>ccofen</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>dist.mv2</span>, <span class='va'>ccc</span>, method <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span> 
<span class='va'>ccofen</span>
</code></pre>
</div>
<pre><code>[1] 0.6868661</code></pre>
</div>
<p>Esta forma de ver los agrupamientos no es muy clara, entonces agreguémosla a nuestro gráfico mediante colores de las ramas y etiquetas:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Cambiamos el color de nuestr</span>
<span class='va'>dend.mv2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/set.html'>set</a></span><span class='op'>(</span><span class='va'>dend.mv2</span>, <span class='st'>"labels_col"</span>,
                value <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>,
                k <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>

<span class='va'>dend.mv2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/set.html'>set</a></span><span class='op'>(</span><span class='va'>dend.mv2</span>, <span class='st'>"branches_k_color"</span>,
            value <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>,
            k <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>          
          
<span class='va'>dend.mv2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/set.html'>set</a></span><span class='op'>(</span><span class='va'>dend.mv2</span>, <span class='st'>"branches_lwd"</span>, <span class='fl'>0.7</span><span class='op'>)</span>

<span class='va'>ggd2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://talgalili.github.io/dendextend/reference/ggdend.html'>as.ggdend</a></span><span class='op'>(</span><span class='va'>dend.mv2</span><span class='op'>)</span>
<span class='va'>ggd2.plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>ggd2</span>, offset_labels <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>, theme <span class='op'>=</span> <span class='fu'>blank_theme</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/expand_limits.html'>expand_limits</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='op'>-</span><span class='fl'>2.4</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='http://talgalili.github.io/dendextend/reference/get_branches_heights.html'>get_branches_heights</a></span><span class='op'>(</span><span class='va'>dend.mv2</span><span class='op'>)</span><span class='op'>)</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Dendrograma de sitios de muestreo"</span>,
                  subtitle <span class='op'>=</span> <span class='st'>"Método de agrupamiento: Ward.D2"</span>,
                  x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                  y <span class='op'>=</span> <span class='st'>"Distancia Euclidiana"</span>,
                  caption <span class='op'>=</span> <span class='st'>"Datos: clust.txt"</span><span class='op'>)</span>

<span class='va'>ggd2.plot</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-15-1.png" width="624" /></p>
</div>
<strong>Guardado de figuras!!!</strong>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#cairo_pdf("dendrogram.pdf", width = 8, height = 8)</span>
<span class='va'>ggd2.plot</span>
</code></pre>
</div>
<img src="c13_no_sup_files/figure-html5/unnamed-chunk-16-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#dev.off()</span>
</code></pre>
</div>
</div>
<p>¿Cómo lo interpretamos? Hay que revisar la base de datos para evitar caer en interpretaciones incorrectas y analizar qué características conforman cada grupo.</p>
<h1 id="análisis-de-componentes-principales">Análisis de Componentes Principales</h1>
<p>Por fin llegó la hora de hablar del Análisis de Componentes Principales. Vimos que esta técnica nos permite aproximar nuestros datos multivariados utilizando nuevas variables llamadas Componentes Principales, las cuales son ortogonales (independientes) entre sí. Apliquemos el Análisis de componentes principales a una base de datos con una gran cantidad de variables:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.sthda.com/english/rpkgs/factoextra'>factoextra</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://factominer.free.fr'>FactoMineR</a></span><span class='op'>)</span>
<span class='co'>#Base de datos completa</span>
  
<span class='va'>x1n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></span><span class='op'>(</span><span class='st'>'data/Medidas.txt'</span>, header <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='co'>#Base de datos sin nombres de especies</span>

<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='va'>x1n</span><span class='op'>[</span> ,<span class='fl'>2</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x1n</span><span class='op'>)</span> <span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>x1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     furcal            base             radio              alto        
 Min.   :0.2527   Min.   :0.07088   Min.   :0.04408   Min.   :0.05319  
 1st Qu.:0.2716   1st Qu.:0.09108   1st Qu.:0.06748   1st Qu.:0.06709  
 Median :0.2753   Median :0.09679   Median :0.07090   Median :0.07140  
 Mean   :0.2757   Mean   :0.09645   Mean   :0.07048   Mean   :0.07116  
 3rd Qu.:0.2801   3rd Qu.:0.10142   3rd Qu.:0.07430   3rd Qu.:0.07534  
 Max.   :0.3202   Max.   :0.11394   Max.   :0.08311   Max.   :0.09723  
     gordo             angos              ojo             X1erarc       
 Min.   :0.02679   Min.   :0.02996   Min.   :0.02142   Min.   :0.03485  
 1st Qu.:0.04139   1st Qu.:0.03465   1st Qu.:0.02451   1st Qu.:0.04332  
 Median :0.04402   Median :0.03577   Median :0.02673   Median :0.05129  
 Mean   :0.04405   Mean   :0.03616   Mean   :0.02740   Mean   :0.05158  
 3rd Qu.:0.04680   3rd Qu.:0.03745   3rd Qu.:0.02875   3rd Qu.:0.05899  
 Max.   :0.05859   Max.   :0.04727   Max.   :0.08191   Max.   :0.07738  
     dist.              largo              cabez             hueso        
 Min.   :0.007179   Min.   :0.004202   Min.   :0.07311   Min.   :0.02857  
 1st Qu.:0.030485   1st Qu.:0.022402   1st Qu.:0.08476   1st Qu.:0.03236  
 Median :0.035368   Median :0.029488   Median :0.08951   Median :0.03415  
 Mean   :0.031366   Mean   :0.026533   Mean   :0.08860   Mean   :0.03488  
 3rd Qu.:0.038824   3rd Qu.:0.034574   3rd Qu.:0.09284   3rd Qu.:0.03582  
 Max.   :0.048008   Max.   :0.051843   Max.   :0.09815   Max.   :0.10411  
     mandib           hueso.1            arriba            cabeza       
 Min.   :0.03141   Min.   :0.02348   Min.   :0.01855   Min.   :0.07118  
 1st Qu.:0.03598   1st Qu.:0.03917   1st Qu.:0.02546   1st Qu.:0.08309  
 Median :0.03980   Median :0.04413   Median :0.02952   Median :0.08796  
 Mean   :0.03923   Mean   :0.04498   Mean   :0.02946   Mean   :0.08890  
 3rd Qu.:0.04247   3rd Qu.:0.04995   3rd Qu.:0.03391   3rd Qu.:0.09483  
 Max.   :0.04758   Max.   :0.08783   Max.   :0.03828   Max.   :0.10760  
      boca             abiert           cachete           largo.1        
 Min.   :0.02828   Min.   :0.01810   Min.   :0.02938   Min.   :0.008724  
 1st Qu.:0.03476   1st Qu.:0.02348   1st Qu.:0.03911   1st Qu.:0.012881  
 Median :0.03830   Median :0.02531   Median :0.04308   Median :0.014240  
 Mean   :0.03954   Mean   :0.02547   Mean   :0.04237   Mean   :0.014366  
 3rd Qu.:0.04368   3rd Qu.:0.02741   3rd Qu.:0.04508   3rd Qu.:0.015936  
 Max.   :0.05552   Max.   :0.03248   Max.   :0.06553   Max.   :0.026475  
     ancho            orificio           densi            hocic        
 Min.   :0.00274   Min.   :0.01968   Min.   :0.6990   Min.   :0.01546  
 1st Qu.:0.02663   1st Qu.:0.03741   1st Qu.:0.7782   1st Qu.:0.02491  
 Median :0.03031   Median :0.04381   Median :0.8451   Median :0.02929  
 Mean   :0.03253   Mean   :0.04429   Mean   :0.8401   Mean   :0.02937  
 3rd Qu.:0.03447   3rd Qu.:0.05085   3rd Qu.:0.9031   3rd Qu.:0.03294  
 Max.   :0.22628   Max.   :0.07390   Max.   :1.1139   Max.   :0.04922  
    interbr            ojoatra            proye              base.1       
 Min.   :0.007687   Min.   :0.02685   Min.   :0.007313   Min.   :0.01546  
 1st Qu.:0.014457   1st Qu.:0.03796   1st Qu.:0.013341   1st Qu.:0.02052  
 Median :0.015776   Median :0.04050   Median :0.014982   Median :0.02238  
 Mean   :0.016304   Mean   :0.04067   Mean   :0.016217   Mean   :0.02300  
 3rd Qu.:0.017609   3rd Qu.:0.04256   3rd Qu.:0.016613   3rd Qu.:0.02474  
 Max.   :0.028804   Max.   :0.08124   Max.   :0.127873   Max.   :0.04476  
     altura             area             Intesti      
 Min.   :0.02514   Min.   :0.001431   Min.   :0.1295  
 1st Qu.:0.03815   1st Qu.:0.006723   1st Qu.:0.1774  
 Median :0.04422   Median :0.009716   Median :0.1960  
 Mean   :0.04474   Mean   :0.010638   Mean   :0.1980  
 3rd Qu.:0.04928   3rd Qu.:0.014274   3rd Qu.:0.2150  
 Max.   :0.08398   Max.   :0.027268   Max.   :0.3246  </code></pre>
</div>
<p>Apliquemos el Análisis de Componentes Principales:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#Aplicamos el ACP con los datos escalados y centrados</span>
<span class='va'>res.pca</span> <span class='op'>&lt;-</span> <span class='fu'>FactoMineR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/FactoMineR/man/PCA.html'>PCA</a></span><span class='op'>(</span><span class='va'>x1</span>, graph <span class='op'>=</span> <span class='cn'>F</span>, ncp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x1</span><span class='op'>)</span>, scale.unit <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> 
<span class='co'># Extraemos las correlaciones de cada variable con cada componente principal</span>
<span class='va'>var</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/get_pca.html'>get_pca_var</a></span><span class='op'>(</span><span class='va'>res.pca</span><span class='op'>)</span> 
<span class='va'>cors</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>var</span><span class='op'>$</span><span class='va'>coord</span><span class='op'>)</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>cors</span>
</code></pre>
</div>
<pre><code>         Dim.1 Dim.2 Dim.3 Dim.4 Dim.5 Dim.6 Dim.7 Dim.8 Dim.9 Dim.10 Dim.11
furcal    0.17  0.11  0.22  0.25  0.09  0.37  0.37  0.34  0.43   0.31   0.19
base      0.08  0.08  0.32  0.02  0.15  0.46  0.19  0.41  0.35   0.02   0.45
radio     0.29  0.05  0.25  0.33  0.43  0.31  0.07  0.13  0.24   0.20   0.38
alto      0.13  0.32  0.44  0.45  0.48  0.04  0.14  0.09  0.08   0.05   0.03
gordo     0.24  0.26  0.50  0.28  0.44  0.11  0.17  0.14  0.06   0.09   0.22
angos     0.19  0.42  0.16  0.43  0.37  0.18  0.15  0.01  0.07   0.06   0.29
ojo       0.16  0.21  0.06  0.14  0.18  0.43  0.25  0.17  0.28   0.52   0.33
X1erarc   0.76  0.28  0.00  0.00  0.23  0.02  0.16  0.04  0.04   0.05   0.05
dist.     0.44  0.29  0.15  0.30  0.01  0.46  0.29  0.24  0.24   0.20   0.21
largo     0.65  0.36  0.22  0.30  0.01  0.26  0.17  0.08  0.25   0.20   0.15
cabez     0.58  0.49  0.12  0.22  0.29  0.16  0.22  0.08  0.07   0.04   0.19
hueso     0.02  0.17  0.32  0.45  0.06  0.31  0.46  0.19  0.04   0.07   0.06
mandib    0.83  0.36  0.03  0.06  0.00  0.03  0.05  0.05  0.11   0.01   0.08
hueso.1   0.30  0.02  0.42  0.65  0.16  0.03  0.29  0.22  0.06   0.10   0.04
arriba    0.79  0.31  0.23  0.12  0.01  0.01  0.01  0.01  0.11   0.01   0.07
cabeza    0.24  0.22  0.29  0.54  0.35  0.19  0.39  0.05  0.17   0.23   0.03
boca      0.71  0.18  0.06  0.09  0.12  0.24  0.16  0.08  0.25   0.15   0.01
abiert    0.60  0.11  0.54  0.05  0.07  0.06  0.21  0.19  0.13   0.17   0.05
cachete   0.24  0.35  0.59  0.09  0.39  0.22  0.20  0.09  0.01   0.00   0.01
largo.1   0.37  0.72  0.18  0.02  0.11  0.08  0.13  0.05  0.07   0.01   0.06
ancho     0.11  0.33  0.17  0.02  0.47  0.18  0.06  0.08  0.19   0.53   0.00
orificio  0.08  0.67  0.28  0.20  0.12  0.36  0.04  0.12  0.18   0.06   0.07
densi     0.59  0.32  0.29  0.12  0.12  0.05  0.24  0.10  0.29   0.03   0.04
hocic     0.78  0.14  0.22  0.32  0.06  0.06  0.03  0.05  0.03   0.06   0.00
interbr   0.38  0.54  0.03  0.35  0.15  0.14  0.26  0.04  0.03   0.02   0.05
ojoatra   0.26  0.52  0.49  0.29  0.30  0.10  0.03  0.08  0.10   0.05   0.03
proye     0.01  0.16  0.18  0.14  0.14  0.23  0.20  0.68  0.38   0.08   0.03
base.1    0.39  0.61  0.35  0.11  0.01  0.02  0.05  0.11  0.02   0.14   0.27
altura    0.10  0.74  0.23  0.15  0.17  0.10  0.10  0.09  0.05   0.00   0.07
area      0.61  0.34  0.50  0.01  0.05  0.18  0.04  0.02  0.07   0.00   0.01
Intesti   0.33  0.63  0.02  0.15  0.03  0.15  0.10  0.05  0.08   0.16   0.03
         Dim.12 Dim.13 Dim.14 Dim.15 Dim.16 Dim.17 Dim.18 Dim.19 Dim.20 Dim.21
furcal     0.16   0.15   0.07   0.10   0.04   0.15   0.01   0.13   0.05   0.06
base       0.25   0.01   0.05   0.03   0.01   0.01   0.11   0.11   0.10   0.03
radio      0.08   0.11   0.04   0.35   0.07   0.10   0.10   0.09   0.02   0.09
alto       0.05   0.03   0.03   0.04   0.12   0.25   0.24   0.06   0.07   0.05
gordo      0.11   0.02   0.21   0.04   0.25   0.18   0.17   0.02   0.00   0.08
angos      0.26   0.13   0.24   0.04   0.07   0.11   0.27   0.05   0.16   0.02
ojo        0.11   0.13   0.24   0.05   0.20   0.07   0.10   0.00   0.00   0.04
X1erarc    0.08   0.21   0.03   0.14   0.19   0.03   0.08   0.06   0.11   0.08
dist.      0.03   0.09   0.04   0.15   0.07   0.05   0.12   0.16   0.04   0.03
largo      0.01   0.07   0.01   0.06   0.07   0.01   0.05   0.06   0.01   0.05
cabez      0.19   0.05   0.07   0.04   0.03   0.00   0.05   0.12   0.15   0.08
hueso      0.24   0.42   0.09   0.04   0.08   0.11   0.00   0.02   0.08   0.13
mandib     0.07   0.09   0.02   0.09   0.02   0.10   0.01   0.05   0.10   0.01
hueso.1    0.02   0.03   0.07   0.13   0.03   0.10   0.11   0.02   0.03   0.21
arriba     0.04   0.00   0.07   0.02   0.04   0.13   0.06   0.21   0.04   0.22
cabeza     0.11   0.06   0.02   0.13   0.12   0.01   0.01   0.05   0.09   0.10
boca       0.09   0.24   0.06   0.17   0.08   0.01   0.09   0.26   0.09   0.15
abiert     0.14   0.03   0.16   0.02   0.04   0.12   0.06   0.02   0.20   0.12
cachete    0.03   0.09   0.18   0.02   0.05   0.20   0.09   0.07   0.17   0.03
largo.1    0.17   0.06   0.02   0.24   0.13   0.03   0.11   0.09   0.23   0.06
ancho      0.38   0.09   0.22   0.01   0.05   0.04   0.23   0.04   0.00   0.06
orificio   0.08   0.03   0.10   0.22   0.21   0.10   0.03   0.19   0.06   0.05
densi      0.10   0.24   0.21   0.07   0.17   0.03   0.02   0.03   0.09   0.27
hocic      0.13   0.05   0.07   0.06   0.04   0.09   0.19   0.02   0.11   0.06
interbr    0.13   0.06   0.38   0.09   0.16   0.14   0.10   0.03   0.18   0.13
ojoatra    0.10   0.17   0.09   0.09   0.14   0.01   0.13   0.05   0.11   0.03
proye      0.21   0.28   0.09   0.16   0.00   0.17   0.03   0.05   0.03   0.04
base.1     0.14   0.12   0.10   0.17   0.20   0.03   0.11   0.21   0.11   0.02
altura     0.25   0.13   0.20   0.10   0.08   0.25   0.03   0.20   0.02   0.00
area       0.25   0.18   0.22   0.06   0.07   0.01   0.01   0.10   0.08   0.07
Intesti    0.02   0.30   0.04   0.26   0.34   0.25   0.07   0.15   0.16   0.04
         Dim.22 Dim.23 Dim.24 Dim.25 Dim.26 Dim.27 Dim.28 Dim.29 Dim.30 Dim.31
furcal     0.03   0.03   0.05   0.06   0.02   0.00   0.08   0.04   0.03   0.00
base       0.00   0.09   0.03   0.07   0.00   0.05   0.02   0.02   0.02   0.00
radio      0.11   0.00   0.01   0.03   0.01   0.00   0.01   0.05   0.02   0.03
alto       0.10   0.20   0.10   0.03   0.06   0.05   0.00   0.04   0.02   0.02
gordo      0.01   0.20   0.10   0.05   0.07   0.02   0.01   0.01   0.01   0.02
angos      0.12   0.00   0.01   0.07   0.08   0.01   0.00   0.00   0.01   0.01
ojo        0.03   0.07   0.01   0.02   0.00   0.01   0.01   0.02   0.02   0.00
X1erarc    0.21   0.09   0.11   0.05   0.20   0.05   0.04   0.03   0.05   0.02
dist.      0.03   0.00   0.01   0.09   0.07   0.06   0.03   0.06   0.05   0.09
largo      0.03   0.01   0.06   0.11   0.05   0.11   0.04   0.08   0.10   0.10
cabez      0.07   0.02   0.03   0.06   0.03   0.02   0.01   0.15   0.13   0.03
hueso      0.13   0.02   0.05   0.03   0.02   0.09   0.02   0.00   0.02   0.01
mandib     0.06   0.00   0.14   0.09   0.03   0.18   0.15   0.07   0.09   0.03
hueso.1    0.13   0.03   0.03   0.02   0.10   0.14   0.02   0.04   0.02   0.06
arriba     0.09   0.02   0.16   0.11   0.09   0.10   0.03   0.03   0.07   0.06
cabeza     0.05   0.05   0.01   0.07   0.07   0.11   0.02   0.15   0.03   0.01
boca       0.01   0.07   0.15   0.00   0.04   0.08   0.07   0.08   0.03   0.01
abiert     0.06   0.02   0.08   0.08   0.22   0.04   0.09   0.03   0.01   0.01
cachete    0.02   0.23   0.12   0.09   0.01   0.10   0.06   0.01   0.01   0.01
largo.1    0.23   0.11   0.05   0.00   0.01   0.01   0.12   0.02   0.07   0.01
ancho      0.07   0.03   0.05   0.02   0.02   0.02   0.02   0.03   0.00   0.00
orificio   0.05   0.11   0.09   0.12   0.11   0.00   0.12   0.01   0.02   0.03
densi      0.03   0.01   0.08   0.14   0.04   0.01   0.05   0.02   0.06   0.02
hocic      0.18   0.08   0.03   0.16   0.06   0.09   0.18   0.02   0.03   0.01
interbr    0.05   0.03   0.06   0.18   0.01   0.06   0.03   0.03   0.03   0.00
ojoatra    0.15   0.25   0.11   0.10   0.04   0.04   0.08   0.02   0.01   0.05
proye      0.03   0.02   0.01   0.01   0.01   0.02   0.03   0.02   0.01   0.01
base.1     0.15   0.05   0.10   0.03   0.02   0.03   0.02   0.08   0.07   0.05
altura     0.03   0.11   0.16   0.06   0.00   0.07   0.03   0.02   0.03   0.07
area       0.07   0.00   0.04   0.05   0.10   0.02   0.06   0.14   0.07   0.08
Intesti    0.03   0.02   0.02   0.02   0.03   0.02   0.03   0.02   0.04   0.01</code></pre>
</div>
Ahora veamos los resultados de manera gráfica. Primero las variables:
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/fviz_pca.html'>fviz_pca_var</a></span><span class='op'>(</span><span class='va'>res.pca</span>, col.var <span class='op'>=</span> <span class='st'>"coord"</span>,
                       gradient.cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#00AFBB"</span>, <span class='st'>"#E7B800"</span>, <span class='st'>"#FC4E07"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-19-1.png" width="624" /></p>
</div>
<p>¿Qué variables son las más importantes? Otra forma de ver estos resultados es utilizando la librería corrplot:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/taiyun/corrplot'>corrplot</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/corrplot/man/corrplot.html'>corrplot</a></span><span class='op'>(</span><span class='va'>var</span><span class='op'>$</span><span class='va'>coord</span>, is.corr <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-20-1.png" width="624" /></p>
</div>
<p>Podemos extraer las 4 variables más importantes para un componente dado:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='va'>cors</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, decreasing <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code> mandib  arriba   hocic X1erarc 
   0.83    0.79    0.78    0.76 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='va'>cors</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span>, decreasing <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code>  altura  largo.1 orificio  Intesti 
    0.74     0.72     0.67     0.63 </code></pre>
</div>
<p>Un efecto secundario de reducir la dimensionalidad es que podemos formar agrupaciones, (otra de las aplicaciones del ACP) tal y como en el caso del NMDS. Podemos ver cómo se distribuyeron los individuos según nuestras agrupaciones originales, tal que:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/fviz_pca.html'>fviz_pca_ind</a></span><span class='op'>(</span><span class='va'>res.pca</span>,
             geom.ind <span class='op'>=</span> <span class='st'>"point"</span>, <span class='co'># Mostrar solo puntos (sin textos)</span>
             col.ind <span class='op'>=</span> <span class='va'>x1n</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='co'># Número de colores (grupos)</span>
             palette <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#00AFBB"</span>, <span class='st'>"#E7B800"</span>, <span class='st'>"#FC4E07"</span><span class='op'>)</span>, <span class='co'># Colores a utilizar</span>
             addEllipses <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='co'># Elipses de concentración</span>
             legend.title <span class='op'>=</span> <span class='st'>"Especies"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-22-1.png" width="624" /></p>
</div>
<p>Y podemos también hacer un gráfico conjunto, aunque dada la alta dimensionalidad de esta base de datos, los resultados serán poco interpretables.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/fviz_pca.html'>fviz_pca_biplot</a></span><span class='op'>(</span><span class='va'>res.pca</span>, 
                col.ind <span class='op'>=</span> <span class='va'>x1n</span><span class='op'>$</span><span class='va'>especie</span>, palette <span class='op'>=</span> <span class='st'>"jco"</span>, 
                addEllipses <span class='op'>=</span> <span class='cn'>TRUE</span>, label <span class='op'>=</span> <span class='st'>"var"</span>,
                col.var <span class='op'>=</span> <span class='st'>"black"</span>, repel <span class='op'>=</span> <span class='cn'>TRUE</span>,
                legend.title <span class='op'>=</span> <span class='st'>"Especies"</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-23-1.png" width="624" /></p>
</div>
<h2 id="evaluación-de-los-componentes-principales">Evaluación de los Componentes Principales</h2>
<p>Veamos ahora las varianzas explicadas acumuladas para cada componente:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>eig.val</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/eigenvalue.html'>get_eigenvalue</a></span><span class='op'>(</span><span class='va'>res.pca</span><span class='op'>)</span>
<span class='va'>eig.val</span>
</code></pre>
</div>
<pre><code>       eigenvalue variance.percent cumulative.variance.percent
Dim.1  6.14608922       19.8260942                    19.82609
Dim.2  4.63221636       14.9426334                    34.76873
Dim.3  2.80882601        9.0607291                    43.82946
Dim.4  2.27068129        7.3247783                    51.15424
Dim.5  1.68514008        5.4359358                    56.59017
Dim.6  1.55020741        5.0006691                    61.59084
Dim.7  1.26002881        4.0646091                    65.65545
Dim.8  1.10797871        3.5741249                    69.22957
Dim.9  1.05894728        3.4159590                    72.64553
Dim.10 0.96627425        3.1170137                    75.76255
Dim.11 0.84470657        2.7248599                    78.48741
Dim.12 0.75624648        2.4395048                    80.92691
Dim.13 0.72656100        2.3437452                    83.27066
Dim.14 0.62761130        2.0245526                    85.29521
Dim.15 0.52955055        1.7082276                    87.00344
Dim.16 0.51240639        1.6529238                    88.65636
Dim.17 0.45010263        1.4519440                    90.10830
Dim.18 0.39821456        1.2845631                    91.39287
Dim.19 0.37664998        1.2149999                    92.60787
Dim.20 0.35475436        1.1443689                    93.75224
Dim.21 0.30760753        0.9922823                    94.74452
Dim.22 0.28534181        0.9204574                    95.66498
Dim.23 0.26608062        0.8583246                    96.52330
Dim.24 0.20787739        0.6705722                    97.19387
Dim.25 0.19269314        0.6215908                    97.81546
Dim.26 0.16829393        0.5428837                    98.35835
Dim.27 0.14322652        0.4620210                    98.82037
Dim.28 0.13259938        0.4277399                    99.24811
Dim.29 0.10706999        0.3453871                    99.59350
Dim.30 0.07572896        0.2442870                    99.83778
Dim.31 0.05028750        0.1622177                   100.00000</code></pre>
</div>
<p>De todos los resultados anteriores vemos que las primeras dos dimensiones capturan menos del 50% de la varianza total de los datos; por tanto, es conveniente analizar cuántos componentes principales son los óptimos. Una alternativa es realizar el análisis gráfico de la varianza. En este gráfico buscamos un punto de inflexión, el cual indicaría el límite de los PCs representativos.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/factoextra/man/eigenvalue.html'>fviz_eig</a></span><span class='op'>(</span><span class='va'>res.pca</span>, addlabels <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-25-1.png" width="624" /></p>
</div>
<p>En este gráfico yo consideraría el primer punto de inflexión en el tercer componente principal, pero veamos otros dos criterios. El primero es el criterio de Kaiser-Guttman, en el cual consideraremos los CP cuyas varianzas explicadas sean superiores al valor medio. El segundo modelo es un modelo de repartición de recursos desarrollado en el campo de la ecología: El modelo Broken-Stick (McArthur 1957). En este modelo, el recurso compartido es la varianza total, entonces consideraremos aquellos CPs que contengan una varianza explicada superior a la esperada según el modelo.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#Kaisser-Guttman y Broken Stick</span>
<span class='va'>ev</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>eig.val</span><span class='op'>)</span><span class='op'>$</span><span class='va'>eigenvalue</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>ev</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"CP"</span>,<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>ev</span><span class='op'>)</span>, <span class='st'>""</span><span class='op'>)</span>
<span class='fu'>evplot</span><span class='op'>(</span><span class='va'>ev</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-26-1.png" width="624" /></p>
</div>
<p>Bajo el criterio de Kaiser-Guttman consideraríamos 8 CPs, mientras que en el modelo de Broken-Stick consideraríamos únicamente 4. De cualquier modo, ambos criterios sugieren un número mayor al que yo consideré en el gráfico de la varianza.</p>
<h1 id="escalamiento-multidimensional-no-métrico-nmds">Escalamiento Multidimensional No Métrico (NMDS)</h1>
<p>A diferencia del PCA en el cual es importante que las variables estén centradas y estandarizadas (o que las variables sean del mismo tipo; e.g., biometrías en distintas especies de peces), el Escalamiento Multidimensional No Métrico (NMDS) es una técnica más flexible al estar basada en órdenes de rangos (distancias) para la ordenación. Como resultado, puede aceptar una variedad mayor de tipos de datos. Otra diferencia es que en el ACP el objetivo primordial no es la formación de agrupaciones, sino la reducción de la dimensionalidad y la ordenación es una consecuencia del proceso, mientras que en NMDS sí se busca una ordenación.</p>
<p>Para analizar este caso utilicemos los mismos datos del caso sitios (clúster):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Matriz de distancias</span>
<span class='va'>dist.nmds</span> <span class='op'>&lt;-</span> <span class='va'>dist.mv2</span>
<span class='va'>mds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/vegan/man/metaMDS.html'>metaMDS</a></span><span class='op'>(</span><span class='va'>dist.nmds</span>, distance <span class='op'>=</span> <span class='st'>"euclidean"</span>, k <span class='op'>=</span> <span class='fl'>2</span>, trace <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Run 0 stress 0.1033851 
Run 1 stress 0.1188198 
Run 2 stress 0.1033851 
... Procrustes: rmse 1.970335e-05  max resid 6.222584e-05 
... Similar to previous best
Run 3 stress 0.1033851 
... Procrustes: rmse 6.603628e-05  max resid 0.0002091009 
... Similar to previous best
Run 4 stress 0.1033851 
... Procrustes: rmse 6.571116e-05  max resid 0.0002082297 
... Similar to previous best
Run 5 stress 0.1033851 
... New best solution
... Procrustes: rmse 5.472195e-06  max resid 1.66047e-05 
... Similar to previous best
Run 6 stress 0.1033851 
... Procrustes: rmse 1.673883e-05  max resid 5.296519e-05 
... Similar to previous best
Run 7 stress 0.1033851 
... Procrustes: rmse 0.000110847  max resid 0.0003523373 
... Similar to previous best
Run 8 stress 0.1188198 
Run 9 stress 0.1033851 
... Procrustes: rmse 3.145978e-05  max resid 9.880461e-05 
... Similar to previous best
Run 10 stress 0.1033851 
... Procrustes: rmse 6.479757e-06  max resid 1.310173e-05 
... Similar to previous best
Run 11 stress 0.1033851 
... Procrustes: rmse 1.165495e-05  max resid 3.694318e-05 
... Similar to previous best
Run 12 stress 0.1708132 
Run 13 stress 0.1033851 
... Procrustes: rmse 1.601501e-05  max resid 5.086657e-05 
... Similar to previous best
Run 14 stress 0.1642917 
Run 15 stress 0.1188198 
Run 16 stress 0.2176284 
Run 17 stress 0.1188198 
Run 18 stress 0.1033851 
... Procrustes: rmse 6.799859e-05  max resid 0.00021525 
... Similar to previous best
Run 19 stress 0.1033851 
... Procrustes: rmse 3.835759e-05  max resid 0.0001118869 
... Similar to previous best
Run 20 stress 0.1033851 
... Procrustes: rmse 5.251482e-05  max resid 0.0001695884 
... Similar to previous best
*** Solution reached</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mds.dims</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>NMDS1 <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>points</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, NMDS2 <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>points</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>

<span class='va'>mds.plot.data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>mds.dims</span>, <span class='va'>clust.scale</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Podemos obtener también la importancia de las variables, de modo análogo a lo que hicimos con el ACP:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Extraemos los coef. de determinación de cada variable ~ NMDS (flechas)</span>
<span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/vegan/man/envfit.html'>envfit</a></span><span class='op'>(</span><span class='va'>mds</span>, <span class='va'>clust.scale</span><span class='op'>)</span>
<span class='va'>arrow</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>$</span><span class='va'>arrows</span>, R <span class='op'>=</span> <span class='va'>fit</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>$</span><span class='va'>r</span>, P <span class='op'>=</span> <span class='va'>fit</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>$</span><span class='va'>pvals</span><span class='op'>)</span>
<span class='va'>arrow</span><span class='op'>[</span><span class='st'>"Variable"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>arrow</span><span class='op'>)</span>

<span class='co'># Extraemos aquellas que tengan una corr. significativamente diferente de 0</span>
<span class='va'>arrow.p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>arrow</span>, <span class='va'>P</span> <span class='op'>&lt;=</span> <span class='fl'>0.05</span><span class='op'>)</span>

<span class='co'>#Ordenamos de manera descendente según su valor de R2</span>
<span class='va'>arrow.p</span> <span class='op'>&lt;-</span> <span class='va'>arrow.p</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>arrow.p</span><span class='op'>$</span><span class='va'>R</span>, decreasing <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>, <span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>arrow.p</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           NMDS1      NMDS2         R     P Variable
OD    -0.8293773  0.5586889 0.9128733 0.001       OD
STD    0.9471231 -0.3208706 0.8744877 0.001      STD
Temp   0.8293920 -0.5586671 0.7176450 0.001     Temp
NH4    0.9517448 -0.3068907 0.6989930 0.002      NH4
Caud   0.9045865  0.4262902 0.6989252 0.001     Caud
Trans -0.7862181 -0.6179491 0.6977633 0.001    Trans</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://github.com/slowkow/ggrepel'>ggrepel</a></span><span class='op'>)</span>
<span class='va'>mds.plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>mds.plot.data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>NMDS1</span>, <span class='va'>NMDS2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>$</span><span class='va'>Best.partition</span><span class='op'>)</span><span class='op'>)</span>,
                       alpha <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span>
            <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_label_repel</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>clust.scale</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/stat_ellipse.html'>stat_ellipse</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>$</span><span class='va'>Best.partition</span><span class='op'>)</span><span class='op'>)</span>, 
                         type <span class='op'>=</span> <span class='st'>"t"</span>, size <span class='op'>=</span> <span class='fl'>1</span>, geom <span class='op'>=</span> <span class='st'>"polygon"</span>, 
                         alpha <span class='op'>=</span> <span class='fl'>0.2</span>, show.legend <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>+</span>
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Escalamiento Multidimensional no métrico (NMDS)"</span>,
                 subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>'Estrés ='</span>,<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>mds</span><span class='op'>$</span><span class='va'>stress</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>,
                 caption <span class='op'>=</span> <span class='st'>"Datos: cluster.txt"</span><span class='op'>)</span> <span class='op'>+</span>
            <span class='fu'>blank_theme</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"right"</span><span class='op'>)</span> <span class='op'>+</span> 
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_hue.html'>scale_color_discrete</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"Grupo"</span><span class='op'>)</span> <span class='co'>#+</span>
<span class='co'>#             geom_segment(data = arrow.p, </span>
<span class='co'>#                          aes(x=0, y=0,</span>
<span class='co'>#                              xend = NMDS1, yend = NMDS2, lty = Variable), </span>
<span class='co'>#</span>
                           <span class='co'># Flechas escaladas según su R^2</span>
<span class='co'>#                          arrow = arrow(length = unit(.25, "cm")*arrow.p$R)</span>
<span class='co'>#                         )</span>

<span class='va'>mds.plot</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-29-1.png" width="624" /></p>
</div>
<p>Ahora comparemos con el dendrograma:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ggd2.plot</span>
</code></pre>
</div>
<p><img src="c13_no_sup_files/figure-html5/unnamed-chunk-30-1.png" width="624" /></p>
</div>
<h2 id="ejercicio">Ejercicio</h2>
<p>Aplicar un ACP a esta misma base de datos. 1. ¿Los datos deben de centrarse y estandarizarse? 2. Realiza el ACP. ¿Cuántos CPs considerarías? 3. ¿Cuál es la varianza explicada entre los dos primeros componentes principales? 4. ¿Cuáles son las variables más imporantes para esos dos componentes? 5. ¿Hay diferencias en la ordenación con respecto a los otros dos métodos? 6. Realizar las tres técnicas con las medidas ambientales, incluyendo SST y comparar con estos resultados.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p>© Copyright 2021 [Dr. Plancton] (https://www.drplancton.com).</p>
<p>Software licensed under the [Apache License, v2.0] (https://www.apache.org/licenses/LICENSE-2.0).</p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
