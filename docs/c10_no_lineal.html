<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Bioestadística con R: Modelos No Lineales</title>



  <meta name="article:author" content="M. en C. Arturo Bell Enríquez García"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Bioestadística con R: Modelos No Lineales"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Bioestadística con R"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Bioestadística con R: Modelos No Lineales"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","output"]}},"value":[{"type":"character","attributes":{},"value":["Modelos No Lineales"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["M. en C. Arturo Bell Enríquez García"]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_float","code_download"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Modelos No Lineales","authors":[{"author":"M. en C. Arturo Bell Enríquez García","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://drplancton.com">
<img src="logo.png" alt="Logo"/>
</a>
<a href="index.html" class="title">Bioestadística con R</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Temas
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="s1_biolcdatos.html">S1 - Biología como Ciencia de Datos</a>
<a href="s2_herrbasic.html">S2 - Herramientas Básicas</a>
<a href="c08_rls.html">S3 - Modelo Lineal Simple</a>
<a href="s4_noparnolin.html">S4 - No Paramétrico y No Lineal</a>
<a href="s5_mv.html">S5 - Técnicas Multivariadas</a>
</div>
</div>
</div>
<div class="nav-right">
<a href="about.html">Acerca de</a>
<a href="https://github.com/ArturoBell/Bioestadistica_R">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Modelos No Lineales</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  
  M. en C. Arturo Bell Enríquez García
  

</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#librerías">Librerías</a></li>
<li><a href="#otro-tipo-de-relaciones">Otro tipo de relaciones</a></li>
<li><a href="#violación-del-supuesto-de-linealidad">Violación del
supuesto de linealidad</a></li>
<li><a href="#modelos-de-crecimiento">Modelos de crecimiento</a>
<ul>
<li><a href="#modelo-de-von-bertalanffy-1938">Modelo de Von Bertalanffy
(1938)</a></li>
</ul></li>
<li><a href="#bootstrap-e-intervalos-de-confianza">Bootstrap e
Intervalos de Confianza</a></li>
<li><a href="#relación-talla-peso">Relación Talla-Peso</a></li>
<li><a href="#ejercicio">Ejercicio</a></li>
</ul>
</nav>
</div>
<h2 id="librerías">Librerías</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://easystats.github.io/performance/'>performance</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>nlraa</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="otro-tipo-de-relaciones">Otro tipo de relaciones</h2>
<p>En las sesiones anteriores hablamos de modelos en los cuales asumimos
que hay una relación lineal entre nuestras variables; es decir, una
variable incrementa o disminuye de manera constante en relación a la
otra, pero también mencionamos que esto no siempre es así. Aquí es justo
donde entra la modelación no lineal. En un problema de regresión lineal
simple utilizamos alguna función de pérdida y un algoritmo de
optimización para encontrar los valores del intercepto y la pendiente,
según nuestros datos. La regresión no lineal es, en escencia, lo mismo:
ajustar parámetros de un modelo a partir de los datos. La única
diferencia es que el modelo puede describir cualquier tipo de relación
funcional entre las variables involucradas. Puede ser algo tan simple
como un modelo potencial de un solo parámetro hasta algo tan complicado
como el modelo de mortalidad de Chen y Watanabe (1988), o incluso
más.</p>
<p>Aplicaciones biológicas de este tipo de modelos hay muchas: a)
estimación de la riqueza específica de un sitio, b) modelar el
crecimiento de organismos, c) relaciones talla-peso, etc., etc., etc. En
esta sesión revisaremos algunos ejemplos de estos modelos y cómo
aplicarlos e interpretarlos.</p>
<p>Sobre esto último, implementar estos modelos en <code>R</code> es
sumamente sencillo. Los requerimientos son a) conocer la ecuación, b)
escribirla como una operación y c) establecer algunos valores iniciales
para iniciar la búsqueda. Para esto utilizaremos la función
<code>nls(formula, data, start)</code> (Nonlinear Least Squares).</p>
<h2 id="violación-del-supuesto-de-linealidad">Violación del supuesto de
linealidad</h2>
<p>Tenemos dos razones básicas que nos pueden llevar a pensar en un
modelo no lineal. La primera es que, de entrada, sepamos que nuestros
datos deben de ser modelados de esa manera, principalmente debido a
conocimiento previo del problema. La segunda es que se viole el supuesto
de linealidad de los residuales. La primera es auto-explicativa, por lo
que obviaré el escenario, pero la segunda no lo es tanto. Revisemos
entonces un primer modelo para describir la longitud de mandíbulas de
tiburones a partir de la edad de los mismos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>jaws</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"data/jaws.csv"</span><span class='op'>)</span>
<span class='va'>lm_jaws</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>bone</span><span class='op'>~</span><span class='va'>age</span>, data <span class='op'>=</span> <span class='va'>jaws</span><span class='op'>)</span>
<span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/check_model.html'>check_model</a></span><span class='op'>(</span><span class='va'>lm_jaws</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-2-1.png" width="624" /></p>
</div>
<p>En términos de nuestros datos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>jaws_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>jaws</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>age</span>, y <span class='op'>=</span> <span class='va'>bone</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"dodgerblue4"</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Modelo lineal"</span>,
                  x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                  y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>lm_plot</span> <span class='op'>&lt;-</span> <span class='va'>jaws_plot</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>,
                                   color <span class='op'>=</span> <span class='st'>"#ff7f0e"</span><span class='op'>)</span>
<span class='va'>lm_plot</span>
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-3-1.png" width="624" /></p>
</div>
<p>Tenemos un leve problema con el supuesto de linealidad. Ni por asomo
nuestros residuales están cerca de la linea en 0, de hecho, forman una
especie de “parábola”. Esto quiere decir que debemos de considerar otra
aproximación, pues la descripción del modelo lineal no es adecuada. Ok,
entonces ¿qué modelo aplicamos? Habrá que echar mano de algún modelo de
crecimiento.</p>
<h2 id="modelos-de-crecimiento">Modelos de crecimiento</h2>
<p>Estos modelos se pueden construir con cualquier medida de longitud o
peso, y en este caso utilizaremos longitudes de huesos de una especie de
tiburón. Modelos para el crecimiento hay muchos, algunos son Gompertz
(1832), crecimiento logístico, Morgan-Mercer-Flodin, Weibull o Richards,
de los cuales algunos tienen variantes con más o menos parámetros. Te
recomiendo ampliamente revisar <a
href="http://pisces-conservation.com/growthhelp/types_of_growth_curve.htm">este
enlace</a> para conocer un poco más sobre estos modelos (ecuaciones,
aplicaciones, supuestos, etc.). Por desgracia, no tenemos tiempo
suficiente para hablar de todos ellos, así que exploraremos el más
conocido: el modelo de crecimiento individual de Von Bertalanffy.</p>
<h3 id="modelo-de-von-bertalanffy-1938">Modelo de Von Bertalanffy
(1938)</h3>
<p>Este modelo lo derivó Von Bertalanffy (VB) desde algunos parámetros
fisiológicos bastante simples. Es, posiblemente, el modelo de
crecimiento más utilizado en estudios de pesquerías. Este modelo asume
que la tasa de crecimiento de un organismo declina con la tasa de cambio
de la longitud, y que puede ser descrito con el modelo:</p>
<p><span class="math display">\[
\frac{dl}{dt} = K(L_\infty - l)
\]</span></p>
<p>donde <span class="math inline">\(t\)</span> es el tiempo, <span
class="math inline">\(l\)</span> es la longitud (o cualquier otra medida
de tamaño), <span class="math inline">\(K\)</span> es la tasa de
crecimiento, <span class="math inline">\(L_\infty\)</span>, que
representa la longitud asintótica a la que el crecimiento es 0. Si
integramos esta ecuación, obtenemos:</p>
<p><span class="math display">\[
L(t) = L_\infty(1-e^{-K(t-t_0)})
\]</span></p>
<p>En donde el parámetro <span class="math inline">\(t_0\)</span> se
incluye para ajustar la ecuación para la talla inicial del organismo, y
se interpreta como la edad a la cual el organismo tendría tamaño 0. Este
modelo, entonces, consta de 3 parámetros (<span
class="math inline">\(L_\infty\)</span>, <span
class="math inline">\(K\)</span>, y <span
class="math inline">\(t_0\)</span>); sin embargo, existe una
parametrización alternativa que cambia <span
class="math inline">\(t_0\)</span> por <span
class="math inline">\(L_0\)</span>; es decir, la talla del individuo al
nacer:</p>
<p><span class="math display">\[
L(t) = L_\infty - (L_\infty - L_0)e^{-Kt}
\]</span></p>
<p>Utilicemos la primera variante por conveniencia al declarar el
modelo:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>vb_jaws</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/nls.html'>nls</a></span><span class='op'>(</span><span class='va'>bone</span><span class='op'>~</span><span class='va'>L</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>K</span><span class='op'>*</span><span class='op'>(</span><span class='va'>age</span><span class='op'>-</span><span class='va'>t</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
          data <span class='op'>=</span> <span class='va'>jaws</span>,
          start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>L <span class='op'>=</span> <span class='fl'>140</span>, K <span class='op'>=</span> <span class='fl'>0.5</span>, t <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>vb_jaws</span>
</code></pre>
</div>
<pre><code>Nonlinear regression model
  model: bone ~ L * (1 - exp(-K * (age - t)))
   data: jaws
       L        K        t 
115.2527   0.1235   0.2378 
 residual sum-of-squares: 8897

Number of iterations to convergence: 6 
Achieved convergence tolerance: 1.998e-06</code></pre>
</div>
<p>Gráficamente:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>jaws</span><span class='op'>$</span><span class='va'>vb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>vb_jaws</span>, <span class='va'>jaws</span><span class='op'>$</span><span class='va'>age</span><span class='op'>)</span>
<span class='va'>jaws_plot</span> <span class='op'>+</span>
  <span class='co'># Nota que los datos de y los pasamos directamente</span>
  <span class='co'># desde el data.frame:</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>jaws</span><span class='op'>$</span><span class='va'>vb</span><span class='op'>)</span>,
            color <span class='op'>=</span> <span class='st'>"#ff7f0e"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Modelo Von Bertalanffy"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<p>Podemos también utilizar directamente <code>geom_smooth</code> para
construir el gráfico. <strong>OJO</strong> <code>ggplot</code> pasa
nuestros datos como <code>x</code> y <code>y</code>, no como los nombres
de las variables originales. Adicionalmente, podemos utilizar la
librería <a
href="https://patchwork.data-imaginist.com/index.html"><code>patchwork</code></a>
para poner ambos gráficos (lineal y vb) en un solo gráfico:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>vb_plot</span> <span class='op'>&lt;-</span> <span class='va'>jaws_plot</span> <span class='op'>+</span> 
           <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"nls"</span>,
                       formula <span class='op'>=</span> <span class='va'>y</span><span class='op'>~</span><span class='va'>L</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>K</span><span class='op'>*</span><span class='op'>(</span><span class='va'>x</span><span class='op'>-</span><span class='va'>t</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
                       method.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>L <span class='op'>=</span> <span class='fl'>140</span>,
                                                       K <span class='op'>=</span> <span class='fl'>0.5</span>,
                                                       t <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span>,
                       se <span class='op'>=</span> <span class='cn'>F</span>,
                       color <span class='op'>=</span> <span class='st'>"#ff7f0e"</span>,
                       size <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Modelo Von Bertalanffy"</span><span class='op'>)</span>

<span class='va'>lm_plot</span> <span class='op'>+</span> <span class='va'>vb_plot</span> <span class='op'>+</span>
  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Relación long. mandíbula ~ edad"</span>,
                  caption <span class='op'>=</span> <span class='st'>"Datos: JAWS"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-6-1.png" width="624" /></p>
</div>
<p>Visualmente es evidente que el modelo VB está mejor ajustado que el
modelo lineal y, de hecho, podemos comparar ambos modelos utilizando
teoría de la información, en particular el criterio de información de
Akaike, del cual hablaremos con mayor detalle en la sesión de <a
href="https://arturobell.github.io/Bioestadistica_R/c16_glm.html">Modelos
Lineales Generalizados</a>. Por lo pronto, bástete saber que
seleccionaremos el modelo con el menor AIC, que, como esperábamos, es el
modelo VB:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></span><span class='op'>(</span><span class='va'>lm_jaws</span>, <span class='va'>vb_jaws</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        df      AIC
lm_jaws  3 492.4925
vb_jaws  4 436.8894</code></pre>
</div>
<p>El ajuste mejoró notablemente, pero ¿cómo interpretamos el modelo? La
respuesta está en la descripción que vimos antes, pero trasladémosla a
este caso particular:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>vb_jaws</span>
</code></pre>
</div>
<pre><code>Nonlinear regression model
  model: bone ~ L * (1 - exp(-K * (age - t)))
   data: jaws
       L        K        t 
115.2527   0.1235   0.2378 
 residual sum-of-squares: 8897

Number of iterations to convergence: 6 
Achieved convergence tolerance: 1.998e-06</code></pre>
</div>
<p>Tenemos una <span class="math inline">\(L_\infty\)</span> de 115.25;
es decir, la longitud a la cual la especie analizada deja de crecer
(tasa de crecimiento = 0) es de 115.25 cm. Esto podemos verlo
gráficamente:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pars_plot</span> <span class='op'>&lt;-</span> <span class='va'>vb_plot</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>vb_jaws</span><span class='op'>)</span><span class='op'>[</span><span class='st'>"L"</span><span class='op'>]</span>,
                        color <span class='op'>=</span> <span class='st'>"firebrick"</span>,
                        linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span>
<span class='va'>pars_plot</span>
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<p>Este parametro normalmente es de interés, pues representa la longitud
máxima promedio, y puede ser útil en la evaluación de poblaciones
sujetas a explotación, por ejemplo.</p>
<p>El siguiente parámetro es <span class="math inline">\(K\)</span>; es
decir, la constante de crecimiento, cuyas unidades son unidades
recíprocas de tiempo (<em>e.g.</em> años<span
class="math inline">\(^-1\)</span>). Esto hace que su interpretación sea
muy poco amigable; sin embargo, podemos interpretarla en términos de
vidas medias (ln 2/k) con unidades de tiempo. El origen del concepto de
la vida media se encuentra en la química, particularmente en el
decaimiento isotópico, de modo que la vida media de un isótopo
representa el tiempo que toma a una concentración x del mismo en
reducirse a la mitad, y ha sido extendida para expresar periodos de
tiempo que expresen reducciones del 50% de muchas otras cosas. En este
caso, la interpretación estaría más relacionada con la ecuación
diferencial que vimos al inicio, en el sentido de que es el tiempo que
toma que la tasa de crecimiento se reduzca en un 50%:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>half_life</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unname.html'>unname</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>vb_jaws</span><span class='op'>)</span><span class='op'>[</span><span class='st'>"K"</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>half_life</span>
</code></pre>
</div>
<pre><code>[1] 2.784617</code></pre>
</div>
<p>De aquí podemos también estimar el tiempo (promedio) que toma a un
individo alcanzar la fracción <span class="math inline">\(x\)</span> de
<span class="math inline">\(L_\infty\)</span>:</p>
<p><span class="math display">\[
t_x = \frac{1}{k}ln \left( \frac{L_\infty - L_0}{L_\infty(1-x)} \right)
\]</span> Pero no tenemos <span class="math inline">\(L_0\)</span>, ¿qué
hacemos? Afortunadamente, ambas parametrizaciones (con <span
class="math inline">\(t_0\)</span> o <span
class="math inline">\(L_0\)</span>) son equivalentes, por lo que no
necesitamos re-ajustar el modelo. Simplemente podemos estimarla a partir
de los coeficientes de nuestro modelo:</p>
<p><span class="math display">\[
L_0 = L_\infty(1-e^{kt_0})
\]</span> Entonces calculemos el tiempo promedio que toma a un individuo
alcanzar el 95% de <span class="math inline">\(L_\infty\)</span>, lo
cual es una posible estimación de longevidad (Ricker 1979):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>vb_coef</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>vb_jaws</span><span class='op'>)</span>
<span class='va'>L</span> <span class='op'>&lt;-</span> <span class='va'>vb_coef</span><span class='op'>[</span><span class='st'>"L"</span><span class='op'>]</span>
<span class='va'>K</span> <span class='op'>&lt;-</span> <span class='va'>vb_coef</span><span class='op'>[</span><span class='st'>"K"</span><span class='op'>]</span>
<span class='va'>t0</span> <span class='op'>&lt;-</span> <span class='va'>vb_coef</span><span class='op'>[</span><span class='st'>"t"</span><span class='op'>]</span>
<span class='va'>l0</span> <span class='op'>&lt;-</span> <span class='va'>L</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>K</span><span class='op'>*</span><span class='va'>t0</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>t_95</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='va'>K</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>L</span><span class='op'>-</span><span class='va'>l0</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='va'>L</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fl'>0.95</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/unname.html'>unname</a></span><span class='op'>(</span><span class='va'>t_95</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 24.49365</code></pre>
</div>
<p>Es decir, la longevidad promedio de la especie es de 24.49 años. Otra
forma de estimar la longevidad es con la fracción 0.9933 (Fabens
1965):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>t_99</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='va'>K</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>L</span><span class='op'>-</span><span class='va'>l0</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='va'>L</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fl'>0.99</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/unname.html'>unname</a></span><span class='op'>(</span><span class='va'>t_99</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 37.52495</code></pre>
</div>
<p>Visualmente:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pars_plot</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>t_99</span>,
             color <span class='op'>=</span> <span class='st'>"forestgreen"</span>,
             linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
</div>
<p>Para más detalles y una discusión sobre este modelo, te recomiendo
ampliamente revisar el artículo de <a
href="https://bit.ly/3IMe4aN">Cailliet et al. (2006)</a>. Una pregunta
que muy seguramente tendrás es “¿qué pasa con los intervalos de
confianza?”. Bueno, podemos construirlos de dos maneras: a) utilizando
perfiles de verosimilitud con la función <code>confint()</code> o b)
utilizar réplicas bootstrap. La primera aproximación ya la conoces
(utilizando errores estándar, recuperables con la función
<code>summary</code>); sin embargo, la segunda merece que la
exploremos.</p>
<h2 id="bootstrap-e-intervalos-de-confianza">Bootstrap e Intervalos de
Confianza</h2>
<p>Primero, ¿qué es Bootstrap y con qué se come? El muestreo Bootstrap
(o bootstraping) consiste en <strong>remuestrear</strong> los datos, con
el objetivo de crear una <strong>distribución empírica</strong> de algún
estadístico. Es decir, NO utilizaremos ni asumiremos una distribución
para nuestros residuales, sino que utilizaremos directamente nuestros
datos para describir su distribución. Un escenario en el cual esto es
útil es cuando el perfil de verosimilitud de nuestros parámetros no es
simétrico, como es el caso de <span class="math inline">\(t_0\)</span>
en nuestro modelo:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/profile.html'>profile</a></span><span class='op'>(</span><span class='va'>vb_jaws</span>, <span class='st'>"t"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<p>¿Qué nos dice este gráfico? En pocas palabras, la forma de la
distribución de la verosimilitud de nuestro parámetro, en términos de
<span class="math inline">\(\tau\)</span>, que representa el valor del
estadístico <span class="math inline">\(t\)</span> a cada punto, donde
el valor de <span class="math inline">\(t\)</span> se calcula como la
raiz cuadrada del cambio en la suma de cuadrados, dividido por el error
estándar residual. ¿En Español? Entre más grande sea <span
class="math inline">\(\tau\)</span>, más nos alejamos del punto con
máxima verosimilitud (<span class="math inline">\(\tau = 0\)</span>).
Piensa en este gráfico como un gráfico de densidad invertido.</p>
<p>Utilicemos entonces la función <code>boot_nls</code> de la librería
<code>nlraa</code> para hacer el muestreo de nuestros parámetros, y
utilicemos la función <code>confint</code> para obtener sus intervalos
de confianza:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>boot_pars</span> <span class='op'>&lt;-</span> <span class='fu'>nlraa</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/nlraa/man/boot_nls.html'>boot_nls</a></span><span class='op'>(</span><span class='va'>vb_jaws</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Number of times model fit did not converge 3 out of 999 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>boot_ci</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>boot_pars</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Par <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vb_coef</span><span class='op'>)</span>, CI <span class='op'>=</span> <span class='va'>boot_ci</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  Par     CI.2.5..   CI.97.5..
1   L 107.87978549 123.6215722
2   K   0.08128642   0.1732133
3   t  -1.42202747   1.5866900</code></pre>
</div>
<p>Y podemos utilizar estas estimaciones para graficar nuestros IC:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>jaws</span><span class='op'>$</span><span class='va'>boot_inf</span> <span class='op'>&lt;-</span> <span class='va'>boot_ci</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>boot_ci</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>*</span><span class='op'>(</span><span class='va'>jaws</span><span class='op'>$</span><span class='va'>age</span><span class='op'>-</span><span class='va'>boot_ci</span><span class='op'>[</span><span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>jaws</span><span class='op'>$</span><span class='va'>boot_sup</span> <span class='op'>&lt;-</span> <span class='va'>boot_ci</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>boot_ci</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>*</span><span class='op'>(</span><span class='va'>jaws</span><span class='op'>$</span><span class='va'>age</span><span class='op'>-</span><span class='va'>boot_ci</span><span class='op'>[</span><span class='fl'>3</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>boot_plot</span> <span class='op'>&lt;-</span> <span class='va'>vb_plot</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_ribbon</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>jaws</span><span class='op'>$</span><span class='va'>boot_inf</span>,
                             ymax <span class='op'>=</span> <span class='va'>jaws</span><span class='op'>$</span><span class='va'>boot_sup</span>,
                             alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,
                         fill <span class='op'>=</span> <span class='st'>"grey70"</span>,
                         show.legend <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>+</span>
             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                  subtitle <span class='op'>=</span> <span class='st'>"IC: Bootstrap"</span><span class='op'>)</span>
<span class='va'>boot_plot</span>
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-16-1.png" width="624" /></p>
</div>
<p>En este caso particular, los resultados son similares a los obtenidos
utilizando la función <code>confint</code>, solo que los de
<code>confint</code> reflejan una “menor” incertidumbre en la
estimación. En este caso particular, es importante considerar la
asimetría en el perfil de verosimilitud de <span
class="math inline">\(t_0\)</span>, por lo que yo preferiría los IC
estimados con bootstrap:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>vb_ci</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>vb_jaws</span><span class='op'>)</span>
<span class='va'>jaws</span><span class='op'>$</span><span class='va'>inf</span> <span class='op'>&lt;-</span> <span class='va'>vb_ci</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>vb_ci</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>*</span><span class='op'>(</span><span class='va'>jaws</span><span class='op'>$</span><span class='va'>age</span><span class='op'>-</span><span class='va'>vb_ci</span><span class='op'>[</span><span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>jaws</span><span class='op'>$</span><span class='va'>sup</span> <span class='op'>&lt;-</span> <span class='va'>vb_ci</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>vb_ci</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>*</span><span class='op'>(</span><span class='va'>jaws</span><span class='op'>$</span><span class='va'>age</span><span class='op'>-</span><span class='va'>vb_ci</span><span class='op'>[</span><span class='fl'>3</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ci_plot</span> <span class='op'>&lt;-</span> <span class='va'>vb_plot</span> <span class='op'>+</span>
           <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_ribbon</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>jaws</span><span class='op'>$</span><span class='va'>inf</span>,
                           ymax <span class='op'>=</span> <span class='va'>jaws</span><span class='op'>$</span><span class='va'>sup</span>,
                           alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>,
                       fill <span class='op'>=</span> <span class='st'>"grey70"</span>,
                       show.legend <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>+</span>
           <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                subtitle <span class='op'>=</span> <span class='st'>"IC: Perfil de verosimilitud"</span><span class='op'>)</span>

<span class='va'>boot_plot</span> <span class='op'>+</span> <span class='va'>ci_plot</span> <span class='op'>+</span> <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Modelo VB y sus IC"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-17-1.png" width="624" /></p>
</div>
<h2 id="relación-talla-peso">Relación Talla-Peso</h2>
<p>En el caso anterior modelamos la tasa de crecimento individual
(aunque puede ser cualquier otro crecimiento), pero otra aplicación
interesante es modelar la relación talla-peso de alguna especie. Aunque
esta sigue un modelo potencial sumamente simple, sirve para ejemplificar
un par de cosas y aproximaciones. Para este ejemplo utilizaremos los
datos <code>RuffeSLRH92</code> contenidos en la librería
<code>FSAdata</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ruffe</span> <span class='op'>&lt;-</span> <span class='fu'>FSAdata</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/FSAdata/man/RuffeSLRH92.html'>RuffeSLRH92</a></span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"length"</span>,
                                  <span class='st'>"weight"</span><span class='op'>)</span><span class='op'>]</span>
<span class='co'># Eliminamos posibles NA</span>
<span class='va'>ruffe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='va'>ruffe</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>ruffe</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"lt"</span>, <span class='st'>"wt"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>ruffe</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   lt   wt
1  90  9.3
2 128 32.5
3 112 19.0
4  68  4.4
5  56  2.1
6  58  2.8</code></pre>
</div>
<p>Grafiquemos estos datos, pero primero reflexionemos un poco. ¿Qué
tiene más sentido? ¿Que el peso dependa de la longitud? o, caso
contrario, ¿que la longitud dependa del peso? Esta pregunta sobre qué
variable depende de cuál es en apariencia trivial, pero que siempre
debemos de plantearnos ante cualquier problema de regresión. Puedes
ajustar tu modelo en ambos sentidos, pero ¿tiene sentido que un
organismo crezca en longitud porque incrementó su peso? Habiendo
definido eso, pongamos la talla (<code>lt</code>) en el eje x y el peso
(<code>wt</code>) en el eje y:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ruffe_plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ruffe</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>lt</span>, y <span class='op'>=</span> <span class='va'>wt</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"dodgerblue4"</span>,
                         alpha <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Relación talla/peso"</span>,
                   x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                   y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ruffe_plot</span>
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-19-1.png" width="624" /></p>
</div>
<p>A simple vista es evidente que un modelo lineal no daría el ancho,
pero tenemos una aproximación con una interpretación similar, el modelo
potencial:</p>
<p><span class="math display">\[
W_i = aL^b_ie^{\epsilon_i}
\]</span></p>
<p>Donde <span class="math inline">\(A\)</span> y <span
class="math inline">\(B\)</span> son constantes, representando la
ordenada al origen y la tasa de crecimiento, respectivamente, y <span
class="math inline">\(\epsilon\)</span> es el error multiplicativo. Esto
es sumamente similar a un modelo lineal, ¿no? Pues, en realidad, podemos
llevar el modelo potencial a un modelo lineal si eliminamos el
exponencial del lado derecho</p>
<p><span class="math display">\[
log(W_i) = log(\alpha L^\beta_ie^{\epsilon_i}) \\
\therefore \\
log(W_i) = log(\alpha) + \beta*log(L_i) + \epsilon_i
\]</span></p>
<p>Esto simplifica mucho el problema de regresión, pues hace el error
aditivo y estabiliza las varianzas del modelo por los logaritmos y,
sobre todo, nos permite aplicar la RLS que ya conocemos. De hecho, este
era el modo en el cuál se aplicaban antes las regresiones no lineales:
linealizar la ecuación y luego utilizar RLS (o RLM) para estimar los
coeficientes. Luego, re-convertir los coeficientes transformados
(<em>e.g.</em> <span class="math inline">\(log(\alpha)\)</span>) para
interpretar adecuadamente sus valores. Un proceso que se vuelve más
engorroso conforme incrementa la complejidad (intenta hacerlo con el
modelo VB), además de que no siempre es posible alcanzar un modelo
lineal. Afortunadamente, podemos echar mano de las computadoras para no
tener que resolverlo de esta manera. Apliquemos entonces el modelo
potencial de relación talla/peso por ambas vías. Primero, el modelo
linealizado:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ruffe_lm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>wt</span><span class='op'>)</span><span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>lt</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>ruffe</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ruffe_lm</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = log(wt) ~ log(lt), data = ruffe)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.25499 -0.06744  0.00552  0.08638  1.08984 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -10.88841    0.05123  -212.5   &lt;2e-16 ***
log(lt)       2.92247    0.01131   258.4   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.164 on 734 degrees of freedom
Multiple R-squared:  0.9891,    Adjusted R-squared:  0.9891 
F-statistic: 6.678e+04 on 1 and 734 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<p>Si graficamos este modelo directamente vamos a tener un problema:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fitted</span> <span class='op'>&lt;-</span> <span class='va'>ruffe_lm</span><span class='op'>$</span><span class='va'>fitted.values</span>
<span class='va'>ruffe_plot</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>fitted</span><span class='op'>)</span>,
                       color <span class='op'>=</span> <span class='st'>"#ff7f0e"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-21-1.png" width="624" /></p>
</div>
<p>Habrá entonces que re-convertir para pasar al espacio original de
nuestro modelo:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fitted_rec</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>ruffe_lm</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>*</span><span class='va'>ruffe</span><span class='op'>$</span><span class='va'>lt</span><span class='op'>^</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>ruffe_lm</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
<span class='va'>ruffe_plot</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>fitted_rec</span><span class='op'>)</span>,
                       color <span class='op'>=</span> <span class='st'>"#ff7f0e"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-22-1.png" width="624" /></p>
</div>
<p>Como te darás cuenta, el método funciona, pero es un poco
convolucionado. Ajustemos ahora el modelo potencial con la función
<code>nls</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ruffe_pot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/nls.html'>nls</a></span><span class='op'>(</span><span class='va'>wt</span><span class='op'>~</span><span class='va'>A</span><span class='op'>*</span><span class='va'>lt</span><span class='op'>^</span><span class='op'>{</span><span class='va'>B</span><span class='op'>}</span>,
                 data <span class='op'>=</span> <span class='va'>ruffe</span>,
                 start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>A <span class='op'>=</span> <span class='fl'>0.05</span>,
                           B <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ruffe</span><span class='op'>$</span><span class='va'>pot_pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ruffe_pot</span>, <span class='va'>ruffe</span><span class='op'>$</span><span class='va'>lt</span><span class='op'>)</span>
<span class='va'>ruffe_plot</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>ruffe</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>pot_pred</span><span class='op'>)</span>,
                       color <span class='op'>=</span> <span class='st'>"#ff7f0e"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-23-1.png" width="624" /></p>
</div>
<p>Mucho más simple, ¿no? Veamos nuestros coeficientes:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>ruffe_pot</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           A            B 
3.213069e-05 2.813585e+00 </code></pre>
</div>
<p>Y comparémoslos con los coeficientes del modelo lineal:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>ruffe_lm</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> (Intercept) 
1.867349e-05 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>ruffe_lm</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code> log(lt) 
2.922466 </code></pre>
</div>
<p>Hay ligeras diferencias en las estimaciones, lo cual es muy
seguramente debido al cambio a escala logarítmica de los datos. ¿Cuál
utilizar? Cualquiera de las aproximaciones es correcta, solo ten en
presente que el utilizar una RLS implica jalar todos sus supuestos, por
lo que hay que verificar el modelo:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>performance</span><span class='fu'>::</span><span class='fu'><a href='https://easystats.github.io/performance/reference/check_model.html'>check_model</a></span><span class='op'>(</span><span class='va'>ruffe_lm</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c10_no_lineal_files/figure-html5/unnamed-chunk-26-1.png" width="624" /></p>
</div>
<p>Y es aquí donde tenemos algunos problemas, los cuales se eliminan en
la regresión no lineal. La RNL tiene únicamente dos requerimientos:</p>
<ol type="1">
<li>Haber especificado una función que describa
<strong>adecuadamente</strong> la relación entre las variables.</li>
<li>Seleccionar puntos de inicio correctos. Aún con un modelo adecuado,
si los puntos de inicio no son los correctos, puedes mandar la
estimación a un “óptimo local” en vez el “óptimo global”; es decir,
llegar a un “falso positivo”.</li>
</ol>
<p>¿Cómo seleccionar puntos de incio adecuados? Esa es la parte
complicada. Una alternativa (engorrosa) es hacerlo desde los datos. En
nuestro ejemplo particular, esto sería algo como lo siguiente:</p>
<ul>
<li>Seleccionar una observación por parámetro. En nuestro caso, tenemos
2: <span class="math inline">\(\alpha\)</span> y <span
class="math inline">\(\beta\)</span>, por lo que seleccionaremos dos
individuos de nuestra base de datos. Una idea puede ser seleccionar los
extremos en <span class="math inline">\(x\)</span>:</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>min_ruffe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.min</a></span><span class='op'>(</span><span class='va'>ruffe</span><span class='op'>$</span><span class='va'>lt</span><span class='op'>)</span>
<span class='va'>max_ruffe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.max</a></span><span class='op'>(</span><span class='va'>ruffe</span><span class='op'>$</span><span class='va'>lt</span><span class='op'>)</span>

<span class='va'>ruffe</span><span class='op'>[</span><span class='va'>min_ruffe</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code>    lt  wt
463 13 0.1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ruffe</span><span class='op'>[</span><span class='va'>max_ruffe</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code>     lt   wt
314 192 93.1</code></pre>
</div>
<ul>
<li>Generar una ecuación para cada observación:</li>
</ul>
<p><span class="math display">\[
0.1 = A * 13^B \\
93.1 = A*192^B
\]</span></p>
<ul>
<li>Resolvemos la primera ecuación para el parámetro que sea más
sencillo despejar, en este caso A:</li>
</ul>
<p><span class="math display">\[
A = \frac{0.1}{13^B}
\]</span></p>
<p>A no puede ser mayor a 0.1, por lo que podemos seleccionar 0.05 como
punto de inicio.</p>
<ul>
<li>Utilizar ese valor para “estimar” B:</li>
</ul>
<span class="math display">\[
log(0.1) = log(0.05) + B*13 \\
\therefore \\
B = \frac{log(0.1)}{13} - log(0.05)
\]</span>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>13</span><span class='op'>)</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>0.05</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 3</code></pre>
</div>
<p>Estos valores, de hecho, fueron los que le pasamos a la función
<code>nls</code>. ¿Y la segunda observación? (el dato mayor) Esta puede
ser útil para estimar un límite superior para el valor posible del
parámetro. <strong>OJO</strong>: esto es solo si quieres evitar estar
“jugando” con los valores. A final de cuentas, solo necesitamos acercar
al algoritmo de búsqueda a la zona correcta, no darle la respuesta de
antemano. Otra alternativa es linealizar el modelo y utilizar los
parámetros re-convertidos como puntos de inicio. Una alternativa más es
utilizar datos de la literatura. En este caso, estimaciones que hayan
sido realizadas para otra localidad o en una especie cercana. Otra
estrategia puede ser utilizar una RL tradicional y estimar los valores
desde ahí. Por último, siempre podemos intentar adivinarlos a ojo,
aunque eso es algo que requiere tener bastante experiencia y capacidad
de abstracción.</p>
<h2 id="ejercicio">Ejercicio</h2>
<p>En este ejercicio tienes dos opciones:</p>
<ol type="1">
<li><p>Utiliza los datos <code>dolphin_age.csv</code> para ajustar el
modelo de Von Bertalanffy y un modelo de crecimiento más. Compáralos
utilizando el AIC y reporta e interpreta los resultados del “mejor”
modelo (AIC más bajo). Estos son datos simulados del crecimiento del
delfín Franciscana (o delfín del Plata, <em>Pontoporia
blainvillei</em>). Puedes revisar la <a
href="https://doi.org/10.1017/S0025315410001141">referencia original</a>
para darte una idea del problema. Los datos que se simularon fueron los
de las hembras.</p></li>
<li><p>Utiliza datos propios para ajustar un modelo NO lineal y reporta
e interpreta los resultados. No es necesario que describas
detalladamente de qué son, únicamente la escala temporal (<em>e.g.</em>,
días, segundos, años).</p></li>
</ol>
<div class="sourceCode" id="cb17"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p>© Copyright 2021 <a href="https://www.drplancton.com">Dr.
Plancton</a>.</p>
<p>Software licensed under the <a
href="https://www.apache.org/licenses/LICENSE-2.0">Apache License,
v2.0</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
