<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Bioestadística con R: Regresiones Lineales Múltiples</title>



  <meta name="article:author" content="M. en C. Arturo Bell Enríquez García"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Bioestadística con R: Regresiones Lineales Múltiples"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Bioestadística con R"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Bioestadística con R: Regresiones Lineales Múltiples"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","output"]}},"value":[{"type":"character","attributes":{},"value":["Regresiones Lineales Múltiples"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["M. en C. Arturo Bell Enríquez García"]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_float","code_download"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
  <link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
  <script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Regresiones Lineales Múltiples","authors":[{"author":"M. en C. Arturo Bell Enríquez García","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://drplancton.com">
<img src="logo.png" alt="Logo"/>
</a>
<a href="index.html" class="title">Bioestadística con R</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Temas
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="s1_biolcdatos.html">S1 - Biología como Ciencia de Datos</a>
<a href="s2_herrbasic.html">S2 - Herramientas Básicas</a>
<a href="s3_rel_lin.html">S3 - Relaciones Lineales</a>
<a href="s4_noparnolin.html">S4 - No Paramétrico y No Lineal</a>
<a href="s5_mv.html">S5 - Técnicas Multivariadas</a>
</div>
</div>
</div>
<div class="nav-right">
<a href="about.html">Acerca de</a>
<a href="https://github.com/ArturoBell/Bioestadistica_R">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Regresiones Lineales Múltiples</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  
  M. en C. Arturo Bell Enríquez García
  

</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#funciones-personalizadas">Funciones personalizadas</a></li>
<li><a href="#regresión-lineal-múltiple">Regresión Lineal Múltiple</a></li>
<li><a href="#regularización-l2-regresión-ridge">Regularización L2: Regresión Ridge</a></li>
<li><a href="#regularización-l1-regresión-lasso">Regularización L1: Regresión Lasso</a></li>
<li><a href="#ingeniería-de-variables">Ingeniería de variables</a></li>
<li><a href="#ejercicio-1">Ejercicio 1</a></li>
<li><a href="#ejercicio-2">Ejercicio 2</a></li>
<li><a href="#datos">Datos:</a>
<ul>
<li><a href="#entrenamiento">Entrenamiento</a></li>
<li><a href="#prueba">Prueba</a></li>
</ul></li>
</ul>
</nav>
</div>
<p><strong><a href="https://youtu.be/Kb8CwFgC9Zs">VIDEO</a></strong></p>
<h2 id="funciones-personalizadas">Funciones personalizadas</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Tema personalizado</span>
<span class='va'>blank_theme</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>aspect.ratio</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>1.61</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        axis.line <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        aspect.ratio <span class='op'>=</span> <span class='va'>aspect.ratio</span>,
        axis.ticks <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"gray50"</span><span class='op'>)</span>, <span class='co'># Eliminar</span>
        legend.position <span class='op'>=</span> <span class='st'>"none"</span>
        <span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<h2 id="regresión-lineal-múltiple">Regresión Lineal Múltiple</h2>
<p>Para esta sección utilizaremos los datos de la base <code>crime.csv</code>. El objetivo será predecir la tasa de crimenes/poblacion a partir de otras 88 variables:</p>
<p>La variable que nos interesa predecir es el la columna <code>ViolentCrimesPerPop</code>). Apliquemos un modelo de regresión lineal múltiple incluyendo todas las variables, sin dividir los datos en entrenamiento-prueba y sin escalarlos. Tampoco filtraremos los datos para evitar una fuga de información:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dr.df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"data/crime.csv"</span><span class='op'>)</span><span class='op'>[</span>,<span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dr.df</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  population householdsize agePct12t21 agePct12t29 agePct16t24 agePct65up
1      11980          3.10       12.47       21.44       10.93      11.33
2      23123          2.82       11.01       21.30       10.48      17.18
3      29344          2.43       11.36       25.88       11.01      10.28
4      16656          2.40       12.55       25.20       12.19      17.57
5     140494          2.45       18.09       32.89       20.04      13.26
6      28700          2.60       11.17       27.41       12.76      14.42
  numbUrban pctUrban medIncome pctWWage pctWFarmSelf pctWInvInc pctWSocSec
1     11980      100     75122    89.24         1.55      70.20      23.62
2     23123      100     47917    78.99         1.11      64.11      35.50
3     29344      100     35669    82.00         1.15      55.73      22.25
4         0        0     20580    68.15         0.24      38.95      39.48
5    140494      100     21577    75.78         1.00      41.15      29.31
6     28700      100     42805    79.47         0.39      47.70      30.23
  pctWPubAsst pctWRetire medFamInc perCapInc NumUnderPov PctPopUnderPov
1        1.03      18.39     79584     29711         227           1.96
2        2.75      22.85     55323     20148         885           3.98
3        2.94      14.56     42112     16946        1389           4.75
4       11.71      18.33     26501     10810        2831          17.23
5        7.12      14.09     27705     11878       23223          17.78
6        5.41      17.23     50394     18193        1126           4.01
  PctLess9thGrade PctNotHSGrad PctBSorMore PctUnemployed PctEmploy PctEmplManu
1            5.81         9.90       48.18          2.70     64.55       14.65
2            5.61        13.72       29.89          2.43     61.96       12.26
3            2.80         9.09       30.13          4.01     69.80       15.95
4           11.05        33.68       10.81          9.86     54.74       31.22
5            8.76        23.03       20.66          5.72     59.02       14.31
6            4.49        13.89       27.01          4.85     65.42       14.02
  PctEmplProfServ PctOccupManu PctOccupMgmtProf MalePctDivorce MalePctNevMarr
1           28.82         5.49            50.73           3.67          26.38
2           29.28         6.39            37.64           4.23          27.99
3           21.52         8.79            32.48          10.10          25.78
4           27.43        26.76            22.71          10.98          28.15
5           26.83        14.72            23.42          11.40          33.32
6           27.17         8.50            32.78           5.97          36.05
  FemalePctDiv TotalPctDiv PersPerFam PctFam2Par PctKids2Par PctYoungKids2Par
1         5.22        4.47       3.22      91.43       90.17            95.78
2         6.45        5.42       3.11      86.91       85.33            96.82
3        14.76       12.55       2.95      78.54       78.85            92.37
4        14.47       12.91       2.98      64.02       62.36            65.38
5        14.46       13.04       2.89      71.94       69.79            79.76
6         9.06        7.64       3.14      79.53       79.76            92.05
  PctTeen2Par PctWorkMomYoungKids PctWorkMom NumKidsBornNeverMar
1       95.81               44.56      58.88                  31
2       86.46               51.14      62.43                  43
3       75.72               66.08      74.19                 164
4       67.43               59.59      70.27                 561
5       75.33               62.96      70.52                1511
6       77.12               65.16      72.81                 263
  PctKidsBornNeverMar NumImmig PctImmigRecent PctImmigRec5 PctImmigRec8
1                0.36     1277           8.69        13.00        20.99
2                0.24     1920           5.21         8.65        13.33
3                0.88     1468          16.42        23.98        32.08
4                3.84      339          13.86        13.86        15.34
5                1.58     2091          21.33        30.56        38.02
6                1.18     2637          11.38        16.27        23.93
  PctImmigRec10 PctRecentImmig PctRecImmig5 PctRecImmig8 PctRecImmig10
1         30.93           0.93         1.39         2.24          3.30
2         22.50           0.43         0.72         1.11          1.87
3         35.63           0.82         1.20         1.61          1.78
4         15.34           0.28         0.28         0.31          0.31
5         45.48           0.32         0.45         0.57          0.68
6         27.76           1.05         1.49         2.20          2.55
  PctSpeakEnglOnly PctNotSpeakEnglWell PctLargHouseFam PctLargHouseOccup
1            85.68                1.37            4.81              4.17
2            87.79                1.81            4.25              3.34
3            93.11                1.14            2.97              2.05
4            94.98                0.56            3.93              2.56
5            96.87                0.60            3.08              1.92
6            89.98                0.60            5.08              3.46
  PersPerOccupHous PersPerOwnOccHous PersPerRentOccHous PctPersOwnOccup
1             2.99              3.00               2.84           91.46
2             2.70              2.83               1.96           89.03
3             2.42              2.69               2.06           64.18
4             2.37              2.51               2.20           58.18
5             2.28              2.37               2.16           57.81
6             2.55              2.89               2.09           64.62
  PctPersDenseHous PctHousLess3BR MedNumBR HousVacant PctHousOccup
1             0.39          11.06        3         64        98.37
2             1.01          23.60        3        240        97.15
3             2.03          47.46        3        544        95.68
4             1.21          45.66        3        669        91.19
5             2.11          53.19        2       5119        91.81
6             1.47          47.35        3        566        95.11
  PctHousOwnOcc PctVacantBoarded PctVacMore6Mos MedYrHousBuilt PctHousNoPhone
1         91.01             3.12          37.50           1959           0.00
2         84.88             0.00          18.33           1958           0.31
3         57.79             0.92           7.54           1976           1.55
4         54.89             2.54          57.85           1939           7.00
5         55.50             2.09          26.22           1966           6.13
6         56.96             1.41          34.45           1956           0.69
  PctWOFullPlumb OwnOccLowQuart OwnOccMedVal OwnOccHiQuart OwnOccQrange
1           0.28         215900       262600        326900       111000
2           0.14         136300       164200        199900        63600
3           0.12          74700        90400        112000        37300
4           0.87          36400        49600         66500        30100
5           0.31          37700        53900         73100        35400
6           0.28         155100       179000        215500        60400
  RentLowQ RentMedian RentHighQ RentQrange MedRent MedRentPctHousInc
1      685       1001      1001        316    1001              23.8
2      467        560       672        205     627              27.6
3      370        428       520        150     484              24.1
4      195        250       309        114     333              28.7
5      215        280       349        134     340              26.4
6      463        669       824        361     736              24.4
  MedOwnCostPctInc MedOwnCostPctIncNoMtg NumInShelters NumStreet PctForeignBorn
1             21.1                  14.0            11         0          10.66
2             20.7                  12.5             0         0           8.30
3             21.7                  11.6            16         0           5.00
4             20.6                  14.5             0         0           2.04
5             17.3                  11.7           327         4           1.49
6             20.8                  12.5             0         0           9.19
  PctBornSameState PctSameHouse85 PctSameCity85 PctSameState85
1            53.72          65.29         78.09          89.14
2            77.17          71.27         90.22          96.12
3            44.77          36.60         61.26          82.85
4            88.71          56.70         90.17          96.24
5            64.35          42.29         70.61          85.66
6            77.30          63.45         82.23          93.53
  ViolentCrimesPerPop
1               41.02
2              127.56
3              218.59
4              306.64
5              442.95
6              226.63</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dr.lm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>ViolentCrimesPerPop</span><span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>dr.df</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>dr.lm</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = ViolentCrimesPerPop ~ ., data = dr.df)

Residuals:
     Min       1Q   Median       3Q      Max 
-1776.25  -184.04   -36.85   126.83  2194.09 

Coefficients: (2 not defined because of singularities)
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           -1.195e+03  3.295e+03  -0.363 0.716842    
population             2.324e-04  2.049e-03   0.113 0.909703    
householdsize         -7.569e+01  1.161e+02  -0.652 0.514556    
agePct12t21            8.262e+00  1.279e+01   0.646 0.518346    
agePct12t29           -3.394e+01  1.265e+01  -2.684 0.007344 ** 
agePct16t24            1.250e+01  1.832e+01   0.682 0.495175    
agePct65up            -1.119e+01  1.094e+01  -1.023 0.306440    
numbUrban             -7.223e-04  2.023e-03  -0.357 0.721118    
pctUrban               1.245e+00  4.790e-01   2.598 0.009436 ** 
medIncome             -1.430e-02  7.156e-03  -1.998 0.045806 *  
pctWWage              -9.557e+00  5.869e+00  -1.628 0.103596    
pctWFarmSelf           2.328e+01  1.577e+01   1.476 0.139992    
pctWInvInc            -6.764e+00  2.495e+00  -2.711 0.006771 ** 
pctWSocSec             7.969e+00  5.907e+00   1.349 0.177469    
pctWPubAsst            7.796e+00  5.838e+00   1.336 0.181861    
pctWRetire            -9.214e+00  3.761e+00  -2.450 0.014395 *  
medFamInc              9.378e-03  6.899e-03   1.359 0.174165    
perCapInc              8.988e-04  7.623e-03   0.118 0.906152    
NumUnderPov            2.705e-05  2.451e-03   0.011 0.991196    
PctPopUnderPov        -6.144e+00  4.830e+00  -1.272 0.203515    
PctLess9thGrade       -1.551e+01  6.320e+00  -2.454 0.014224 *  
PctNotHSGrad           5.368e+00  4.856e+00   1.105 0.269148    
PctBSorMore            2.611e+00  3.528e+00   0.740 0.459310    
PctUnemployed         -1.734e+00  8.005e+00  -0.217 0.828581    
PctEmploy              9.473e+00  4.809e+00   1.970 0.048991 *  
PctEmplManu           -3.843e+00  2.133e+00  -1.802 0.071766 .  
PctEmplProfServ       -3.164e-01  2.939e+00  -0.108 0.914297    
PctOccupManu           1.303e+00  4.631e+00   0.281 0.778521    
PctOccupMgmtProf       5.127e+00  4.664e+00   1.099 0.271738    
MalePctDivorce         1.522e+02  6.854e+01   2.220 0.026545 *  
MalePctNevMarr         8.419e+00  4.851e+00   1.735 0.082826 .  
FemalePctDiv           9.881e+01  7.178e+01   1.376 0.168838    
TotalPctDiv           -2.388e+02  1.391e+02  -1.717 0.086211 .  
PersPerFam            -1.409e+02  3.512e+02  -0.401 0.688213    
PctFam2Par             1.025e+01  8.784e+00   1.167 0.243302    
PctKids2Par           -2.718e+01  6.971e+00  -3.899 9.99e-05 ***
PctYoungKids2Par       2.794e+00  2.394e+00   1.167 0.243347    
PctTeen2Par            3.471e-01  2.206e+00   0.157 0.874962    
PctWorkMomYoungKids    3.659e+00  2.772e+00   1.320 0.186938    
PctWorkMom            -9.343e+00  4.011e+00  -2.330 0.019934 *  
NumKidsBornNeverMar   -5.637e-03  4.186e-03  -1.347 0.178236    
PctKidsBornNeverMar    5.992e+01  9.252e+00   6.476 1.19e-10 ***
NumImmig               1.029e-03  6.746e-04   1.525 0.127400    
PctImmigRecent         2.153e+00  2.427e+00   0.887 0.375132    
PctImmigRec5          -7.823e-01  3.071e+00  -0.255 0.798944    
PctImmigRec8          -1.118e+00  3.000e+00  -0.373 0.709366    
PctImmigRec10          1.574e+00  1.941e+00   0.811 0.417541    
PctRecentImmig        -1.221e+01  4.962e+01  -0.246 0.805635    
PctRecImmig5          -2.038e+01  6.021e+01  -0.339 0.734999    
PctRecImmig8           1.590e+01  5.660e+01   0.281 0.778799    
PctRecImmig10         -1.628e+01  3.339e+01  -0.487 0.626032    
PctSpeakEnglOnly       1.257e+00  2.282e+00   0.551 0.581825    
PctNotSpeakEnglWell   -2.051e+01  9.371e+00  -2.189 0.028740 *  
PctLargHouseFam        1.952e+01  3.179e+01   0.614 0.539258    
PctLargHouseOccup     -4.263e+01  3.462e+01  -1.232 0.218279    
PersPerOccupHous       4.037e+02  4.203e+02   0.960 0.336949    
PersPerOwnOccHous      3.591e+02  2.801e+02   1.282 0.199951    
PersPerRentOccHous    -3.337e+02  1.157e+02  -2.883 0.003981 ** 
PctPersOwnOccup       -4.662e+01  1.710e+01  -2.726 0.006470 ** 
PctPersDenseHous       2.175e+01  6.714e+00   3.240 0.001216 ** 
PctHousLess3BR         2.723e+00  2.058e+00   1.323 0.185976    
MedNumBR               3.528e+01  2.662e+01   1.325 0.185226    
HousVacant             2.096e-02  6.107e-03   3.432 0.000611 ***
PctHousOccup          -1.933e+00  2.654e+00  -0.728 0.466650    
PctHousOwnOcc          4.273e+01  1.714e+01   2.493 0.012761 *  
PctVacantBoarded       1.413e+01  3.611e+00   3.914 9.41e-05 ***
PctVacMore6Mos        -2.027e+00  9.147e-01  -2.216 0.026785 *  
MedYrHousBuilt         1.840e+00  1.559e+00   1.180 0.238222    
PctHousNoPhone         2.863e+00  5.658e+00   0.506 0.612853    
PctWOFullPlumb        -5.755e+00  2.581e+01  -0.223 0.823578    
OwnOccLowQuart         5.157e-05  1.316e-03   0.039 0.968733    
OwnOccMedVal           2.811e-04  1.555e-03   0.181 0.856587    
OwnOccHiQuart         -6.922e-04  6.662e-04  -1.039 0.298916    
OwnOccQrange                  NA         NA      NA       NA    
RentLowQ              -6.198e-01  2.612e-01  -2.373 0.017732 *  
RentMedian            -2.455e-01  4.906e-01  -0.500 0.616889    
RentHighQ             -2.857e-01  2.836e-01  -1.008 0.313822    
RentQrange                    NA         NA      NA       NA    
MedRent                1.192e+00  4.267e-01   2.792 0.005285 ** 
MedRentPctHousInc     -2.590e+00  5.227e+00  -0.496 0.620222    
MedOwnCostPctInc      -1.100e+00  5.934e+00  -0.185 0.852896    
MedOwnCostPctIncNoMtg -2.819e+01  8.839e+00  -3.189 0.001450 ** 
NumInShelters          7.886e-02  5.928e-02   1.330 0.183602    
NumStreet             -3.028e-02  1.427e-01  -0.212 0.832056    
PctForeignBorn         1.934e+01  6.651e+00   2.908 0.003681 ** 
PctBornSameState       8.863e-01  1.353e+00   0.655 0.512569    
PctSameHouse85         1.302e+00  2.646e+00   0.492 0.622713    
PctSameCity85          1.212e+00  1.995e+00   0.607 0.543621    
PctSameState85        -2.109e+00  3.135e+00  -0.673 0.501232    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 363 on 1907 degrees of freedom
Multiple R-squared:  0.6665,    Adjusted R-squared:  0.6514 
F-statistic: 44.31 on 86 and 1907 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>dr.df</span><span class='op'>$</span><span class='va'>RentQrange</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.0   139.0   173.0   200.3   241.0   803.0 </code></pre>
</div>
<p>Veamos qué pasa ahora si aplicamos este mismo modelo realizando la división entrenamiento-prueba.</p>
<h4 id="evaluación-el-problema-del-exceso-de-dimensionalidad-y-el-sobreajuste">Evaluación, el PROBLEMA del exceso de dimensionalidad y el sobreajuste:</h4>
<p>Para realizar la división utilizaremos la función <code>sample.split()</code> de librería caTools:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/topepo/caret/'>caret</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>caTools</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1111</span><span class='op'>)</span>
<span class='va'>sample</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caTools/man/sample.split.html'>sample.split</a></span><span class='op'>(</span><span class='va'>dr.df</span><span class='op'>$</span><span class='va'>ViolentCrimesPerPop</span>, SplitRatio <span class='op'>=</span> <span class='fl'>.75</span><span class='op'>)</span>
<span class='va'>train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>dr.df</span>, <span class='va'>sample</span> <span class='op'>==</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>test</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>dr.df</span>, <span class='va'>sample</span> <span class='op'>==</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Ajustemos el modelo de entrenamiento:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>train.dr.lm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>ViolentCrimesPerPop</span><span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>train</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>train.dr.lm</span><span class='op'>)</span><span class='op'>$</span><span class='va'>r.squared</span><span class='op'>*</span><span class='fl'>100</span>
</code></pre>
</div>
<pre><code>[1] 67.85562</code></pre>
</div>
<p>Evaluemos el desempeño en los datos de prueba.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.lm.html'>predict.lm</a></span><span class='op'>(</span><span class='va'>train.dr.lm</span>, <span class='va'>test</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>88</span><span class='op'>]</span><span class='op'>)</span> 
<span class='fu'><a href='https://rdrr.io/pkg/caret/man/postResample.html'>R2</a></span><span class='op'>(</span><span class='va'>pred</span>, <span class='va'>test</span><span class='op'>$</span><span class='va'>ViolentCrimesPerPop</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>100</span>
</code></pre>
</div>
<pre><code>[1] 60.2964</code></pre>
</div>
<p>De estos resultados vemos que el modelo está sobreajustado, ya que el <span class="math inline">\(R^2\)</span> del modelo de prueba menor al de entrenamiento. Tomando esto en consideración, 1) escalemos los datos y b) apliquemos los modelos regularizados.</p>
<p>Para hacer las cosas más organizadas, primero dividamos ambos sets de datos en dos objetos: uno con las variables independientes y otro con la variable dependiente:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>X_train</span> <span class='op'>&lt;-</span> <span class='va'>train</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>88</span><span class='op'>]</span>
<span class='va'>y_train</span> <span class='op'>&lt;-</span> <span class='va'>train</span><span class='op'>$</span><span class='va'>ViolentCrimesPerPop</span>
<span class='va'>X_test</span> <span class='op'>&lt;-</span> <span class='va'>test</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>88</span><span class='op'>]</span>
<span class='va'>y_test</span> <span class='op'>&lt;-</span> <span class='va'>test</span><span class='op'>$</span><span class='va'>ViolentCrimesPerPop</span>
</code></pre>
</div>
</div>
<p>Ahora estandaricemos las variables dependientes:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>preProc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/preProcess.html'>preProcess</a></span><span class='op'>(</span><span class='va'>X_train</span>, method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"center"</span>, <span class='st'>"scale"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>X_train_s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>preProc</span>, <span class='va'>X_train</span><span class='op'>)</span>
<span class='va'>X_test_s</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>preProc</span>, <span class='va'>X_test</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="regularización-l2-regresión-ridge">Regularización L2: Regresión Ridge</h2>
<p>Apliquemos la regresión al set de entrenamiento. Debido a que el valor de penalización (<span class="math inline">\(\alpha\)</span> en la clase, <span class="math inline">\(\lambda\)</span> en glmnet) es “arbitrario”, podemos utilizar validación cruzada para encontrar el valor que mejor se ajuste a nuestros datos. La validación cruzada consiste en hacer k particiones entrenamiento-prueba de los datos, ajustar un modelo para cada k para cada valor del parámetro que sea de nuestro interés, promediar el valor de error de cada iteración y quedarnos con el valor del parámetro que haya logrado el menor valor de nuestra medida de error. En la librería <code>glmnet</code> esto se hace con la función <code>cv.glmnet</code>, la cual recibe como argumentos una matriz de variables independientes, un vector con variables dependientes, un valor de alpha que será 0 para regresión Ridge, 1 para Lasso y algún intermedio para red elástica (no la veremos en el curso) y el tipo de medida de error, en este caso MSE.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://glmnet.stanford.edu'>glmnet</a></span><span class='op'>)</span>
<span class='va'>cv.ridge</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>X_train_s</span><span class='op'>)</span>, <span class='va'>y_train</span>, alpha <span class='op'>=</span> <span class='fl'>0</span>, type.measure <span class='op'>=</span> <span class='st'>"mse"</span><span class='op'>)</span>
<span class='co'># Valor de lambda que otorga el menor valor de error</span>
<span class='va'>lambdamin</span> <span class='op'>&lt;-</span> <span class='va'>cv.ridge</span><span class='op'>$</span><span class='va'>lambda.min</span> 
<span class='va'>lambdamin</span>
</code></pre>
</div>
<pre><code>[1] 127.2735</code></pre>
</div>
<p>Ajustemos entonces el modelo regularizado con ese valor de lambda. (Df representa el número de coeficientes no negativos, <span class="math inline">\(\%Dev = R^2\)</span>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ridge.lm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>X_train_s</span><span class='op'>)</span>, <span class='va'>y_train</span>, alpha <span class='op'>=</span> <span class='fl'>0</span>, lambda <span class='op'>=</span> <span class='va'>lambdamin</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>ridge.lm</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:  glmnet(x = as.matrix(X_train_s), y = y_train, alpha = 0, lambda = lambdamin) 

  Df  %Dev Lambda
1 88 64.37  127.3</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>ridge.lm</span><span class='op'>)</span> <span class='co'># Imprime los coeficientes de la regresión</span>
</code></pre>
</div>
<pre><code>89 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
                               s0
(Intercept)           594.3309632
population              1.9300180
householdsize           1.8299619
agePct12t21            -7.3486939
agePct12t29           -31.9576114
agePct16t24           -13.7190597
agePct65up             -0.7500937
numbUrban               2.9093075
pctUrban               48.9548756
medIncome               4.4813095
pctWWage              -13.4939524
pctWFarmSelf           -2.5372388
pctWInvInc            -39.4099456
pctWSocSec              5.7726094
pctWPubAsst             8.2557445
pctWRetire            -31.5772883
medFamInc               0.1869270
perCapInc               7.2125911
NumUnderPov             1.3516081
PctPopUnderPov          1.6304773
PctLess9thGrade       -24.2107288
PctNotHSGrad           23.9205978
PctBSorMore            -4.7951480
PctUnemployed          -4.4677466
PctEmploy              -0.6736613
PctEmplManu           -25.2037054
PctEmplProfServ        -0.9096683
PctOccupManu            1.2909056
PctOccupMgmtProf        6.1034532
MalePctDivorce         39.3996963
MalePctNevMarr         24.5249604
FemalePctDiv           -5.6875449
TotalPctDiv            12.4548611
PersPerFam             13.1410156
PctFam2Par            -54.0844979
PctKids2Par           -76.7466711
PctYoungKids2Par      -22.7957248
PctTeen2Par           -31.7585992
PctWorkMomYoungKids    10.6242815
PctWorkMom            -29.0347493
NumKidsBornNeverMar    10.5416166
PctKidsBornNeverMar   142.4105435
NumImmig              -19.0071427
PctImmigRecent          5.4033013
PctImmigRec5           -7.4524167
PctImmigRec8            2.4384854
PctImmigRec10          11.0250579
PctRecentImmig         -4.3029127
PctRecImmig5           -1.6401076
PctRecImmig8            8.0026637
PctRecImmig10          14.7662164
PctSpeakEnglOnly       24.9056068
PctNotSpeakEnglWell   -21.4562027
PctLargHouseFam         9.3206986
PctLargHouseOccup      -3.4064885
PersPerOccupHous       12.3918690
PersPerOwnOccHous      -8.3730487
PersPerRentOccHous      8.5386052
PctPersOwnOccup       -10.1687491
PctPersDenseHous       36.0367459
PctHousLess3BR          8.7490050
MedNumBR               -3.0382968
HousVacant             39.6081968
PctHousOccup          -16.0266762
PctHousOwnOcc           4.3255442
PctVacantBoarded       48.6961138
PctVacMore6Mos        -13.2650164
MedYrHousBuilt         14.3259260
PctHousNoPhone         17.6682547
PctWOFullPlumb          1.1437346
OwnOccLowQuart         -3.6714089
OwnOccMedVal           -1.3201613
OwnOccHiQuart          -0.5468553
OwnOccQrange            4.7164888
RentLowQ              -15.2916481
RentMedian              0.9769829
RentHighQ               0.1358997
RentQrange             25.8023901
MedRent                15.3168827
MedRentPctHousInc      12.2762392
MedOwnCostPctInc        3.8327009
MedOwnCostPctIncNoMtg -31.6350261
NumInShelters          13.7891862
NumStreet              -8.1076432
PctForeignBorn         25.5580343
PctBornSameState      -15.0924908
PctSameHouse85         20.2263294
PctSameCity85          10.5844297
PctSameState85         -3.4981307</code></pre>
</div>
<p>Vemos que el valor de R2 es ligeramente menor al caso anterior; sin embargo, ganamos un poco de poder predictivo en el modelo de prueba:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ridge.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge.lm</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>X_test_s</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/caret/man/postResample.html'>R2</a></span><span class='op'>(</span><span class='va'>ridge.pred</span>, <span class='va'>y_test</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>100</span>
</code></pre>
</div>
<pre><code>           s0
[1,] 62.57724</code></pre>
</div>
<p>Veamos cómo afecta el valor de lambda:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span> <span class='op'>(</span><span class='va'>lambda</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>50</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>lambdamin</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>ridge.lm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>X_train_s</span><span class='op'>)</span>, <span class='va'>y_train</span>, alpha <span class='op'>=</span> <span class='fl'>0</span>,
                     lambda <span class='op'>=</span> <span class='va'>lambda</span>, standardize <span class='op'>=</span> <span class='cn'>F</span>,
                     standardize.response <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>
  
  <span class='va'>ridge.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge.lm</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>X_test_s</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"lambda = "</span>, <span class='va'>lambda</span>, 
              <span class='st'>"; Variables restantes:"</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>ridge.lm</span><span class='op'>$</span><span class='va'>df</span>, <span class='fl'>2</span><span class='op'>)</span>, 
              <span class='st'>"; R^2 entrenamiento = "</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>ridge.lm</span><span class='op'>$</span><span class='va'>dev.ratio</span>,<span class='fl'>2</span><span class='op'>)</span>, 
              <span class='st'>"; R^2 prueba = "</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/caret/man/postResample.html'>R2</a></span><span class='op'>(</span><span class='va'>ridge.pred</span>, <span class='va'>y_test</span><span class='op'>)</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  
<span class='op'>}</span>
</code></pre>
</div>
<pre><code>[1] &quot;lambda =  0 ; Variables restantes: 88 ; R^2 entrenamiento =  0.68 ; R^2 prueba =  0.6&quot;
[1] &quot;lambda =  0.5 ; Variables restantes: 88 ; R^2 entrenamiento =  0.68 ; R^2 prueba =  0.61&quot;
[1] &quot;lambda =  1 ; Variables restantes: 88 ; R^2 entrenamiento =  0.68 ; R^2 prueba =  0.61&quot;
[1] &quot;lambda =  2 ; Variables restantes: 88 ; R^2 entrenamiento =  0.67 ; R^2 prueba =  0.61&quot;
[1] &quot;lambda =  3 ; Variables restantes: 88 ; R^2 entrenamiento =  0.67 ; R^2 prueba =  0.62&quot;
[1] &quot;lambda =  5 ; Variables restantes: 88 ; R^2 entrenamiento =  0.67 ; R^2 prueba =  0.62&quot;
[1] &quot;lambda =  10 ; Variables restantes: 88 ; R^2 entrenamiento =  0.67 ; R^2 prueba =  0.62&quot;
[1] &quot;lambda =  20 ; Variables restantes: 88 ; R^2 entrenamiento =  0.66 ; R^2 prueba =  0.62&quot;
[1] &quot;lambda =  50 ; Variables restantes: 88 ; R^2 entrenamiento =  0.66 ; R^2 prueba =  0.63&quot;
[1] &quot;lambda =  127.27 ; Variables restantes: 88 ; R^2 entrenamiento =  0.64 ; R^2 prueba =  0.63&quot;</code></pre>
</div>
<p>Vemos que sí hay diferencias con respecto al primer caso. Apliquemos la regresión Lasso:</p>
<h2 id="regularización-l1-regresión-lasso">Regularización L1: Regresión Lasso</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cv.lasso</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>X_train_s</span><span class='op'>)</span>,
                      <span class='va'>y_train</span>, alpha <span class='op'>=</span> <span class='fl'>1</span>,
                      type.measure <span class='op'>=</span> <span class='st'>"mse"</span><span class='op'>)</span>

<span class='co'># Valor de lambda que otorga el menor valor de error</span>
<span class='va'>lambdamin</span> <span class='op'>&lt;-</span> <span class='va'>cv.lasso</span><span class='op'>$</span><span class='va'>lambda.min</span>
<span class='va'>lambdamin</span>
</code></pre>
</div>
<pre><code>[1] 11.0696</code></pre>
</div>
<p>Ajustemos entonces el modelo regularizado con ese valor de lambda. (Df representa el número de coeficientes no cero, <span class="math inline">\(\%Dev = R^2\)</span>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lasso.lm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>X_train_s</span><span class='op'>)</span>, <span class='va'>y_train</span>, alpha <span class='op'>=</span> <span class='fl'>1</span>, 
                   ambda <span class='op'>=</span> <span class='va'>lambdamin</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>lasso.lm</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:  glmnet(x = as.matrix(X_train_s), y = y_train, alpha = 1, ambda = lambdamin) 

   Df  %Dev Lambda
1   0  0.00 457.40
2   1  9.31 416.80
3   2 17.05 379.70
4   2 23.93 346.00
5   2 29.65 315.30
6   2 34.39 287.30
7   2 38.33 261.70
8   2 41.59 238.50
9   2 44.31 217.30
10  2 46.56 198.00
11  2 48.43 180.40
12  2 49.99 164.40
13  2 51.28 149.80
14  2 52.35 136.50
15  2 53.23 124.30
16  3 54.00 113.30
17  4 55.01 103.20
18  4 55.86  94.06
19  6 56.60  85.71
20  6 57.39  78.09
21  6 58.06  71.16
22  8 58.69  64.83
23  7 59.35  59.08
24  8 59.91  53.83
25  8 60.42  49.05
26 10 60.88  44.69
27 11 61.27  40.72
28 11 61.63  37.10
29 11 61.93  33.80
30 13 62.19  30.80
31 13 62.46  28.07
32 15 62.74  25.57
33 15 63.00  23.30
34 16 63.22  21.23
35 16 63.40  19.34
36 18 63.62  17.63
37 18 63.82  16.06
38 18 63.98  14.63
39 18 64.11  13.33
40 18 64.22  12.15
41 18 64.32  11.07
42 19 64.39  10.09
43 19 64.46   9.19
44 21 64.52   8.37
45 22 64.59   7.63
46 23 64.67   6.95
47 23 64.74   6.33
48 26 64.84   5.77
49 26 64.95   5.26
50 28 65.05   4.79
51 30 65.17   4.37
52 31 65.30   3.98
53 32 65.42   3.62
54 33 65.52   3.30
55 36 65.61   3.01
56 36 65.70   2.74
57 39 65.79   2.50
58 46 65.90   2.28
59 47 66.09   2.07
60 49 66.22   1.89
61 51 66.36   1.72
62 51 66.47   1.57
63 54 66.57   1.43
64 57 66.68   1.30
65 59 66.76   1.19
66 59 66.84   1.08
67 60 66.91   0.99
68 61 66.96   0.90
69 64 67.02   0.82
70 66 67.08   0.75
71 70 67.14   0.68
72 71 67.18   0.62
73 72 67.25   0.56
74 75 67.31   0.51
75 75 67.36   0.47
76 76 67.41   0.43
77 77 67.44   0.39
78 80 67.48   0.35
79 78 67.51   0.32
80 78 67.53   0.29
81 78 67.55   0.27
82 77 67.57   0.24
83 77 67.59   0.22
84 79 67.61   0.20
85 81 67.64   0.18
86 82 67.67   0.17
87 81 67.68   0.15
88 82 67.68   0.14</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>lasso.lm</span><span class='op'>)</span> <span class='co'># Imprime los coeficientes de la regresión</span>
</code></pre>
</div>
<pre><code>89 x 88 sparse Matrix of class &quot;dgCMatrix&quot;
                                                                                     
(Intercept)   594.331 594.331 594.331 594.331 594.331 594.331 594.331 594.331 594.331
population      .       .       .       .       .       .       .       .       .    
householdsize   .       .       .       .       .       .       .       .       .    
agePct12t21     .       .       .       .       .       .       .       .       .    
agePct12t29     .       .       .       .       .       .       .       .       .    
agePct16t24     .       .       .       .       .       .       .       .       .    
agePct65up      .       .       .       .       .       .       .       .       .    
numbUrban       .       .       .       .       .       .       .       .       .    
pctUrban        .       .       .       .       .       .       .       .       .    
medIncome       .       .       .       .       .       .       .       .       .    
pctWWage        .       .       .       .       .       .       .       .       .    
pctWFarmSelf    .       .       .       .       .       .       .       .       .    
pctWInvInc      .       .       .       .       .       .       .       .       .    
pctWSocSec      .       .       .       .       .       .       .       .       .    
pctWPubAsst     .       .       .       .       .       .       .       .       .    
                                                                                     
(Intercept)   594.331 594.331 594.331 594.331 594.331 594.331 594.331 594.331 594.331
population      .       .       .       .       .       .       .       .       .    
householdsize   .       .       .       .       .       .       .       .       .    
agePct12t21     .       .       .       .       .       .       .       .       .    
agePct12t29     .       .       .       .       .       .       .       .       .    
agePct16t24     .       .       .       .       .       .       .       .       .    
agePct65up      .       .       .       .       .       .       .       .       .    
numbUrban       .       .       .       .       .       .       .       .       .    
pctUrban        .       .       .       .       .       .       .       .       .    
medIncome       .       .       .       .       .       .       .       .       .    
pctWWage        .       .       .       .       .       .       .       .       .    
pctWFarmSelf    .       .       .       .       .       .       .       .       .    
pctWInvInc      .       .       .       .       .       .       .       .       .    
pctWSocSec      .       .       .       .       .       .       .       .       .    
pctWPubAsst     .       .       .       .       .       .       .       .       .    
                                                                                         
(Intercept)   594.331 594.331 594.331 594.330963 594.330963 594.33096 594.33096 594.33096
population      .       .       .       .          .          .         .         .      
householdsize   .       .       .       .          .          .         .         .      
agePct12t21     .       .       .       .          .          .         .         .      
agePct12t29     .       .       .       .          .          .         .         .      
agePct16t24     .       .       .       .          .          .         .         .      
agePct65up      .       .       .       .          .          .         .         .      
numbUrban       .       .       .       .          .          .         .         .      
pctUrban        .       .       .       1.782248   7.374335  12.25714  16.70981  20.14409
medIncome       .       .       .       .          .          .         .         .      
pctWWage        .       .       .       .          .          .         .         .      
pctWFarmSelf    .       .       .       .          .          .         .         .      
pctWInvInc      .       .       .       .          .          .         .         .      
pctWSocSec      .       .       .       .          .          .         .         .      
pctWPubAsst     .       .       .       .          .          .         .         .      
                                                                                      
(Intercept)   594.33096 594.33096 594.33096 594.3309632 594.330963 594.33096 594.33096
population      .         .         .         .           .          .         .      
householdsize   .         .         .         .           .          .         .      
agePct12t21     .         .         .         .           .          .         .      
agePct12t29     .         .         .        -0.2143759  -3.969272  -7.14454 -10.14497
agePct16t24     .         .         .         .           .          .         .      
agePct65up      .         .         .         .           .          .         .      
numbUrban       .         .         .         .           .          .         .      
pctUrban       23.07782  25.56342  27.76395  29.8510395  31.501306  32.81643  33.98538
medIncome       .         .         .         .           .          .         .      
pctWWage        .         .         .         .           .          .         .      
pctWFarmSelf    .         .         .         .           .          .         .      
pctWInvInc      .         .         .         .           .          .         .      
pctWSocSec      .         .         .         .           .          .         .      
pctWPubAsst     .         .         .         .           .          .         .      
                    
(Intercept)   ......
population    ......
householdsize ......
agePct12t21   ......
agePct12t29   ......
agePct16t24   ......
agePct65up    ......
numbUrban     ......
pctUrban      ......
medIncome     ......
pctWWage      ......
pctWFarmSelf  ......
pctWInvInc    ......
pctWSocSec    ......
pctWPubAsst   ......

 ..............................
 ........suppressing 55 columns and 59 rows in show(); maybe adjust &#39;options(max.print= *, width = *)&#39;
 ..............................
                                                                                   
RentLowQ              . . . . . . . . . . . . . . . . . . . . . . . . .  .         
RentMedian            . . . . . . . . . . . . . . . . . . . . . . . . .  .         
RentHighQ             . . . . . . . . . . . . . . . . . . . . . . . . .  .         
RentQrange            . . . . . . . . . . . . . . . . . . . . . . . . .  .         
MedRent               . . . . . . . . . . . . . . . . . . . . . . . . .  .         
MedRentPctHousInc     . . . . . . . . . . . . . . . . . . . . . . . . .  .         
MedOwnCostPctInc      . . . . . . . . . . . . . . . . . . . . . . . . .  .         
MedOwnCostPctIncNoMtg . . . . . . . . . . . . . . . . . . . . . . . . .  .         
NumInShelters         . . . . . . . . . . . . . . . . . . . . . . . . .  .         
NumStreet             . . . . . . . . . . . . . . . . . . . . . . . . .  .         
PctForeignBorn        . . . . . . . . . . . . . . . . . . . . . . . . .  0.08413911
PctBornSameState      . . . . . . . . . . . . . . . . . . . . . . . . . -2.40884180
PctSameHouse85        . . . . . . . . . . . . . . . . . . . . . . . . .  .         
PctSameCity85         . . . . . . . . . . . . . . . . . . . . . . . . .  .         
PctSameState85        . . . . . . . . . . . . . . . . . . . . . . . . .  .         
                                                                                 
RentLowQ               .         .         .         .         .         .       
RentMedian             .         .         .         .         .         .       
RentHighQ              .         .         .         .         .         .       
RentQrange             .         .         .         .         .         2.196097
MedRent                .         .         .         .         .         .       
MedRentPctHousInc      .         .         .         .         .         .       
MedOwnCostPctInc       .         .         .         .         .         .       
MedOwnCostPctIncNoMtg  .         .         .         .         .        -1.854826
NumInShelters          .         .         .         .         .         .       
NumStreet              .         .         .         .         .         .       
PctForeignBorn         1.161661  2.808844  4.421716  6.286165  6.776012  7.062480
PctBornSameState      -4.544437 -5.370713 -6.107000 -6.438609 -7.302299 -7.431214
PctSameHouse85         .         .         .         .         .         .       
PctSameCity85          .         .         .         .         .         .       
PctSameState85         .         .         .         .         .         .       
                                      
RentLowQ               .        ......
RentMedian             .        ......
RentHighQ              .        ......
RentQrange             5.015184 ......
MedRent                .        ......
MedRentPctHousInc      .        ......
MedOwnCostPctInc       .        ......
MedOwnCostPctIncNoMtg -5.521420 ......
NumInShelters          .        ......
NumStreet              .        ......
PctForeignBorn         7.615518 ......
PctBornSameState      -7.169737 ......
PctSameHouse85         .        ......
PctSameCity85          .        ......
PctSameState85         .        ......</code></pre>
</div>
<p>Vemos que el valor de R2 no es muy diferente al caso anterior, aunque ahora únicamente tenemos 18 coeficientes ≠ 0</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lasso.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lasso.lm</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>X_test_s</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/caret/man/postResample.html'>R2</a></span><span class='op'>(</span><span class='va'>lasso.pred</span>, <span class='va'>y_test</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>100</span>
</code></pre>
</div>
<pre><code>     s0       s1       s2       s3       s4       s5       s6       s7       s8
[1,] NA 53.43702 53.58489 56.11357 57.04245 57.49645 57.74942 57.90835 58.01837
           s9     s10      s11      s12      s13      s14      s15      s16
[1,] 58.09429 58.1505 58.19535 58.22881 58.25553 58.27879 58.32827 58.75626
         s17      s18      s19      s20      s21      s22      s23      s24
[1,] 59.0818 59.31473 59.58416 59.77289 59.97653 60.26295 60.48609 60.65604
          s25      s26      s27      s28      s29      s30      s31     s32
[1,] 60.78928 60.89649 60.99876 61.06659 61.14073 61.27272 61.41957 61.5762
         s33      s34     s35      s36      s37      s38      s39      s40
[1,] 61.6941 61.77421 61.8907 62.00664 62.09131 62.15658 62.20251 62.23972
         s41      s42      s43      s44      s45      s46      s47      s48
[1,] 62.2628 62.28448 62.29744 62.31266 62.37029 62.40295 62.43719 62.46325
          s49      s50      s51      s52      s53      s54      s55      s56
[1,] 62.47401 62.46936 62.43646 62.38518 62.33567 62.27896 62.22658 62.18263
          s57      s58      s59      s60      s61      s62      s63      s64
[1,] 62.15532 62.16498 62.15138 62.12958 62.10708 62.07503 62.06881 62.05471
          s65      s66      s67     s68      s69     s70      s71      s72
[1,] 62.02099 61.97628 61.93831 61.9061 61.84818 61.7983 61.75661 61.72191
          s73      s74      s75      s76      s77      s78     s79      s80
[1,] 61.68235 61.63597 61.59049 61.54589 61.50098 61.46042 61.4217 61.38118
          s81      s82      s83     s84      s85      s86      s87
[1,] 61.34312 61.30674 61.27096 61.2157 61.17072 61.13701 61.13365</code></pre>
</div>
<p>En los datos de prueba tampoco hubo mucha diferencia. Veamos cómo cambia esto al modificar el valor de lambda:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span> <span class='op'>(</span><span class='va'>lambda</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>50</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>lambdamin</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>lasso.lm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>X_train_s</span><span class='op'>)</span>, <span class='va'>y_train</span>,
                     alpha <span class='op'>=</span> <span class='fl'>1</span>, lambda <span class='op'>=</span> <span class='va'>lambda</span>,
                     standardize <span class='op'>=</span> <span class='cn'>F</span>, standardize.response <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>
  
  <span class='va'>lasso.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lasso.lm</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>X_test_s</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"lambda = "</span>, <span class='va'>lambda</span>, 
              <span class='st'>"; Variables restantes:"</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>lasso.lm</span><span class='op'>$</span><span class='va'>df</span>, <span class='fl'>2</span><span class='op'>)</span>, 
              <span class='st'>"; R^2 entrenamiento = "</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>lasso.lm</span><span class='op'>$</span><span class='va'>dev.ratio</span>,<span class='fl'>2</span><span class='op'>)</span>, 
              <span class='st'>"; R^2 prueba = "</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/caret/man/postResample.html'>R2</a></span><span class='op'>(</span><span class='va'>lasso.pred</span>, <span class='va'>y_test</span><span class='op'>)</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  
<span class='op'>}</span>
</code></pre>
</div>
<pre><code>[1] &quot;lambda =  0 ; Variables restantes: 88 ; R^2 entrenamiento =  0.68 ; R^2 prueba =  0.6&quot;
[1] &quot;lambda =  0.5 ; Variables restantes: 76 ; R^2 entrenamiento =  0.67 ; R^2 prueba =  0.62&quot;
[1] &quot;lambda =  1 ; Variables restantes: 61 ; R^2 entrenamiento =  0.67 ; R^2 prueba =  0.62&quot;
[1] &quot;lambda =  2 ; Variables restantes: 47 ; R^2 entrenamiento =  0.66 ; R^2 prueba =  0.62&quot;
[1] &quot;lambda =  3 ; Variables restantes: 36 ; R^2 entrenamiento =  0.66 ; R^2 prueba =  0.62&quot;
[1] &quot;lambda =  5 ; Variables restantes: 27 ; R^2 entrenamiento =  0.65 ; R^2 prueba =  0.62&quot;
[1] &quot;lambda =  10 ; Variables restantes: 19 ; R^2 entrenamiento =  0.64 ; R^2 prueba =  0.62&quot;
[1] &quot;lambda =  20 ; Variables restantes: 16 ; R^2 entrenamiento =  0.63 ; R^2 prueba =  0.62&quot;
[1] &quot;lambda =  50 ; Variables restantes: 8 ; R^2 entrenamiento =  0.6 ; R^2 prueba =  0.61&quot;
[1] &quot;lambda =  11.07 ; Variables restantes: 18 ; R^2 entrenamiento =  0.64 ; R^2 prueba =  0.62&quot;</code></pre>
</div>
<p>De lo anterior podemos ver que un modelo lineal puede no ser la mejor de las opciones; además, no corroboramos ninguno de los supuestos de la regresión y con una cantidad tan alta de variables es muy posible que muchas estén altamente correlacionadas:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/taiyun/corrplot'>corrplot</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/corrplot/man/corrplot.html'>corrplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>dr.df</span><span class='op'>)</span>, method <span class='op'>=</span> <span class='st'>"ellipse"</span>, type <span class='op'>=</span> <span class='st'>"upper"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="c16_regs_mv_files/figure-html5/unnamed-chunk-18-1.png" width="624" /></p>
</div>
<p>Podemos también hacer una matriz similar, aunque utilizando gráficos de dispersión:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggobi.github.io/ggally'>GGally</a></span><span class='op'>)</span>
<span class='co'>#pairs &lt;- ggpairs(dr.df, progress = F)</span>
<span class='va'>pairs</span>
</code></pre>
</div>
<pre><code>function (x, ...) 
UseMethod(&quot;pairs&quot;)
&lt;bytecode: 0x7fa355886c40&gt;
&lt;environment: namespace:graphics&gt;</code></pre>
</div>
<p>La visualización de los datos se hace en parte junto con la evaluación de la regresión, en el sentido de que solo podemos ver la relación entre los datos observados y predichos por el modelo</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mlm.data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>obs <span class='op'>=</span> <span class='va'>y_test</span>, s0 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lasso.lm</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>X_test_s</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>mlm.plot</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mlm.data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>obs</span>, y <span class='op'>=</span>  <span class='va'>s0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/rgb.html'>rgb</a></span><span class='op'>(</span><span class='fl'>118</span>,<span class='fl'>78</span>,<span class='fl'>144</span>, maxColorValue <span class='op'>=</span> <span class='fl'>255</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Gráfico de dispersión de datos observados y predichos"</span>,
                 subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"R2e: %.2f | R2p: %.2f"</span>,
                                    <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>lasso.lm</span><span class='op'>$</span><span class='va'>dev.ratio</span>,<span class='fl'>2</span><span class='op'>)</span>, 
                                    <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/caret/man/postResample.html'>R2</a></span><span class='op'>(</span><span class='va'>lasso.pred</span>, <span class='va'>y_test</span><span class='op'>)</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,
                 caption <span class='op'>=</span> <span class='st'>"Datos de prueba"</span>,
                 x <span class='op'>=</span> <span class='st'>""</span>,
                 y <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span>
            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>mlm.plot</span>
</code></pre>
</div>
<p><img src="c16_regs_mv_files/figure-html5/unnamed-chunk-20-1.png" width="624" /></p>
</div>
<h2 id="ingeniería-de-variables">Ingeniería de variables</h2>
<p>Aplicamos un PCA para generar nuevas variables que contengan el efecto de las variables originales y que sean ortogonales:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.sthda.com/english/rpkgs/factoextra'>factoextra</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://factominer.free.fr'>FactoMineR</a></span><span class='op'>)</span>

<span class='va'>X_train_pca</span> <span class='op'>&lt;-</span> <span class='fu'>FactoMineR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/FactoMineR/man/PCA.html'>PCA</a></span><span class='op'>(</span><span class='va'>X_train</span>, graph <span class='op'>=</span> <span class='cn'>F</span>, ncp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>X_train</span><span class='op'>)</span>, scale.unit <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>
<span class='va'>X_pca_train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>X_train_pca</span>, <span class='va'>X_train</span><span class='op'>)</span><span class='op'>$</span><span class='va'>coord</span>
<span class='va'>X_pca_test</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>X_train_pca</span>, <span class='va'>X_test</span><span class='op'>)</span><span class='op'>$</span><span class='va'>coord</span>
</code></pre>
</div>
</div>
<p>Evaluemos las correlaciones de los nuevos predictores con nuestra variable de interés y extraigamos aquellas que tengan correlaciones significativas (≠0):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#library(Hmisc)</span>
<span class='va'>c_mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>X_pca_train</span>, <span class='va'>y_train</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>$</span><span class='va'>y_train</span>
<span class='va'>p_mat</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'>Hmisc</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Hmisc/man/rcorr.html'>rcorr</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>X_pca_train</span>, <span class='va'>y_train</span><span class='op'>)</span><span class='op'>)</span><span class='op'>$</span><span class='va'>P</span><span class='op'>)</span><span class='op'>$</span><span class='va'>y_train</span>
<span class='va'>p_mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>y_train <span class='op'>=</span> <span class='va'>p_mat</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>p_mat</span><span class='op'>)</span> <span class='op'>==</span> <span class='cn'>F</span><span class='op'>]</span>, CP <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>X_pca_train</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sig_cps</span> <span class='op'>&lt;-</span> <span class='va'>p_mat</span><span class='op'>$</span><span class='va'>CP</span><span class='op'>[</span><span class='va'>p_mat</span><span class='op'>$</span><span class='va'>y_train</span> <span class='op'>&lt;=</span> <span class='fl'>0.05</span><span class='op'>]</span>
<span class='va'>sig_cps</span>
</code></pre>
</div>
<pre><code> [1] &quot;Dim.1&quot;  &quot;Dim.2&quot;  &quot;Dim.3&quot;  &quot;Dim.4&quot;  &quot;Dim.5&quot;  &quot;Dim.7&quot;  &quot;Dim.9&quot;  &quot;Dim.10&quot;
 [9] &quot;Dim.11&quot; &quot;Dim.12&quot; &quot;Dim.15&quot; &quot;Dim.16&quot; &quot;Dim.17&quot; &quot;Dim.18&quot; &quot;Dim.19&quot; &quot;Dim.20&quot;
[17] &quot;Dim.23&quot; &quot;Dim.25&quot; &quot;Dim.26&quot; &quot;Dim.28&quot; &quot;Dim.30&quot; &quot;Dim.42&quot; &quot;Dim.48&quot; &quot;Dim.49&quot;
[25] &quot;Dim.58&quot; &quot;Dim.62&quot; &quot;Dim.67&quot; &quot;Dim.69&quot; &quot;Dim.87&quot; &quot;Dim.88&quot;</code></pre>
</div>
<p>Filtramos nuestros datos:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>X_filt_train</span> <span class='op'>&lt;-</span> <span class='va'>X_pca_train</span><span class='op'>[</span>,<span class='va'>sig_cps</span><span class='op'>]</span>
<span class='va'>X_filt_test</span> <span class='op'>&lt;-</span> <span class='va'>X_pca_test</span><span class='op'>[</span>,<span class='va'>sig_cps</span><span class='op'>]</span>
<span class='va'>filt_train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>X_filt_train</span>, <span class='va'>y_train</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Realicemos la regresión múltiple:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pca_lm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/train.html'>train</a></span><span class='op'>(</span><span class='va'>y_train</span><span class='op'>~</span><span class='va'>.</span>,
                data <span class='op'>=</span> <span class='va'>filt_train</span>,
                method <span class='op'>=</span> <span class='st'>"lm"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>pca_lm</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = .outcome ~ ., data = dat)

Residuals:
     Min       1Q   Median       3Q      Max 
-1244.48  -206.63   -45.32   146.07  2507.35 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  5.759e+02  1.229e+01  46.861  &lt; 2e-16 ***
Dim.1        3.899e-04  2.951e-05  13.212  &lt; 2e-16 ***
Dim.2       -4.443e-04  8.890e-05  -4.998 6.49e-07 ***
Dim.3        1.760e-03  3.902e-04   4.511 6.97e-06 ***
Dim.4       -5.184e-03  4.973e-04 -10.423  &lt; 2e-16 ***
Dim.5       -2.102e-02  9.046e-04 -23.238  &lt; 2e-16 ***
Dim.7        1.831e-02  1.788e-03  10.240  &lt; 2e-16 ***
Dim.9       -1.458e-02  3.787e-03  -3.851 0.000123 ***
Dim.10       1.343e-02  4.009e-03   3.350 0.000830 ***
Dim.11       5.615e-02  5.890e-03   9.533  &lt; 2e-16 ***
Dim.12      -3.454e-02  7.395e-03  -4.671 3.28e-06 ***
Dim.15       4.943e-01  1.431e-01   3.454 0.000568 ***
Dim.16      -6.797e-01  1.578e-01  -4.308 1.76e-05 ***
Dim.17       3.921e+00  3.579e-01  10.954  &lt; 2e-16 ***
Dim.18       5.392e+00  4.182e-01  12.893  &lt; 2e-16 ***
Dim.19       5.572e+00  5.179e-01  10.758  &lt; 2e-16 ***
Dim.20       4.022e+00  5.436e-01   7.399 2.30e-13 ***
Dim.23      -1.259e+01  7.098e-01 -17.741  &lt; 2e-16 ***
Dim.25      -6.717e+00  8.911e-01  -7.538 8.33e-14 ***
Dim.26       4.611e+00  1.006e+00   4.582 4.99e-06 ***
Dim.28       3.878e+00  1.116e+00   3.476 0.000524 ***
Dim.30      -6.053e+00  1.425e+00  -4.247 2.31e-05 ***
Dim.42       8.990e+00  3.380e+00   2.660 0.007904 ** 
Dim.48       1.630e+01  4.114e+00   3.962 7.78e-05 ***
Dim.49       2.079e+01  4.495e+00   4.625 4.07e-06 ***
Dim.58      -3.642e+01  7.158e+00  -5.087 4.10e-07 ***
Dim.62      -2.630e+01  8.636e+00  -3.045 0.002368 ** 
Dim.67       6.076e+01  1.139e+01   5.336 1.10e-07 ***
Dim.69      -5.835e+01  1.272e+01  -4.586 4.91e-06 ***
Dim.87      -8.223e+10  8.700e+10  -0.945 0.344729    
Dim.88       2.215e+14  5.611e+13   3.948 8.27e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 376.9 on 1464 degrees of freedom
Multiple R-squared:  0.6355,    Adjusted R-squared:  0.6281 
F-statistic: 85.09 on 30 and 1464 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<p>Los resultados son similares en los datos de entrenamiento, veamos qué pasa con los datos de prueba:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pca_tpreds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>pca_lm</span>, <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>X_filt_test</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/caret/man/postResample.html'>R2</a></span><span class='op'>(</span><span class='va'>pca_tpreds</span>, <span class='va'>y_test</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.6</code></pre>
</div>
<p>Los resultados también son similares a aquellos de la regresión Lasso. La conclusión que podemos generar es que un modelo lineal como este puede no ser la mejor opción para estos datos. ¿Cómo más podríamos mejorarlo?</p>
<h2 id="ejercicio-1">Ejercicio 1</h2>
<ol type="1">
<li>Realiza una regresión Lasso con los CPs. ¿Cuántas variables se mantienen?¿Cambia el desempeño de los modelos?</li>
<li>Realiza los diagnósticos de las regresiones Ridge, Lasso y la regresión con CP. ¿Cuál está mejor ajustada? (Performance)</li>
<li>Aplica un GLM con las variables restantes en la regresión Lasso. ¿Qué familia utilizas para el error? ¿El ajuste mejora o se mantiene igual?</li>
</ol>
<h2 id="ejercicio-2">Ejercicio 2</h2>
<p>El objetivo es predecir la edad de individuos de abulón a partir de mediciones corporales de los mismos utilizando algún modelo lineal. Puedes también utilizar algún modelo no lineal, si es de tu interés.</p>
<p>Los datos para entrenar los modelos se encuentran <a href="https://storage.googleapis.com/download.tensorflow.org/data/abalone_train.csv">aquí</a>. Las columnas corresponden a: - Longitud del organismo, - Diámetro del organismo, - Altura del organismo, - Peso entero, - Peso sin concha, - Peso de las vísceras, - Peso de la cáscara, - Edad (años)</p>
<p>Los puntos a tener en cuenta son:</p>
<ol type="1">
<li>Identificar si es necesario hacer algún procesamiento a los datos y, de ser así, aplicarlo.</li>
<li>¿Es necesario, prudente y válido incluir todas las variables en el modelo?</li>
<li>A partir del punto anterior, construir el/los modelos de regresión. ¿Es necesario utilizar un modelo penalizado/regularizado?</li>
<li>Evaluar si los modelos están sobre o sub ajustados.</li>
<li>Analizar los gráficos diagnósticos de la regresión (recuerda que todos son construidos a partir de los residuales y los valores a predecir) y evaluar la bondad de ajuste de los modelos y evaluar su calidad (e.g., ¿Son los residuales normales y homocedásticos?).</li>
<li>Una vez mejorado el modelo lo más posible (i.e., escalando los valores, eliminando variables o generando nuevas (e.g. ACP)), crea un nuevo modelo con TODAS las observaciones.</li>
<li>Predice los valores de edad de los <a href="https://storage.googleapis.com/download.tensorflow.org/data/abalone_test.csv">datos de prueba</a>. ¿Cuál es el valor de MSE y <span class="math inline">\(R^2\)</span> alcanzado por el modelo?</li>
<li>Tomando en cuenta estos resultados, ¿el modelo ajustado final se encuentra bien ajustado, sobreajustado o infraajustado?</li>
</ol>
<h2 id="datos">Datos:</h2>
<p>El código de las siguientes celdas permite descargar los datos directamente a R desde una URL:</p>
<h3 id="entrenamiento">Entrenamiento</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>train_d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"https://storage.googleapis.com/"</span>,
                  <span class='st'>"download.tensorflow.org/data/abalone_train.csv"</span><span class='op'>)</span>
<span class='va'>download</span> <span class='op'>&lt;-</span> <span class='fu'>RCurl</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RCurl/man/getURL.html'>getURL</a></span><span class='op'>(</span><span class='va'>train_d</span><span class='op'>)</span>
<span class='va'>train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='va'>download</span>, header <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>train</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Long"</span>, <span class='st'>"Diam"</span>, <span class='st'>"Alt"</span>, <span class='st'>"PesoEnt"</span>,
                     <span class='st'>"PesoDesc"</span>, <span class='st'>"PesoVisc"</span>, <span class='st'>"PesoCasc"</span>, <span class='st'>"Edad"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>train</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Long"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Diam"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Alt"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["PesoEnt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["PesoDesc"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["PesoVisc"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["PesoCasc"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Edad"],"name":[8],"type":["int"],"align":["right"]}],"data":[{"1":"0.435","2":"0.335","3":"0.110","4":"0.334","5":"0.1355","6":"0.0775","7":"0.0965","8":"7","_rn_":"1"},{"1":"0.585","2":"0.450","3":"0.125","4":"0.874","5":"0.3545","6":"0.2075","7":"0.2250","8":"6","_rn_":"2"},{"1":"0.655","2":"0.510","3":"0.160","4":"1.092","5":"0.3960","6":"0.2825","7":"0.3700","8":"14","_rn_":"3"},{"1":"0.545","2":"0.425","3":"0.125","4":"0.768","5":"0.2940","6":"0.1495","7":"0.2600","8":"16","_rn_":"4"},{"1":"0.545","2":"0.420","3":"0.130","4":"0.879","5":"0.3740","6":"0.1695","7":"0.2300","8":"13","_rn_":"5"},{"1":"0.570","2":"0.450","3":"0.145","4":"0.751","5":"0.2825","6":"0.2195","7":"0.2215","8":"10","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<h3 id="prueba">Prueba</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>test_d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"https://storage.googleapis.com/"</span>,
                 <span class='st'>"download.tensorflow.org/data/abalone_test.csv"</span><span class='op'>)</span>
<span class='va'>download</span> <span class='op'>&lt;-</span> <span class='fu'>RCurl</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RCurl/man/getURL.html'>getURL</a></span><span class='op'>(</span><span class='va'>test_d</span><span class='op'>)</span>
<span class='va'>test</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='va'>download</span>, header <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>test</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Long"</span>, <span class='st'>"Diam"</span>, <span class='st'>"Alt"</span>, <span class='st'>"PesoEnt"</span>, <span class='st'>"PesoDesc"</span>,
                    <span class='st'>"PesoVisc"</span>, <span class='st'>"PesoCasc"</span>, <span class='st'>"Edad"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>test</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Long"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Diam"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Alt"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["PesoEnt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["PesoDesc"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["PesoVisc"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["PesoCasc"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Edad"],"name":[8],"type":["int"],"align":["right"]}],"data":[{"1":"0.570","2":"0.465","3":"0.180","4":"1.2950","5":"0.3390","6":"0.2225","7":"0.440","8":"12","_rn_":"1"},{"1":"0.660","2":"0.530","3":"0.185","4":"1.3485","5":"0.4930","6":"0.2450","7":"0.490","8":"12","_rn_":"2"},{"1":"0.440","2":"0.345","3":"0.120","4":"0.3650","5":"0.1655","6":"0.0830","7":"0.110","8":"7","_rn_":"3"},{"1":"0.620","2":"0.475","3":"0.160","4":"1.1295","5":"0.4630","6":"0.2685","7":"0.330","8":"10","_rn_":"4"},{"1":"0.505","2":"0.410","3":"0.135","4":"0.6570","5":"0.2910","6":"0.1330","7":"0.195","8":"15","_rn_":"5"},{"1":"0.625","2":"0.515","3":"0.155","4":"1.1635","5":"0.4875","6":"0.2590","7":"0.355","8":"11","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p>© Copyright 2021 <a href="https://www.drplancton.com">Dr. Plancton</a>.</p>
<p>Software licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, v2.0</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
