<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="M. en C. Arturo Bell Enríquez García" />


<title>Hipótesis Múltiples y Multivariadas</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Bioestadística con R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Temas
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Biología como Ciencia de Datos</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="c1_Intro_R.html">Introducción a R</a>
        </li>
        <li>
          <a href="c2_ggplot2.html">ggplot2</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Herramientas Básicas</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="c3_probabilidad.html">Probabilidad</a>
        </li>
        <li>
          <a href="c4_muestreo.html">Teoría del Muestreo</a>
        </li>
        <li>
          <a href="c5_descriptiva.html">Estadística Descriptiva</a>
        </li>
        <li>
          <a href="c6_ph0.html">Pruebas de hipótesis</a>
        </li>
        <li>
          <a href="c7_param.html">Técnicas Paramétricas</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Relaciones Lineales</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="c8_rls.html">Modelo Lineal Simple</a>
        </li>
        <li>
          <a href="c9_glm.html">Modelos Lineales Generalizados</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">No Paramétrico y No Lineal</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="c10_no_par.html">Técnicas No Paramétricas</a>
        </li>
        <li>
          <a href="c11_no_lineal.html">Modelos No Lineales</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Técnicas Multivariadas</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="c11_intro_mv.html">Introducción</a>
        </li>
        <li>
          <a href="c12_no_sup.html">No supervisadas</a>
        </li>
        <li>
          <a href="c13_comps_mv.html">Comparaciones Multivariadas</a>
        </li>
        <li>
          <a href="c14_clasificacion.html">Clasificaciones</a>
        </li>
        <li>
          <a href="c15_regs_mv.html">Regresiones Múltiples</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Hipótesis Múltiples y Multivariadas</h1>
<h4 class="author">M. en C. Arturo Bell Enríquez García</h4>

</div>


<p><strong><a href="https://youtu.be/qAIYfF1rxfo">VIDEO</a></strong></p>
<div id="funciones-personalizadas" class="section level2">
<h2>Funciones personalizadas</h2>
<pre class="r"><code># Tema personalizado
blank_theme &lt;- function(aspect.ratio = 1/1.61){
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(),
        panel.background = element_blank(),
        axis.line = element_blank(),
        aspect.ratio = aspect.ratio,
        axis.ticks = element_blank(),
        text = element_text(colour = &quot;gray50&quot;), # Eliminar
        legend.position = &quot;none&quot;
        )
}</code></pre>
</div>
<div id="múltiples-hipótesis-fwer" class="section level1">
<h1>Múltiples hipótesis: FWER</h1>
<div id="corrección-de-bonferroni" class="section level2">
<h2>Corrección de Bonferroni</h2>
<p>La probabilidad de encontrarnos con al menos un error de tipo 1 al realizar múltiples comparaciones independientes incrementa a una tasa de <span class="math inline">\(1-(1-\alpha)^m\)</span>, donde m es el número de comparaciones. Grafiquemos este cambio:</p>
<pre class="r"><code>library(ggplot2)

error &lt;- data.frame(m = 1:20)
error[&quot;P_alpha&quot;] &lt;- 1 - (1-0.05)^error$m

error.rate &lt;- ggplot(data = error, aes(m, P_alpha)) + 
              geom_line(color = rgb(118,78,144, maxColorValue = 255)) +
              scale_y_continuous(breaks = NULL) +
              scale_x_continuous(breaks = c(1, 2, 5, 10, 20)) +
              expand_limits(y = c(0,1)) +
              blank_theme() +
              geom_hline(yintercept = 0.05, colour = &quot;deepskyblue4&quot;, linetype = &quot;dashed&quot;) +
              geom_hline(yintercept = 0.5, colour = &quot;firebrick&quot;, linetype = &quot;dashed&quot;, alpha = 0.5) +
              geom_hline(yintercept = 1, colour = &quot;firebrick&quot;, linetype = &quot;dashed&quot;, alpha = 0.5) +
              annotate(&quot;text&quot;, x = 0, y = 0.08, label = &quot;0.05&quot;, colour = &quot;deepskyblue4&quot;, alpha = 0.5) + 
              annotate(&quot;text&quot;, x = 0, y = 0.53, label = &quot;0.5&quot;, colour = &quot;firebrick&quot;, alpha = 0.5) +
              annotate(&quot;text&quot;, x = 0, y = 0.97, label = &quot;1&quot;, colour = &quot;firebrick&quot;, alpha = 0.5) +
              labs(title = &quot;P(error) al incrementar el número de pruebas (m)&quot;,
                   subtitle = bquote({1 - (1- alpha)^m}),
                   x = element_blank(),
                   y = element_blank(),
                   caption = &quot;King &amp; Eckersley (2019)&quot;
                   )

error.rate</code></pre>
<p><img src="c14_comps_mv_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Ahora apliquemos la corrección de Bonferroni, dada por <span class="math inline">\(\alpha/m\)</span>, de modo que la ecuación anterior queda formulada como: <span class="math inline">\(1-(1-\alpha/m)^m\)</span></p>
<pre class="r"><code>error[&quot;P_bonf&quot;] &lt;- 1 - (1-(0.05/error$m))^error$m

error.corr &lt;- ggplot(data = error, aes(m, P_bonf)) + 
              geom_line(color = rgb(118,78,144, maxColorValue = 255)) +
              scale_y_continuous(breaks = NULL) +
              scale_x_continuous(breaks = c(1, 2, 5, 10, 20)) +
              expand_limits(y = c(0.04, 0.06)) +
              blank_theme() +
              geom_hline(yintercept = 0.05, colour = &quot;deepskyblue4&quot;, linetype = &quot;dashed&quot;) +
              geom_hline(yintercept = 0.04, colour = &quot;lightslategray&quot;, linetype = &quot;dashed&quot;, alpha = 0.5) +
              geom_hline(yintercept = 0.06, colour = &quot;lightslategray&quot;, linetype = &quot;dashed&quot;, alpha = 0.5) +
              annotate(&quot;text&quot;, x = 0, y = 0.0505, label = &quot;0.05&quot;, colour = &quot;deepskyblue4&quot;, alpha = 0.5) + 
              annotate(&quot;text&quot;, x = 0, y = 0.0405, label = &quot;0.04&quot;, colour = &quot;lightslategray&quot;, alpha = 0.5) +
              annotate(&quot;text&quot;, x = 0, y = 0.0595, label = &quot;0.06&quot;, colour = &quot;lightslategray&quot;, alpha = 0.5) +
              labs(title = &quot;P(error) al corregir según el número de pruebas (m)&quot;,
                   subtitle = bquote({1 - (1- (alpha/m))^m}),
                   x = element_blank(),
                   y = element_blank(),
                   caption = &quot;King &amp; Eckersley (2019)&quot;
                   )

error.corr</code></pre>
<p><img src="c14_comps_mv_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>set.seed(45)
n &lt;- 1000
robs &lt;- data.frame(z = rnorm(n))
robs[&quot;color&quot;] &lt;- ifelse(robs$z &lt; -1.96 | robs$z &gt; 1.96, &quot;firebrick&quot;, &quot;deepskyblue4&quot;)

robs.plot &lt;- ggplot(data = robs, aes(z)) + 
             geom_density(color = &quot;deepskyblue4&quot;) + 
             blank_theme() + 
             labs(title = &quot;Observaciones aleatorias a un nivel de significancia de 0.05&quot;,
                  subtitle = &quot;Bandas indican límites del LS   &quot;,
                  caption = paste(n, &quot; datos simulados&quot;),
                  x = &quot;Z&quot;,
                  y = element_blank()
                  ) +
             geom_vline(xintercept = -1.96, 
                        colour = rgb(118,78,144, maxColorValue = 255), 
                        linetype = &quot;dashed&quot;
                        ) +
             geom_vline(xintercept = 1.96, 
                        colour = rgb(118,78,144, maxColorValue = 255), 
                        linetype = &quot;dashed&quot;
                        ) +
             geom_point(aes(x = z, y = 0), 
                        color = robs$color, alpha = 0.3) +
             scale_y_continuous(breaks = NULL) +
             scale_x_continuous(breaks = c(-3, -1.96, -1, 0, 1, 1.96, 3), 
                                labels = as.character(c(-3, -1.96, -1, 0, 1, 1.96, 3))
                                ) +
             annotate(&quot;text&quot;, x = 3, y = 0.5, 
                      label = paste(&quot;# sign = &quot;, 
                                    length(robs$color[robs$color == &quot;firebrick&quot;]), &quot;/&quot;, n),
                      colour = &quot;firebrick&quot;
                      )

robs.plot</code></pre>
<p><img src="c14_comps_mv_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>set.seed(45)
n &lt;- 1000
a.corr &lt;- (0.05/n)/2
sig.lev &lt;- abs(qnorm(a.corr))
robs &lt;- data.frame(z = rnorm(n))
robs[&quot;color&quot;] &lt;- ifelse(robs$z &lt; -sig.lev | robs$z &gt; sig.lev, &quot;firebrick&quot;, &quot;deepskyblue4&quot;)

rcor.plot &lt;- ggplot(data = robs, aes(z)) + 
             geom_density(color = &quot;deepskyblue4&quot;) + 
             blank_theme() + 
             labs(title = &quot;Observaciones aleatorias a un nivel de significancia de 0.05&quot;,
                  subtitle = &quot;Bandas indican límites del LS corregido&quot;,
                  caption = paste(n, &quot; datos simulados&quot;),
                  x = &quot;Z&quot;,
                  y = element_blank()
                  ) +
             geom_vline(xintercept = -sig.lev, 
                        colour = rgb(118,78,144, maxColorValue = 255), 
                        linetype = &quot;dashed&quot;
                        ) +
             geom_vline(xintercept = sig.lev, 
                        colour = rgb(118,78,144, maxColorValue = 255), 
                        linetype = &quot;dashed&quot;
                        ) +
             geom_point(aes(x = z, y = 0), 
                        color = robs$color, alpha = 0.3) +
             scale_y_continuous(breaks = NULL) +
             scale_x_continuous(breaks = c(-3, -1.96, -1, 0, 1, 1.96, 3), 
                                labels = as.character(c(-3, -1.96, -1, 0, 1, 1.96, 3))
                                ) +
             annotate(&quot;text&quot;, x = 2.5, y = 0.5, 
                      label = paste(&quot;# sign = &quot;, 
                                    length(robs$color[robs$color == &quot;firebrick&quot;]), &quot;/&quot;, n),
                      colour = &quot;firebrick&quot;
                      )

rcor.plot</code></pre>
<p><img src="c14_comps_mv_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="anova-sheirer-ray-hare" class="section level2">
<h2>ANOVA Sheirer-Ray-Hare</h2>
<p>Carguemos los datos</p>
<pre class="r"><code>mili &lt;- read.csv(&quot;data/milipedos.csv&quot;)
colnames(mili) &lt;- c(&quot;Especie&quot;, &quot;Sexo&quot;, &quot;Ala&quot;)
str(mili)</code></pre>
<pre><code>## &#39;data.frame&#39;:    24 obs. of  3 variables:
##  $ Especie: chr  &quot;Especie1&quot; &quot;Especie1&quot; &quot;Especie1&quot; &quot;Especie1&quot; ...
##  $ Sexo   : chr  &quot;Machos&quot; &quot;Machos&quot; &quot;Machos&quot; &quot;Machos&quot; ...
##  $ Ala    : num  21.5 19.6 20.9 22.8 14.8 15.6 13.5 16.4 14.5 17.4 ...</code></pre>
<p>Realicemos la prueba de normalidad para cada nivel de cada variable:</p>
<pre class="r"><code>norm.mili &lt;- data.frame(grupo = NA, n = NA, W = NA, p = NA)
cols &lt;- colnames(mili)[1:2]
especies &lt;- as.character(unique(mili$Especie))
sexos &lt;- as.character(unique(mili$Sexo))

for (i in seq_along(cols)) {# Cicla entre las columnas indicadas
  if (i == 1) { # Si es la primera columna:
    for (j in seq_along(especies)) { # Cicla entre los valores de la columa Especies
      shap &lt;- shapiro.test(mili$Ala[mili[cols[i]] == especies[j]])
      norm.mili[j,] &lt;- c(especies[j], 
                         length(mili$Ala[mili[cols[i]] == especies[j]]), 
                         round(shap$statistic, 2), 
                         round(shap$p.value, 2)
                         )
    }
  }
  if (i == 2) { # Si es la segunda columna
    for (k in 1:length(sexos)) { # Cicla entre los valores de la columna Sexo
      shap &lt;- shapiro.test(mili$Ala[mili[cols[i]] == sexos[k]])
      norm.mili[j+k,] &lt;- c(sexos[k], # Sexo de la iteración
                           length(mili$Ala[mili[cols[i]] == sexos[k]]), # Tamaño de muestra para esa iteración
                           round(shap$statistic, 2), # 
                           round(shap$p.value, 2)
                           )
    }
  }
}

norm.mili</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["grupo"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["chr"],"align":["left"]},{"label":["W"],"name":[3],"type":["chr"],"align":["left"]},{"label":["p"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"Especie1","2":"8","3":"0.92","4":"0.46","_rn_":"1"},{"1":"Especie2","2":"8","3":"0.93","4":"0.51","_rn_":"2"},{"1":"Especie3","2":"8","3":"0.94","4":"0.63","_rn_":"3"},{"1":"Machos","2":"12","3":"0.97","4":"0.94","_rn_":"4"},{"1":"Hembras","2":"12","3":"0.97","4":"0.86","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Comprobemos la homocedasticidad:</p>
<pre class="r"><code># Dado que los datos se ajustaron a una distribución normal podemos utilizar la prueba de Bartlett
bartlett.test(Ala~Sexo, data = mili)</code></pre>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  Ala by Sexo
## Bartlett&#39;s K-squared = 2.8086, df = 1, p-value = 0.09376</code></pre>
<pre class="r"><code>bartlett.test(Ala~Especie, data = mili)</code></pre>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  Ala by Especie
## Bartlett&#39;s K-squared = 1.0294, df = 2, p-value = 0.5977</code></pre>
<pre class="r"><code># Verificamos con la prueba de Levene
library(car)</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DescTools&#39;:
## 
##     Recode</code></pre>
<pre class="r"><code>leveneTest(Ala~Sexo, data = mili)</code></pre>
<pre><code>## Warning in leveneTest.default(y = y, group = group, ...): group coerced to
## factor.</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["F value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"3.187539","3":"0.08799658","_rn_":"group"},{"1":"22","2":"NA","3":"NA","_rn_":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>leveneTest(Ala~Especie, data = mili)</code></pre>
<pre><code>## Warning in leveneTest.default(y = y, group = group, ...): group coerced to
## factor.</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["F value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"1.681912","3":"0.2101238","_rn_":"group"},{"1":"21","2":"NA","3":"NA","_rn_":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Realicemos la prueba Scheirer-Ray-Hare:</p>
<pre class="r"><code>library(rcompanion)
library(FSA)</code></pre>
<pre><code>## ## FSA v0.8.31. See citation(&#39;FSA&#39;) if used in publication.
## ## Run fishR() for related website and fishR(&#39;IFAR&#39;) for related book.</code></pre>
<pre><code>## 
## Attaching package: &#39;FSA&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:car&#39;:
## 
##     bootCase</code></pre>
<pre class="r"><code>scheirerRayHare(Ala ~ Especie + Sexo, data = mili)</code></pre>
<pre><code>## 
## DV:  Ala 
## Observations:  24 
## D:  0.9995652 
## MS total:  50</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["H"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"249.750","3":"4.9971727","4":"0.0822011208","_rn_":"Especie"},{"1":"1","2":"693.375","3":"13.8735320","4":"0.0001955329","_rn_":"Sexo"},{"1":"2","2":"7.000","3":"0.1400609","4":"0.9323654308","_rn_":"Especie:Sexo"},{"1":"18","2":"199.375","3":"NA","4":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>dunnTest(Ala~Especie, data = mili, method = &quot;bonferroni&quot;)</code></pre>
<pre><code>## Warning: Especie was coerced to a factor.</code></pre>
<pre><code>## Dunn (1964) Kruskal-Wallis multiple comparison</code></pre>
<pre><code>##   p-values adjusted with the Bonferroni method.</code></pre>
<pre><code>##            Comparison          Z    P.unadj      P.adj
## 1 Especie1 - Especie2  2.2278707 0.02588914 0.07766741
## 2 Especie1 - Especie3  1.2730690 0.20299356 0.60898068
## 3 Especie2 - Especie3 -0.9548017 0.33967797 1.00000000</code></pre>
<p>Bajo este criterio, las diferencias parecieran no ser significativas. Apliquemos entonces el ANOVA de dos vías paramétrico y veamos qué encontramos:</p>
<pre class="r"><code>res.mili &lt;- aov(Ala~Especie * Sexo, data = mili)
summary(res.mili)</code></pre>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Especie       2  55.26   27.63  13.082  0.00031 ***
## Sexo          1 138.72  138.72  65.679 2.04e-07 ***
## Especie:Sexo  2   6.89    3.45   1.631  0.22331    
## Residuals    18  38.02    2.11                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>¡SORPRESA! Ahora encontramos diferencias en ambos niveles, aunque no se encontró una interacción entre los factores. Realicemos la prueba HSD de Tukey para analizar las diferencias a cada nivel.</p>
<pre class="r"><code>TukeyHSD(res.mili)$Especie</code></pre>
<pre><code>##                      diff        lwr        upr        p adj
## Especie2-Especie1 -3.7125 -5.5670304 -1.8579696 0.0002068047
## Especie3-Especie1 -2.0125 -3.8670304 -0.1579696 0.0322559559
## Especie3-Especie2  1.7000 -0.1545304  3.5545304 0.0756330927</code></pre>
<p>Veamos ahora estos resultados de manera gráfica utilizando un gráfico de interacción:</p>
<pre class="r"><code>inter.plot &lt;- ggplot(data = mili, aes(x = Sexo, y = Ala, color = Sexo)) + 
              geom_violin() + geom_boxplot(width = 0.1) + 
              facet_wrap(~Especie) + 
              blank_theme(1.61) +
              labs(title = &quot;Gráfico de interacción de la [Ala] (mg/100 ml) en milípedos&quot;,
                   subtitle = &quot;Especie + Sexo&quot;,
                   x = element_blank(),
                   y = element_blank(),
                   caption = &quot;Datos: milipedos.csv&quot;)
inter.plot</code></pre>
<p><img src="c14_comps_mv_files/figure-html/unnamed-chunk-14-1.png" width="672" /> La variable Especie sola</p>
<pre class="r"><code>espec.plot &lt;- ggplot(data = mili, aes(x = Especie, y = Ala, color = Especie)) + 
              geom_violin() + geom_boxplot(width = 0.1) + 
              blank_theme() +
              labs(title = &quot;Gráfico de interacción de la [Ala] (mg/100 ml) en milípedos&quot;,
                   subtitle = &quot;Especie&quot;,
                   x = element_blank(),
                   y = element_blank(),
                   caption = &quot;Datos: milipedos.csv&quot;)
espec.plot</code></pre>
<p><img src="c14_comps_mv_files/figure-html/unnamed-chunk-15-1.png" width="672" /> La variable sexo sola</p>
<pre class="r"><code>sexos.plot &lt;- ggplot(data = mili, aes(x = Sexo, y = Ala, color = Sexo)) + 
              geom_violin() + geom_boxplot(width = 0.1) + 
              blank_theme() +
              labs(title = &quot;Gráfico de interacción de la [Ala] (mg/100 ml) en milípedos&quot;,
                   subtitle = &quot;Especie&quot;,
                   x = element_blank(),
                   y = element_blank(),
                   caption = &quot;Datos: milipedos.csv&quot;)
sexos.plot</code></pre>
<p><img src="c14_comps_mv_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div id="ejercicio" class="section level3">
<h3>Ejercicio</h3>
<p>Realizar un ANOVA Scheirer-Ray-Hare con la base de datos strawberry (<a href="https://doi.org/10.1094/pd-89-1195">Horst <em>et al.</em> 2005</a>). Una base de datos multivariada con medidas de peso, % de Botrytis, % de otras epecies fúngicas y una evaluación de Phomopsis en las hojas para 4 tratamientos con 3 réplicas cada uno.</p>
<pre class="r"><code>straw &lt;- read.csv(&quot;data/strawberry.csv&quot;)
head(straw)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Tratamiento"],"name":[1],"type":["int"],"align":["right"]},{"label":["Rep"],"name":[2],"type":["int"],"align":["right"]},{"label":["Peso"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Botrytis"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Hongos"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Eval"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"3","2":"1","3":"6.90","4":"4.0956","5":"17.2355","6":"1.0","_rn_":"1"},{"1":"3","2":"2","3":"8.30","4":"5.1348","5":"5.6482","6":"1.0","_rn_":"2"},{"1":"3","2":"3","3":"8.40","4":"6.0698","5":"8.8012","6":"1.5","_rn_":"3"},{"1":"3","2":"4","3":"7.95","4":"2.7174","5":"9.5109","6":"1.5","_rn_":"4"},{"1":"6","2":"1","3":"8.60","4":"1.1945","5":"17.0649","6":"1.0","_rn_":"5"},{"1":"6","2":"2","3":"8.50","4":"0.5533","5":"12.8631","6":"1.0","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>str(straw)</code></pre>
<pre><code>## &#39;data.frame&#39;:    16 obs. of  6 variables:
##  $ Tratamiento: int  3 3 3 3 6 6 6 6 8 8 ...
##  $ Rep        : int  1 2 3 4 1 2 3 4 1 2 ...
##  $ Peso       : num  6.9 8.3 8.4 7.95 8.6 8.5 8.2 9.5 6.2 9 ...
##  $ Botrytis   : num  4.1 5.13 6.07 2.72 1.19 ...
##  $ Hongos     : num  17.24 5.65 8.8 9.51 17.06 ...
##  $ Eval       : num  1 1 1.5 1.5 1 1 0.5 1 1 3 ...</code></pre>
<pre class="r"><code>summary(straw)</code></pre>
<pre><code>##   Tratamiento        Rep            Peso          Botrytis      
##  Min.   :3.00   Min.   :1.00   Min.   :6.200   Min.   : 0.5533  
##  1st Qu.:5.25   1st Qu.:1.75   1st Qu.:7.275   1st Qu.: 1.1441  
##  Median :7.00   Median :2.50   Median :8.250   Median : 3.4065  
##  Mean   :6.50   Mean   :2.50   Mean   :7.947   Mean   : 5.5122  
##  3rd Qu.:8.25   3rd Qu.:3.25   3rd Qu.:8.525   3rd Qu.: 7.1228  
##  Max.   :9.00   Max.   :4.00   Max.   :9.500   Max.   :18.3824  
##      Hongos            Eval      
##  Min.   : 1.844   Min.   :0.000  
##  1st Qu.: 5.637   1st Qu.:1.000  
##  Median : 9.156   Median :1.000  
##  Mean   : 9.758   Mean   :1.375  
##  3rd Qu.:13.418   3rd Qu.:1.625  
##  Max.   :17.235   Max.   :3.000</code></pre>
<p>Hay un par de elementos con los cuales hay que tener cuidado: 1) las variables tratamiento y réplica son variables categóricas y fueron detectadas como variables de enteros, 2) la variable Eval está en escala <em>ordinal</em> no en escala de intervalo o de razón, por lo cual queda automáticamente descartada para pruebas paramétricas. Corrijamos entonces el punto 1:</p>
<pre class="r"><code>straw$Tratamiento &lt;- factor(LETTERS[straw$Tratamiento])
straw$Rep &lt;- factor(letters[straw$Rep])
head(straw)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Tratamiento"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Rep"],"name":[2],"type":["fct"],"align":["left"]},{"label":["Peso"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Botrytis"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Hongos"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Eval"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"C","2":"a","3":"6.90","4":"4.0956","5":"17.2355","6":"1.0","_rn_":"1"},{"1":"C","2":"b","3":"8.30","4":"5.1348","5":"5.6482","6":"1.0","_rn_":"2"},{"1":"C","2":"c","3":"8.40","4":"6.0698","5":"8.8012","6":"1.5","_rn_":"3"},{"1":"C","2":"d","3":"7.95","4":"2.7174","5":"9.5109","6":"1.5","_rn_":"4"},{"1":"F","2":"a","3":"8.60","4":"1.1945","5":"17.0649","6":"1.0","_rn_":"5"},{"1":"F","2":"b","3":"8.50","4":"0.5533","5":"12.8631","6":"1.0","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="comparaciones-multivariadas" class="section level1">
<h1>Comparaciones Multivariadas</h1>
<div id="datos-para-comparaciones-mv" class="section level2">
<h2>Datos para comparaciones Mv</h2>
<ol style="list-style-type: decimal">
<li>Base de datos iris. Medidas de 4 variables cuantitativas para 50 flores de cada especie de <em>Iris</em>: <em>setosa</em>, <em>versicolor</em> y <em>virginica</em>. Al explorarla vemos que todo está en orden, las cuatro variables cuantitativas fueron detectadas como tal y la única variable categórica fue asignada correctamente</li>
</ol>
<pre class="r"><code>head(iris)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sepal.Length"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sepal.Width"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Petal.Length"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Petal.Width"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Species"],"name":[5],"type":["fct"],"align":["left"]}],"data":[{"1":"5.1","2":"3.5","3":"1.4","4":"0.2","5":"setosa","_rn_":"1"},{"1":"4.9","2":"3.0","3":"1.4","4":"0.2","5":"setosa","_rn_":"2"},{"1":"4.7","2":"3.2","3":"1.3","4":"0.2","5":"setosa","_rn_":"3"},{"1":"4.6","2":"3.1","3":"1.5","4":"0.2","5":"setosa","_rn_":"4"},{"1":"5.0","2":"3.6","3":"1.4","4":"0.2","5":"setosa","_rn_":"5"},{"1":"5.4","2":"3.9","3":"1.7","4":"0.4","5":"setosa","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>str(iris)</code></pre>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  5 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<pre class="r"><code>summary(iris)</code></pre>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## </code></pre>
</div>
<div id="prueba-t2-de-hotelling" class="section level2">
<h2>Prueba <span class="math inline">\(T^2\)</span> de Hotelling</h2>
<p>Es una extensión multivariada de la prueba T de Student; por lo tanto, es una prueba paramétrica. Comparemos si las especies <em>versicolor</em> y <em>virginica</em> son iguales. Para ello es importante revisar los supuestos del análisis:</p>
<div id="normalidad" class="section level3">
<h3>Normalidad</h3>
<pre class="r"><code>library(MVN)
mvn(iris, subset = &quot;Species&quot;, mvnTest = &quot;mardia&quot;, desc = F)$multivariateNormality</code></pre>
<pre><code>## $setosa
##              Test        Statistic           p value Result
## 1 Mardia Skewness 25.6643445196298 0.177185884467652    YES
## 2 Mardia Kurtosis 1.29499223711605 0.195322907441935    YES
## 3             MVN             &lt;NA&gt;              &lt;NA&gt;    YES
## 
## $versicolor
##              Test         Statistic           p value Result
## 1 Mardia Skewness  25.1850115362466 0.194444483140265    YES
## 2 Mardia Kurtosis -0.57186635893429 0.567412516528727    YES
## 3             MVN              &lt;NA&gt;              &lt;NA&gt;    YES
## 
## $virginica
##              Test         Statistic           p value Result
## 1 Mardia Skewness  26.2705981752915 0.157059707690356    YES
## 2 Mardia Kurtosis 0.152614173978342 0.878702546726567    YES
## 3             MVN              &lt;NA&gt;              &lt;NA&gt;    YES</code></pre>
<pre class="r"><code>mvn(iris, subset = &quot;Species&quot;, mvnTest = &quot;hz&quot;, desc = F)$multivariateNormality</code></pre>
<pre><code>## $setosa
##            Test        HZ    p value MVN
## 1 Henze-Zirkler 0.9488453 0.04995356  NO
## 
## $versicolor
##            Test        HZ   p value MVN
## 1 Henze-Zirkler 0.8388009 0.2261991 YES
## 
## $virginica
##            Test        HZ   p value MVN
## 1 Henze-Zirkler 0.7570095 0.4970237 YES</code></pre>
<pre class="r"><code>mvn(iris, subset = &quot;Species&quot;, mvnTest = &quot;royston&quot;, desc = F)$multivariateNormality</code></pre>
<pre><code>## $setosa
##      Test        H      p value MVN
## 1 Royston 31.51803 2.187653e-06  NO
## 
## $versicolor
##      Test       H   p value MVN
## 1 Royston 7.85262 0.0847746 YES
## 
## $virginica
##      Test        H    p value MVN
## 1 Royston 8.141444 0.06776605 YES</code></pre>
</div>
<div id="igualdad-de-dispersión-multivariada" class="section level3">
<h3>Igualdad de dispersión multivariada</h3>
<p>Al aplicar la prueba global vemos que al parecer no hay diferencias importantes en las dispersiones multivariadas</p>
<pre class="r"><code>library(vegan)
dist.mat &lt;- vegdist(iris[,1:4], method = &quot;euclidean&quot;, type = c(&quot;median&quot;))
groups &lt;- as.character(iris$Species)
disp.mv &lt;- betadisper(dist.mat, group = groups, type = &quot;median&quot;) # Realizar el procedimiento
disp.mv</code></pre>
<pre><code>## 
##  Homogeneity of multivariate dispersions
## 
## Call: betadisper(d = dist.mat, group = groups, type = &quot;median&quot;)
## 
## No. of Positive Eigenvalues: 4
## No. of Negative Eigenvalues: 0
## 
## Average distance to median:
##     setosa versicolor  virginica 
##     0.4814     0.7057     0.8161 
## 
## Eigenvalues for PCoA axes:
##   PCoA1   PCoA2   PCoA3   PCoA4 
## 630.008  36.158  11.653   3.551</code></pre>
<pre class="r"><code>anova(disp.mv) # Prueba de hipótesis</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"2.909168","3":"1.4545842","4":"10.74808","5":"4.400062e-05","_rn_":"Groups"},{"1":"147","2":"19.894148","3":"0.1353343","4":"NA","5":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>La prueba post-hoc confirma los resultados</p>
<pre class="r"><code>mod.HSD &lt;- TukeyHSD(disp.mv)
mod.HSD &lt;- data.frame(mod.HSD$group, comp = dimnames(mod.HSD$group)[[1]])
mod.HSD</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["diff"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["lwr"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["upr"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["p.adj"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["comp"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"0.224334","2":"0.05012946","3":"0.3985385","4":"7.630680e-03","5":"versicolor-setosa","_rn_":"versicolor-setosa"},{"1":"0.334722","2":"0.16051751","3":"0.5089266","4":"3.315921e-05","5":"virginica-setosa","_rn_":"virginica-setosa"},{"1":"0.110388","2":"-0.06381649","3":"0.2845926","4":"2.937401e-01","5":"virginica-versicolor","_rn_":"virginica-versicolor"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="comparación-multivariada" class="section level3">
<h3>Comparación Multivariada:</h3>
<p>Extraemos dos grupos a comparar</p>
<pre class="r"><code>versicolor &lt;- subset(iris, (Species == &quot;versicolor&quot;))[,1:4]
virginica &lt;- subset(iris, (Species == &quot;virginica&quot;))[,1:4]

versi.virg &lt;- subset(iris, (Species == &quot;versicolor&quot;) | (Species == &quot;virginica&quot;))</code></pre>
<p>Aplicamos la prueba:</p>
<pre class="r"><code>library(Hotelling)</code></pre>
<pre><code>## Loading required package: corpcor</code></pre>
<pre class="r"><code>hot.t2 &lt;- hotelling.test(x = virginica, y = versicolor)
hot.t2</code></pre>
<pre><code>## Test stat:  86.148 
## Numerator df:  4 
## Denominator df:  95 
## P-value:  0</code></pre>
<p>Al parecer, los promedios de las mediciones multivariadas son diferentes.</p>
</div>
<div id="comparaciones-univariadas" class="section level3">
<h3>Comparaciones univariadas</h3>
<p>Realizaremos 4 comparaciones univariadas ¿tiene sentido aplicar una corrección de Bonferroni? Algo a notar es que la prueba aplicada en este caso es la prueba de Welch; es decir, una prueba bajo el supuesto de desigualdad de varianzas (muestras heterocedásticas). Para aplicar la prueba T de Student solo hay que agregar el argumento <code>equal.var = TRUE</code> a la función.</p>
<pre class="r"><code>t.test(Sepal.Length~Species, versi.virg)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Sepal.Length by Species
## t = -5.6292, df = 94.025, p-value = 1.866e-07
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.8819731 -0.4220269
## sample estimates:
## mean in group versicolor  mean in group virginica 
##                    5.936                    6.588</code></pre>
<pre class="r"><code>t.test(Sepal.Width~Species, versi.virg)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Sepal.Width by Species
## t = -3.2058, df = 97.927, p-value = 0.001819
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.33028364 -0.07771636
## sample estimates:
## mean in group versicolor  mean in group virginica 
##                    2.770                    2.974</code></pre>
<pre class="r"><code>t.test(Petal.Length~Species, versi.virg)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Petal.Length by Species
## t = -12.604, df = 95.57, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.49549 -1.08851
## sample estimates:
## mean in group versicolor  mean in group virginica 
##                    4.260                    5.552</code></pre>
<pre class="r"><code>t.test(Petal.Width~Species, versi.virg)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Petal.Width by Species
## t = -14.625, df = 89.043, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.7951002 -0.6048998
## sample estimates:
## mean in group versicolor  mean in group virginica 
##                    1.326                    2.026</code></pre>
</div>
</div>
<div id="análisis-multivariado-de-la-varianza" class="section level2">
<h2>Análisis Multivariado de la Varianza</h2>
<p>Extensión Multivariada del Análisis de la Varianza; por lo tanto es el equivalente a una prueba <span class="math inline">\(T^2\)</span> de Hotelling con más de dos grupos (al igual que el ANOVA con respecto a la prueba t de Student)</p>
<p>Ahora apliquemos la prueba utilizando la función <code>Manova()</code> de la librería <code>car</code></p>
<pre class="r"><code>model &lt;- lm(cbind(Sepal.Length,
                  Petal.Length,
                  Sepal.Width,
                  Petal.Width)~Species, data = iris)
Manova(model, test.statistic = &quot;Wilks&quot;)</code></pre>
<pre><code>## 
## Type II MANOVA Tests: Wilks test statistic
##         Df test stat approx F num Df den Df    Pr(&gt;F)    
## Species  2  0.023439   199.15      8    288 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># La forma por defecto de R, con la traza de Pillai
res.man &lt;- manova(cbind(Sepal.Length, Petal.Length, Sepal.Width, Petal.Width)~Species, data = iris)
summary(res.man)</code></pre>
<pre><code>##            Df Pillai approx F num Df den Df    Pr(&gt;F)    
## Species     2 1.1919   53.466      8    290 &lt; 2.2e-16 ***
## Residuals 147                                            
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>summary.aov(res.man)</code></pre>
<pre><code>##  Response Sepal.Length :
##              Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Species       2 63.212  31.606  119.26 &lt; 2.2e-16 ***
## Residuals   147 38.956   0.265                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##  Response Petal.Length :
##              Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Species       2 437.10 218.551  1180.2 &lt; 2.2e-16 ***
## Residuals   147  27.22   0.185                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##  Response Sepal.Width :
##              Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Species       2 11.345  5.6725   49.16 &lt; 2.2e-16 ***
## Residuals   147 16.962  0.1154                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##  Response Petal.Width :
##              Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Species       2 80.413  40.207  960.01 &lt; 2.2e-16 ***
## Residuals   147  6.157   0.042                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>La prueba post-hoc es una prueba HSD de Tukey por cada variable.</p>
<pre class="r"><code>TukeyHSD(aov(Sepal.Width~Species, data = iris))</code></pre>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Sepal.Width ~ Species, data = iris)
## 
## $Species
##                        diff         lwr        upr     p adj
## versicolor-setosa    -0.658 -0.81885528 -0.4971447 0.0000000
## virginica-setosa     -0.454 -0.61485528 -0.2931447 0.0000000
## virginica-versicolor  0.204  0.04314472  0.3648553 0.0087802</code></pre>
<p>Veamos un gráfico de violín para cada variable de cada especie:</p>
<pre class="r"><code>library(gridExtra)

sepall.plot &lt;- ggplot(data = iris, aes(x = Species, y = Sepal.Length, colour = Species)) + 
               geom_violin() + 
               geom_boxplot(width = 0.1) + 
               blank_theme(1/1.61) +
               labs(title = &quot;Sepal length&quot;,
                    x = element_blank(),
                    y = element_blank())
sepalw.plot &lt;- ggplot(data = iris, aes(x = Species, y = Sepal.Width, colour = Species)) + 
               geom_violin() + 
               geom_boxplot(width = 0.1) + 
               blank_theme(1/1.61) +
               labs(title = &quot;Sepal width&quot;,
                    x = element_blank(),
                    y = element_blank())
petall.plot &lt;- ggplot(data = iris, aes(x = Species, y = Petal.Length, colour = Species)) + 
               geom_violin() + 
               geom_boxplot(width = 0.1) + 
               blank_theme(1/1.61)+
               labs(title = &quot;Petal length&quot;,
                    x = element_blank(),
                    y = element_blank())
petalw.plot &lt;- ggplot(data = iris, aes(x = Species, y = Petal.Width, colour = Species)) + 
               geom_violin() + 
               geom_boxplot(width = 0.1) + 
               blank_theme(1/1.61)+
               labs(title = &quot;Sepal width&quot;,
                    x = element_blank(),
                    y = element_blank())

grid.arrange(sepall.plot, sepalw.plot, petall.plot, petalw.plot)</code></pre>
<p><img src="c14_comps_mv_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>O veamos un gráfico de coordenadas paralelas, el cual nos permite analizar las mediciones de cada variable de cada individuo en un mismo gráfico:</p>
<pre class="r"><code>library(GGally)
coord.plot &lt;- ggparcoord(iris, 
                         columns = 1:4, 
                         groupColumn = 5, 
                         showPoints = T, 
                         scale = &quot;std&quot;, 
                         order = &quot;anyClass&quot;, 
                         alphaLines = 0.5) + 
               blank_theme(1/1.61) +
               labs(title = &quot;Gráfico de coordenadas paralelas&quot;,
                    subtitle = &quot;Valores escalados&quot;,
                    y = element_blank(),
                    x = element_blank(),
                    caption = &quot;Datos: Iris&quot;)
coord.plot</code></pre>
<p><img src="c14_comps_mv_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
<div id="análisis-permutacional-multivariado-de-la-varianza" class="section level2">
<h2>Análisis Permutacional Multivariado de la Varianza:</h2>
<p>Los pasos a seguir son básicamente los mismos que los que seguimos para realizar la prueba de homogeneidad de matrices de dispersión. Este supuesto es, debido a la aproximación permutacional, (posiblemente) el supuesto más importante para esta prueba. Es importante notar que existe una corrección para grupos con varianzas no homogéneas.</p>
<pre class="r"><code>set.seed(1)
n &lt;- 100 # Tamaño de muestra

# Valores observados
tr &lt;- rbinom(100, 1, 0.5) # Distribución binomial con p(éxito) = 50%
y &lt;- 1 + tr + rnorm(n, 0, 3) #Valores de respuesta

s &lt;- sample(tr, length(tr), FALSE) # Muestreo aleatorio sin remplazo 
diff(by(y, s, mean)) # Promedio de las diferencias</code></pre>
<pre><code>## [1] 1.283456</code></pre>
<pre class="r"><code># Permutaciones
dist &lt;- data.frame(f = unname(replicate(2000, diff(by(y, sample(tr, length(tr), FALSE), mean)))))</code></pre>
<pre class="r"><code>permut.plot &lt;- ggplot(data = dist, aes(f)) + 
               geom_density(color = &quot;deepskyblue4&quot;, fill = &quot;deepskyblue3&quot;, alpha = 0.5) + 
               geom_vline(xintercept = 1.3, colour = rgb(118,78,144, maxColorValue = 255)) + 
               blank_theme() +
               labs(title = &quot;Resultados de un experimento permutacional&quot;,
                    subtitle = &quot;Distribución de las diferencias entre dos grupos&quot;,
                    caption = &quot;Datos simulados&quot;,
                    x = element_blank(),
                    y = element_blank())
permut.plot</code></pre>
<p><img src="c14_comps_mv_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>Apliquemos entonces la prueba. Para ello lo primero será calcular la matriz de distancias (de no pasar una matriz de distancias a la prueba hará por default la disimilaridad de Bray-Curtis)</p>
<pre class="r"><code>dist.mat &lt;- vegdist(iris[,1:4], method = &quot;euclidean&quot;) # Matriz de distancias
grps &lt;- iris[,5] # Es un data.frame que contiene los distintos niveles de agrupamiento, anidados o no</code></pre>
<p>Ahora podemos aplicar el PERMANOVA. De los resultados podemos observar que la principal división entre especies está dada por la longitud del sépalo, seguida por el ancho. Las cuatro variables explican el 100% del espacio multivariado (<span class="math inline">\(R^2\)</span> de los residuales = 0). “[…] diferencias significativas en la longitud del sépalo (F(1, 143) = 5.1*10^18; p &lt; 0.001)”</p>
<pre class="r"><code>adonis2(dist.mat~iris$Sepal.Length*iris$Sepal.Width+iris$Petal.Length*iris$Petal.Width, 
        data = grps, permutations = 999)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SumOfSqs"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"5.133435e+02","3":"7.533984e-01","4":"5.132260e+18","5":"0.001","_rn_":"iris$Sepal.Length"},{"1":"1","2":"8.433561e+01","3":"1.237735e-01","4":"8.431629e+17","5":"0.001","_rn_":"iris$Sepal.Width"},{"1":"1","2":"7.831115e+01","3":"1.149318e-01","4":"7.829322e+17","5":"0.001","_rn_":"iris$Petal.Length"},{"1":"1","2":"5.380298e+00","3":"7.896287e-03","4":"5.379065e+16","5":"0.001","_rn_":"iris$Petal.Width"},{"1":"1","2":"0.000000e+00","3":"0.000000e+00","4":"0.000000e+00","5":"1.000","_rn_":"iris$Sepal.Length:iris$Sepal.Width"},{"1":"1","2":"0.000000e+00","3":"0.000000e+00","4":"0.000000e+00","5":"1.000","_rn_":"iris$Petal.Length:iris$Petal.Width"},{"1":"143","2":"1.430328e-14","3":"2.099192e-17","4":"NA","5":"NA","_rn_":"Residual"},{"1":"149","2":"6.813706e+02","3":"1.000000e+00","4":"NA","5":"NA","_rn_":"Total"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Veamos la dispersión multivariada</p>
<pre class="r"><code>plot(betadisper(dist.mat, grps), hull = F, ellipse = T)</code></pre>
<p><img src="c14_comps_mv_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>Podemos utilizar también un Escalamiento Multi-Dimensional No Paramétrico. Esta técnica es similar al PCA en el sentido de que proyecta un espacio altamente dimensional a un espacio con menos dimensiones (k), tratando de preservar las distancias entre cada punto. En pocas palabras, es una “hoja” o “lámina” de pocas dimensiones dentro de un espacio altamente dimensional.</p>
<pre class="r"><code>iris.mds &lt;- metaMDS(dist.mat, distance = &quot;euclidean&quot;, k = 2, trace = F)
mds.dims &lt;- data.frame(NMDS1 = iris.mds$points[,1], NMDS2 = iris.mds$points[,2])

mds.plot.data &lt;- cbind(mds.dims, iris)

# Extraemos las correlaciones de cada factor con cada dimensión reducida (flechas)
fit &lt;- envfit(iris.mds, iris)
arrow &lt;- data.frame(fit$vectors$arrows, R = fit$vectors$r, P = fit$vectors$pvals)
arrow[&quot;Variable&quot;] &lt;- rownames(arrow)

arrow.p &lt;-subset(arrow, P &lt;= 0.05)</code></pre>
<p>Posteriormente podemos graficarlo. El “estrés” representa la fidelidad con respecto al espacio original; entre más alto sea, mayores serán las deformaciones (menor fue el éxito de preservar las distancias). En general, valores de estrés menores a 0.1 se consideran aceptables, menores a 0.05 como una buena representación y por encima de 0.3 indican una “ordenación” arbitraria. En nuestro gráfico, el estrés de 0.02 indica que la representación es fidedigna, que la mayor división entre especies se da en el eje x (usualmente) y que las variables más relacionadas con esa separación son la longitud y el ancho del pétalo, lo cual corresponde perfectamente con lo encontrado por el PERMANOVA.</p>
<pre class="r"><code>mds.plot &lt;- ggplot(mds.plot.data, aes(NMDS1, NMDS2)) +
            geom_point(aes(color = Species), alpha = 0.7) +
            stat_ellipse(aes(fill = Species), type = &quot;t&quot;, size = 1, geom = &quot;polygon&quot;, alpha = 0.2) + 
            labs(title = &quot;Escalamiento Multidimensional no métrico (NMDS)&quot;,
                 subtitle = paste(&#39;Estrés =&#39;,round(iris.mds$stress,3)),
                 caption = &quot;Datos: Iris&quot;) +
            blank_theme() + theme(legend.position = &quot;right&quot;) +
            geom_segment(data = arrow.p, 
                         aes(x=0, y=0, xend = NMDS1, yend = NMDS2, lty = Variable), 
                         arrow = arrow(length = unit(.2, &quot;cm&quot;)*arrow.p$R) #Flechas escaladas según su R^2
                         )

mds.plot</code></pre>
<p><img src="c14_comps_mv_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiSGlww7N0ZXNpcyBNw7psdGlwbGVzIHkgTXVsdGl2YXJpYWRhcyIKYXV0aG9yOiAiTS4gZW4gQy4gQXJ0dXJvIEJlbGwgRW5yw61xdWV6IEdhcmPDrWEiCm91dHB1dDoKICAgIGh0bWxfZG9jdW1lbnQ6CiAgICAgIGRmX3ByaW50OiBwYWdlZAogICAgICB0aGVtZTogY29zbW8KICAgICAgdG9jOiBUUlVFCiAgICAgIHRvY19mbG9hdDogVFJVRQogICAgICBjb2RlX2Rvd25sb2FkOiBUUlVFCi0tLQoKKipbVklERU9dKGh0dHBzOi8veW91dHUuYmUvcUFJWWZGMXJ4Zm8pKioKCiMjIEZ1bmNpb25lcyBwZXJzb25hbGl6YWRhcwoKYGBge3J9CgojIFRlbWEgcGVyc29uYWxpemFkbwpibGFua190aGVtZSA8LSBmdW5jdGlvbihhc3BlY3QucmF0aW8gPSAxLzEuNjEpewogIHRoZW1lKHBhbmVsLmdyaWQubWlub3IgPSBlbGVtZW50X2JsYW5rKCksCiAgICAgICAgcGFuZWwuZ3JpZC5tYWpvciA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICBwYW5lbC5iYWNrZ3JvdW5kID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgIGF4aXMubGluZSA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICBhc3BlY3QucmF0aW8gPSBhc3BlY3QucmF0aW8sCiAgICAgICAgYXhpcy50aWNrcyA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICB0ZXh0ID0gZWxlbWVudF90ZXh0KGNvbG91ciA9ICJncmF5NTAiKSwgIyBFbGltaW5hcgogICAgICAgIGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIgogICAgICAgICkKfQoKYGBgCgoKIyBNw7psdGlwbGVzIGhpcMOzdGVzaXM6IEZXRVIKIyMgQ29ycmVjY2nDs24gZGUgQm9uZmVycm9uaQoKTGEgcHJvYmFiaWxpZGFkIGRlIGVuY29udHJhcm5vcyBjb24gYWwgbWVub3MgdW4gZXJyb3IgZGUgdGlwbyAxIGFsIHJlYWxpemFyIG3Dumx0aXBsZXMgY29tcGFyYWNpb25lcyBpbmRlcGVuZGllbnRlcyBpbmNyZW1lbnRhIGEgdW5hIHRhc2EgZGUgJDEtKDEtXGFscGhhKV5tJCwgZG9uZGUgbSBlcyBlbCBuw7ptZXJvIGRlIGNvbXBhcmFjaW9uZXMuIEdyYWZpcXVlbW9zIGVzdGUgY2FtYmlvOgoKCmBgYHtyfQpsaWJyYXJ5KGdncGxvdDIpCgplcnJvciA8LSBkYXRhLmZyYW1lKG0gPSAxOjIwKQplcnJvclsiUF9hbHBoYSJdIDwtIDEgLSAoMS0wLjA1KV5lcnJvciRtCgplcnJvci5yYXRlIDwtIGdncGxvdChkYXRhID0gZXJyb3IsIGFlcyhtLCBQX2FscGhhKSkgKyAKICAgICAgICAgICAgICBnZW9tX2xpbmUoY29sb3IgPSByZ2IoMTE4LDc4LDE0NCwgbWF4Q29sb3JWYWx1ZSA9IDI1NSkpICsKICAgICAgICAgICAgICBzY2FsZV95X2NvbnRpbnVvdXMoYnJlYWtzID0gTlVMTCkgKwogICAgICAgICAgICAgIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSBjKDEsIDIsIDUsIDEwLCAyMCkpICsKICAgICAgICAgICAgICBleHBhbmRfbGltaXRzKHkgPSBjKDAsMSkpICsKICAgICAgICAgICAgICBibGFua190aGVtZSgpICsKICAgICAgICAgICAgICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAwLjA1LCBjb2xvdXIgPSAiZGVlcHNreWJsdWU0IiwgbGluZXR5cGUgPSAiZGFzaGVkIikgKwogICAgICAgICAgICAgIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDAuNSwgY29sb3VyID0gImZpcmVicmljayIsIGxpbmV0eXBlID0gImRhc2hlZCIsIGFscGhhID0gMC41KSArCiAgICAgICAgICAgICAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMSwgY29sb3VyID0gImZpcmVicmljayIsIGxpbmV0eXBlID0gImRhc2hlZCIsIGFscGhhID0gMC41KSArCiAgICAgICAgICAgICAgYW5ub3RhdGUoInRleHQiLCB4ID0gMCwgeSA9IDAuMDgsIGxhYmVsID0gIjAuMDUiLCBjb2xvdXIgPSAiZGVlcHNreWJsdWU0IiwgYWxwaGEgPSAwLjUpICsgCiAgICAgICAgICAgICAgYW5ub3RhdGUoInRleHQiLCB4ID0gMCwgeSA9IDAuNTMsIGxhYmVsID0gIjAuNSIsIGNvbG91ciA9ICJmaXJlYnJpY2siLCBhbHBoYSA9IDAuNSkgKwogICAgICAgICAgICAgIGFubm90YXRlKCJ0ZXh0IiwgeCA9IDAsIHkgPSAwLjk3LCBsYWJlbCA9ICIxIiwgY29sb3VyID0gImZpcmVicmljayIsIGFscGhhID0gMC41KSArCiAgICAgICAgICAgICAgbGFicyh0aXRsZSA9ICJQKGVycm9yKSBhbCBpbmNyZW1lbnRhciBlbCBuw7ptZXJvIGRlIHBydWViYXMgKG0pIiwKICAgICAgICAgICAgICAgICAgIHN1YnRpdGxlID0gYnF1b3RlKHsxIC0gKDEtIGFscGhhKV5tfSksCiAgICAgICAgICAgICAgICAgICB4ID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgICAgICAgICAgICAgeSA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICAgICAgICAgICAgIGNhcHRpb24gPSAiS2luZyAmIEVja2Vyc2xleSAoMjAxOSkiCiAgICAgICAgICAgICAgICAgICApCgplcnJvci5yYXRlCmBgYAoKQWhvcmEgYXBsaXF1ZW1vcyBsYSBjb3JyZWNjacOzbiBkZSBCb25mZXJyb25pLCBkYWRhIHBvciAkXGFscGhhL20kLCBkZSBtb2RvIHF1ZSBsYSBlY3VhY2nDs24gYW50ZXJpb3IgcXVlZGEgZm9ybXVsYWRhIGNvbW86ICQxLSgxLVxhbHBoYS9tKV5tJAoKYGBge3J9CmVycm9yWyJQX2JvbmYiXSA8LSAxIC0gKDEtKDAuMDUvZXJyb3IkbSkpXmVycm9yJG0KCmVycm9yLmNvcnIgPC0gZ2dwbG90KGRhdGEgPSBlcnJvciwgYWVzKG0sIFBfYm9uZikpICsgCiAgICAgICAgICAgICAgZ2VvbV9saW5lKGNvbG9yID0gcmdiKDExOCw3OCwxNDQsIG1heENvbG9yVmFsdWUgPSAyNTUpKSArCiAgICAgICAgICAgICAgc2NhbGVfeV9jb250aW51b3VzKGJyZWFrcyA9IE5VTEwpICsKICAgICAgICAgICAgICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gYygxLCAyLCA1LCAxMCwgMjApKSArCiAgICAgICAgICAgICAgZXhwYW5kX2xpbWl0cyh5ID0gYygwLjA0LCAwLjA2KSkgKwogICAgICAgICAgICAgIGJsYW5rX3RoZW1lKCkgKwogICAgICAgICAgICAgIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDAuMDUsIGNvbG91ciA9ICJkZWVwc2t5Ymx1ZTQiLCBsaW5ldHlwZSA9ICJkYXNoZWQiKSArCiAgICAgICAgICAgICAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMC4wNCwgY29sb3VyID0gImxpZ2h0c2xhdGVncmF5IiwgbGluZXR5cGUgPSAiZGFzaGVkIiwgYWxwaGEgPSAwLjUpICsKICAgICAgICAgICAgICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAwLjA2LCBjb2xvdXIgPSAibGlnaHRzbGF0ZWdyYXkiLCBsaW5ldHlwZSA9ICJkYXNoZWQiLCBhbHBoYSA9IDAuNSkgKwogICAgICAgICAgICAgIGFubm90YXRlKCJ0ZXh0IiwgeCA9IDAsIHkgPSAwLjA1MDUsIGxhYmVsID0gIjAuMDUiLCBjb2xvdXIgPSAiZGVlcHNreWJsdWU0IiwgYWxwaGEgPSAwLjUpICsgCiAgICAgICAgICAgICAgYW5ub3RhdGUoInRleHQiLCB4ID0gMCwgeSA9IDAuMDQwNSwgbGFiZWwgPSAiMC4wNCIsIGNvbG91ciA9ICJsaWdodHNsYXRlZ3JheSIsIGFscGhhID0gMC41KSArCiAgICAgICAgICAgICAgYW5ub3RhdGUoInRleHQiLCB4ID0gMCwgeSA9IDAuMDU5NSwgbGFiZWwgPSAiMC4wNiIsIGNvbG91ciA9ICJsaWdodHNsYXRlZ3JheSIsIGFscGhhID0gMC41KSArCiAgICAgICAgICAgICAgbGFicyh0aXRsZSA9ICJQKGVycm9yKSBhbCBjb3JyZWdpciBzZWfDum4gZWwgbsO6bWVybyBkZSBwcnVlYmFzIChtKSIsCiAgICAgICAgICAgICAgICAgICBzdWJ0aXRsZSA9IGJxdW90ZSh7MSAtICgxLSAoYWxwaGEvbSkpXm19KSwKICAgICAgICAgICAgICAgICAgIHggPSBlbGVtZW50X2JsYW5rKCksCiAgICAgICAgICAgICAgICAgICB5ID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgICAgICAgICAgICAgY2FwdGlvbiA9ICJLaW5nICYgRWNrZXJzbGV5ICgyMDE5KSIKICAgICAgICAgICAgICAgICAgICkKCmVycm9yLmNvcnIKYGBgCgpgYGB7cn0Kc2V0LnNlZWQoNDUpCm4gPC0gMTAwMApyb2JzIDwtIGRhdGEuZnJhbWUoeiA9IHJub3JtKG4pKQpyb2JzWyJjb2xvciJdIDwtIGlmZWxzZShyb2JzJHogPCAtMS45NiB8IHJvYnMkeiA+IDEuOTYsICJmaXJlYnJpY2siLCAiZGVlcHNreWJsdWU0IikKCnJvYnMucGxvdCA8LSBnZ3Bsb3QoZGF0YSA9IHJvYnMsIGFlcyh6KSkgKyAKICAgICAgICAgICAgIGdlb21fZGVuc2l0eShjb2xvciA9ICJkZWVwc2t5Ymx1ZTQiKSArIAogICAgICAgICAgICAgYmxhbmtfdGhlbWUoKSArIAogICAgICAgICAgICAgbGFicyh0aXRsZSA9ICJPYnNlcnZhY2lvbmVzIGFsZWF0b3JpYXMgYSB1biBuaXZlbCBkZSBzaWduaWZpY2FuY2lhIGRlIDAuMDUiLAogICAgICAgICAgICAgICAgICBzdWJ0aXRsZSA9ICJCYW5kYXMgaW5kaWNhbiBsw61taXRlcyBkZWwgTFMgICAiLAogICAgICAgICAgICAgICAgICBjYXB0aW9uID0gcGFzdGUobiwgIiBkYXRvcyBzaW11bGFkb3MiKSwKICAgICAgICAgICAgICAgICAgeCA9ICJaIiwKICAgICAgICAgICAgICAgICAgeSA9IGVsZW1lbnRfYmxhbmsoKQogICAgICAgICAgICAgICAgICApICsKICAgICAgICAgICAgIGdlb21fdmxpbmUoeGludGVyY2VwdCA9IC0xLjk2LCAKICAgICAgICAgICAgICAgICAgICAgICAgY29sb3VyID0gcmdiKDExOCw3OCwxNDQsIG1heENvbG9yVmFsdWUgPSAyNTUpLCAKICAgICAgICAgICAgICAgICAgICAgICAgbGluZXR5cGUgPSAiZGFzaGVkIgogICAgICAgICAgICAgICAgICAgICAgICApICsKICAgICAgICAgICAgIGdlb21fdmxpbmUoeGludGVyY2VwdCA9IDEuOTYsIAogICAgICAgICAgICAgICAgICAgICAgICBjb2xvdXIgPSByZ2IoMTE4LDc4LDE0NCwgbWF4Q29sb3JWYWx1ZSA9IDI1NSksIAogICAgICAgICAgICAgICAgICAgICAgICBsaW5ldHlwZSA9ICJkYXNoZWQiCiAgICAgICAgICAgICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgZ2VvbV9wb2ludChhZXMoeCA9IHosIHkgPSAwKSwgCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gcm9icyRjb2xvciwgYWxwaGEgPSAwLjMpICsKICAgICAgICAgICAgIHNjYWxlX3lfY29udGludW91cyhicmVha3MgPSBOVUxMKSArCiAgICAgICAgICAgICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gYygtMywgLTEuOTYsIC0xLCAwLCAxLCAxLjk2LCAzKSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gYXMuY2hhcmFjdGVyKGMoLTMsIC0xLjk2LCAtMSwgMCwgMSwgMS45NiwgMykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICBhbm5vdGF0ZSgidGV4dCIsIHggPSAzLCB5ID0gMC41LCAKICAgICAgICAgICAgICAgICAgICAgIGxhYmVsID0gcGFzdGUoIiMgc2lnbiA9ICIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGgocm9icyRjb2xvcltyb2JzJGNvbG9yID09ICJmaXJlYnJpY2siXSksICIvIiwgbiksCiAgICAgICAgICAgICAgICAgICAgICBjb2xvdXIgPSAiZmlyZWJyaWNrIgogICAgICAgICAgICAgICAgICAgICAgKQoKcm9icy5wbG90CmBgYAoKYGBge3J9CnNldC5zZWVkKDQ1KQpuIDwtIDEwMDAKYS5jb3JyIDwtICgwLjA1L24pLzIKc2lnLmxldiA8LSBhYnMocW5vcm0oYS5jb3JyKSkKcm9icyA8LSBkYXRhLmZyYW1lKHogPSBybm9ybShuKSkKcm9ic1siY29sb3IiXSA8LSBpZmVsc2Uocm9icyR6IDwgLXNpZy5sZXYgfCByb2JzJHogPiBzaWcubGV2LCAiZmlyZWJyaWNrIiwgImRlZXBza3libHVlNCIpCgpyY29yLnBsb3QgPC0gZ2dwbG90KGRhdGEgPSByb2JzLCBhZXMoeikpICsgCiAgICAgICAgICAgICBnZW9tX2RlbnNpdHkoY29sb3IgPSAiZGVlcHNreWJsdWU0IikgKyAKICAgICAgICAgICAgIGJsYW5rX3RoZW1lKCkgKyAKICAgICAgICAgICAgIGxhYnModGl0bGUgPSAiT2JzZXJ2YWNpb25lcyBhbGVhdG9yaWFzIGEgdW4gbml2ZWwgZGUgc2lnbmlmaWNhbmNpYSBkZSAwLjA1IiwKICAgICAgICAgICAgICAgICAgc3VidGl0bGUgPSAiQmFuZGFzIGluZGljYW4gbMOtbWl0ZXMgZGVsIExTIGNvcnJlZ2lkbyIsCiAgICAgICAgICAgICAgICAgIGNhcHRpb24gPSBwYXN0ZShuLCAiIGRhdG9zIHNpbXVsYWRvcyIpLAogICAgICAgICAgICAgICAgICB4ID0gIloiLAogICAgICAgICAgICAgICAgICB5ID0gZWxlbWVudF9ibGFuaygpCiAgICAgICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgZ2VvbV92bGluZSh4aW50ZXJjZXB0ID0gLXNpZy5sZXYsIAogICAgICAgICAgICAgICAgICAgICAgICBjb2xvdXIgPSByZ2IoMTE4LDc4LDE0NCwgbWF4Q29sb3JWYWx1ZSA9IDI1NSksIAogICAgICAgICAgICAgICAgICAgICAgICBsaW5ldHlwZSA9ICJkYXNoZWQiCiAgICAgICAgICAgICAgICAgICAgICAgICkgKwogICAgICAgICAgICAgZ2VvbV92bGluZSh4aW50ZXJjZXB0ID0gc2lnLmxldiwgCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG91ciA9IHJnYigxMTgsNzgsMTQ0LCBtYXhDb2xvclZhbHVlID0gMjU1KSwgCiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmV0eXBlID0gImRhc2hlZCIKICAgICAgICAgICAgICAgICAgICAgICAgKSArCiAgICAgICAgICAgICBnZW9tX3BvaW50KGFlcyh4ID0geiwgeSA9IDApLCAKICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSByb2JzJGNvbG9yLCBhbHBoYSA9IDAuMykgKwogICAgICAgICAgICAgc2NhbGVfeV9jb250aW51b3VzKGJyZWFrcyA9IE5VTEwpICsKICAgICAgICAgICAgIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSBjKC0zLCAtMS45NiwgLTEsIDAsIDEsIDEuOTYsIDMpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBhcy5jaGFyYWN0ZXIoYygtMywgLTEuOTYsIC0xLCAwLCAxLCAxLjk2LCAzKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApICsKICAgICAgICAgICAgIGFubm90YXRlKCJ0ZXh0IiwgeCA9IDIuNSwgeSA9IDAuNSwgCiAgICAgICAgICAgICAgICAgICAgICBsYWJlbCA9IHBhc3RlKCIjIHNpZ24gPSAiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoKHJvYnMkY29sb3Jbcm9icyRjb2xvciA9PSAiZmlyZWJyaWNrIl0pLCAiLyIsIG4pLAogICAgICAgICAgICAgICAgICAgICAgY29sb3VyID0gImZpcmVicmljayIKICAgICAgICAgICAgICAgICAgICAgICkKCnJjb3IucGxvdApgYGAKCiMjIEFOT1ZBIFNoZWlyZXItUmF5LUhhcmUKCkNhcmd1ZW1vcyBsb3MgZGF0b3MKYGBge3J9Cm1pbGkgPC0gcmVhZC5jc3YoImRhdGEvbWlsaXBlZG9zLmNzdiIpCmNvbG5hbWVzKG1pbGkpIDwtIGMoIkVzcGVjaWUiLCAiU2V4byIsICJBbGEiKQpzdHIobWlsaSkKYGBgCgpSZWFsaWNlbW9zIGxhIHBydWViYSBkZSBub3JtYWxpZGFkIHBhcmEgY2FkYSBuaXZlbCBkZSBjYWRhIHZhcmlhYmxlOgpgYGB7cn0Kbm9ybS5taWxpIDwtIGRhdGEuZnJhbWUoZ3J1cG8gPSBOQSwgbiA9IE5BLCBXID0gTkEsIHAgPSBOQSkKY29scyA8LSBjb2xuYW1lcyhtaWxpKVsxOjJdCmVzcGVjaWVzIDwtIGFzLmNoYXJhY3Rlcih1bmlxdWUobWlsaSRFc3BlY2llKSkKc2V4b3MgPC0gYXMuY2hhcmFjdGVyKHVuaXF1ZShtaWxpJFNleG8pKQoKZm9yIChpIGluIHNlcV9hbG9uZyhjb2xzKSkgeyMgQ2ljbGEgZW50cmUgbGFzIGNvbHVtbmFzIGluZGljYWRhcwogIGlmIChpID09IDEpIHsgIyBTaSBlcyBsYSBwcmltZXJhIGNvbHVtbmE6CiAgICBmb3IgKGogaW4gc2VxX2Fsb25nKGVzcGVjaWVzKSkgeyAjIENpY2xhIGVudHJlIGxvcyB2YWxvcmVzIGRlIGxhIGNvbHVtYSBFc3BlY2llcwogICAgICBzaGFwIDwtIHNoYXBpcm8udGVzdChtaWxpJEFsYVttaWxpW2NvbHNbaV1dID09IGVzcGVjaWVzW2pdXSkKICAgICAgbm9ybS5taWxpW2osXSA8LSBjKGVzcGVjaWVzW2pdLCAKICAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aChtaWxpJEFsYVttaWxpW2NvbHNbaV1dID09IGVzcGVjaWVzW2pdXSksIAogICAgICAgICAgICAgICAgICAgICAgICAgcm91bmQoc2hhcCRzdGF0aXN0aWMsIDIpLCAKICAgICAgICAgICAgICAgICAgICAgICAgIHJvdW5kKHNoYXAkcC52YWx1ZSwgMikKICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgIH0KICB9CiAgaWYgKGkgPT0gMikgeyAjIFNpIGVzIGxhIHNlZ3VuZGEgY29sdW1uYQogICAgZm9yIChrIGluIDE6bGVuZ3RoKHNleG9zKSkgeyAjIENpY2xhIGVudHJlIGxvcyB2YWxvcmVzIGRlIGxhIGNvbHVtbmEgU2V4bwogICAgICBzaGFwIDwtIHNoYXBpcm8udGVzdChtaWxpJEFsYVttaWxpW2NvbHNbaV1dID09IHNleG9zW2tdXSkKICAgICAgbm9ybS5taWxpW2orayxdIDwtIGMoc2V4b3Nba10sICMgU2V4byBkZSBsYSBpdGVyYWNpw7NuCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aChtaWxpJEFsYVttaWxpW2NvbHNbaV1dID09IHNleG9zW2tdXSksICMgVGFtYcOxbyBkZSBtdWVzdHJhIHBhcmEgZXNhIGl0ZXJhY2nDs24KICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91bmQoc2hhcCRzdGF0aXN0aWMsIDIpLCAjIAogICAgICAgICAgICAgICAgICAgICAgICAgICByb3VuZChzaGFwJHAudmFsdWUsIDIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgIH0KICB9Cn0KCm5vcm0ubWlsaQpgYGAKQ29tcHJvYmVtb3MgbGEgaG9tb2NlZGFzdGljaWRhZDoKYGBge3J9CiMgRGFkbyBxdWUgbG9zIGRhdG9zIHNlIGFqdXN0YXJvbiBhIHVuYSBkaXN0cmlidWNpw7NuIG5vcm1hbCBwb2RlbW9zIHV0aWxpemFyIGxhIHBydWViYSBkZSBCYXJ0bGV0dApiYXJ0bGV0dC50ZXN0KEFsYX5TZXhvLCBkYXRhID0gbWlsaSkKYmFydGxldHQudGVzdChBbGF+RXNwZWNpZSwgZGF0YSA9IG1pbGkpCmBgYApgYGB7cn0KIyBWZXJpZmljYW1vcyBjb24gbGEgcHJ1ZWJhIGRlIExldmVuZQpsaWJyYXJ5KGNhcikKbGV2ZW5lVGVzdChBbGF+U2V4bywgZGF0YSA9IG1pbGkpCmxldmVuZVRlc3QoQWxhfkVzcGVjaWUsIGRhdGEgPSBtaWxpKQpgYGAKClJlYWxpY2Vtb3MgbGEgcHJ1ZWJhIFNjaGVpcmVyLVJheS1IYXJlOgpgYGB7cn0KbGlicmFyeShyY29tcGFuaW9uKQpsaWJyYXJ5KEZTQSkKCnNjaGVpcmVyUmF5SGFyZShBbGEgfiBFc3BlY2llICsgU2V4bywgZGF0YSA9IG1pbGkpCmBgYAoKCmBgYHtyfQpkdW5uVGVzdChBbGF+RXNwZWNpZSwgZGF0YSA9IG1pbGksIG1ldGhvZCA9ICJib25mZXJyb25pIikKYGBgCgpCYWpvIGVzdGUgY3JpdGVyaW8sIGxhcyBkaWZlcmVuY2lhcyBwYXJlY2llcmFuIG5vIHNlciBzaWduaWZpY2F0aXZhcy4gQXBsaXF1ZW1vcyBlbnRvbmNlcyBlbCBBTk9WQSBkZSBkb3MgdsOtYXMgcGFyYW3DqXRyaWNvIHkgdmVhbW9zIHF1w6kgZW5jb250cmFtb3M6CgpgYGB7cn0KcmVzLm1pbGkgPC0gYW92KEFsYX5Fc3BlY2llICogU2V4bywgZGF0YSA9IG1pbGkpCnN1bW1hcnkocmVzLm1pbGkpCmBgYArCoVNPUlBSRVNBISBBaG9yYSBlbmNvbnRyYW1vcyBkaWZlcmVuY2lhcyBlbiBhbWJvcyBuaXZlbGVzLCBhdW5xdWUgbm8gc2UgZW5jb250csOzIHVuYSBpbnRlcmFjY2nDs24gZW50cmUgbG9zIGZhY3RvcmVzLiBSZWFsaWNlbW9zIGxhIHBydWViYSBIU0QgZGUgVHVrZXkgcGFyYSBhbmFsaXphciBsYXMgZGlmZXJlbmNpYXMgYSBjYWRhIG5pdmVsLgoKYGBge3J9ClR1a2V5SFNEKHJlcy5taWxpKSRFc3BlY2llCmBgYAoKVmVhbW9zIGFob3JhIGVzdG9zIHJlc3VsdGFkb3MgZGUgbWFuZXJhIGdyw6FmaWNhIHV0aWxpemFuZG8gdW4gZ3LDoWZpY28gZGUgaW50ZXJhY2Npw7NuOgoKYGBge3J9CmludGVyLnBsb3QgPC0gZ2dwbG90KGRhdGEgPSBtaWxpLCBhZXMoeCA9IFNleG8sIHkgPSBBbGEsIGNvbG9yID0gU2V4bykpICsgCiAgICAgICAgICAgICAgZ2VvbV92aW9saW4oKSArIGdlb21fYm94cGxvdCh3aWR0aCA9IDAuMSkgKyAKICAgICAgICAgICAgICBmYWNldF93cmFwKH5Fc3BlY2llKSArIAogICAgICAgICAgICAgIGJsYW5rX3RoZW1lKDEuNjEpICsKICAgICAgICAgICAgICBsYWJzKHRpdGxlID0gIkdyw6FmaWNvIGRlIGludGVyYWNjacOzbiBkZSBsYSBbQWxhXSAobWcvMTAwIG1sKSBlbiBtaWzDrXBlZG9zIiwKICAgICAgICAgICAgICAgICAgIHN1YnRpdGxlID0gIkVzcGVjaWUgKyBTZXhvIiwKICAgICAgICAgICAgICAgICAgIHggPSBlbGVtZW50X2JsYW5rKCksCiAgICAgICAgICAgICAgICAgICB5ID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgICAgICAgICAgICAgY2FwdGlvbiA9ICJEYXRvczogbWlsaXBlZG9zLmNzdiIpCmludGVyLnBsb3QKYGBgCkxhIHZhcmlhYmxlIEVzcGVjaWUgc29sYQpgYGB7cn0KZXNwZWMucGxvdCA8LSBnZ3Bsb3QoZGF0YSA9IG1pbGksIGFlcyh4ID0gRXNwZWNpZSwgeSA9IEFsYSwgY29sb3IgPSBFc3BlY2llKSkgKyAKICAgICAgICAgICAgICBnZW9tX3Zpb2xpbigpICsgZ2VvbV9ib3hwbG90KHdpZHRoID0gMC4xKSArIAogICAgICAgICAgICAgIGJsYW5rX3RoZW1lKCkgKwogICAgICAgICAgICAgIGxhYnModGl0bGUgPSAiR3LDoWZpY28gZGUgaW50ZXJhY2Npw7NuIGRlIGxhIFtBbGFdIChtZy8xMDAgbWwpIGVuIG1pbMOtcGVkb3MiLAogICAgICAgICAgICAgICAgICAgc3VidGl0bGUgPSAiRXNwZWNpZSIsCiAgICAgICAgICAgICAgICAgICB4ID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgICAgICAgICAgICAgeSA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICAgICAgICAgICAgIGNhcHRpb24gPSAiRGF0b3M6IG1pbGlwZWRvcy5jc3YiKQplc3BlYy5wbG90CmBgYApMYSB2YXJpYWJsZSBzZXhvIHNvbGEKYGBge3J9CnNleG9zLnBsb3QgPC0gZ2dwbG90KGRhdGEgPSBtaWxpLCBhZXMoeCA9IFNleG8sIHkgPSBBbGEsIGNvbG9yID0gU2V4bykpICsgCiAgICAgICAgICAgICAgZ2VvbV92aW9saW4oKSArIGdlb21fYm94cGxvdCh3aWR0aCA9IDAuMSkgKyAKICAgICAgICAgICAgICBibGFua190aGVtZSgpICsKICAgICAgICAgICAgICBsYWJzKHRpdGxlID0gIkdyw6FmaWNvIGRlIGludGVyYWNjacOzbiBkZSBsYSBbQWxhXSAobWcvMTAwIG1sKSBlbiBtaWzDrXBlZG9zIiwKICAgICAgICAgICAgICAgICAgIHN1YnRpdGxlID0gIkVzcGVjaWUiLAogICAgICAgICAgICAgICAgICAgeCA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICAgICAgICAgICAgIHkgPSBlbGVtZW50X2JsYW5rKCksCiAgICAgICAgICAgICAgICAgICBjYXB0aW9uID0gIkRhdG9zOiBtaWxpcGVkb3MuY3N2IikKc2V4b3MucGxvdApgYGAKCiMjIyBFamVyY2ljaW8KUmVhbGl6YXIgdW4gQU5PVkEgU2NoZWlyZXItUmF5LUhhcmUgY29uIGxhIGJhc2UgZGUgZGF0b3Mgc3RyYXdiZXJyeSAoW0hvcnN0ICpldCBhbC4qIDIwMDVdKGh0dHBzOi8vZG9pLm9yZy8xMC4xMDk0L3BkLTg5LTExOTUpKS4gVW5hIGJhc2UgZGUgZGF0b3MgbXVsdGl2YXJpYWRhIGNvbiBtZWRpZGFzIGRlIHBlc28sICUgZGUgQm90cnl0aXMsICUgZGUgb3RyYXMgZXBlY2llcyBmw7puZ2ljYXMgeSB1bmEgZXZhbHVhY2nDs24gZGUgUGhvbW9wc2lzIGVuIGxhcyBob2phcyBwYXJhIDQgdHJhdGFtaWVudG9zIGNvbiAzIHLDqXBsaWNhcyBjYWRhIHVuby4KYGBge3J9CnN0cmF3IDwtIHJlYWQuY3N2KCJkYXRhL3N0cmF3YmVycnkuY3N2IikKaGVhZChzdHJhdykKc3RyKHN0cmF3KQpzdW1tYXJ5KHN0cmF3KQpgYGAKCkhheSB1biBwYXIgZGUgZWxlbWVudG9zIGNvbiBsb3MgY3VhbGVzIGhheSBxdWUgdGVuZXIgY3VpZGFkbzogMSkgbGFzIHZhcmlhYmxlcyB0cmF0YW1pZW50byB5IHLDqXBsaWNhIHNvbiB2YXJpYWJsZXMgY2F0ZWfDs3JpY2FzIHkgZnVlcm9uIGRldGVjdGFkYXMgY29tbyB2YXJpYWJsZXMgZGUgZW50ZXJvcywgMikgbGEgdmFyaWFibGUgRXZhbCBlc3TDoSBlbiBlc2NhbGEgKm9yZGluYWwqIG5vIGVuIGVzY2FsYSBkZSBpbnRlcnZhbG8gbyBkZSByYXrDs24sIHBvciBsbyBjdWFsIHF1ZWRhIGF1dG9tw6F0aWNhbWVudGUgZGVzY2FydGFkYSBwYXJhIHBydWViYXMgcGFyYW3DqXRyaWNhcy4gQ29ycmlqYW1vcyBlbnRvbmNlcyBlbCBwdW50byAxOgoKYGBge3J9CnN0cmF3JFRyYXRhbWllbnRvIDwtIGZhY3RvcihMRVRURVJTW3N0cmF3JFRyYXRhbWllbnRvXSkKc3RyYXckUmVwIDwtIGZhY3RvcihsZXR0ZXJzW3N0cmF3JFJlcF0pCmhlYWQoc3RyYXcpCmBgYAoKIyBDb21wYXJhY2lvbmVzIE11bHRpdmFyaWFkYXMKIyMgRGF0b3MgcGFyYSBjb21wYXJhY2lvbmVzIE12CjEuIEJhc2UgZGUgZGF0b3MgaXJpcy4gTWVkaWRhcyBkZSA0IHZhcmlhYmxlcyBjdWFudGl0YXRpdmFzIHBhcmEgNTAgZmxvcmVzIGRlIGNhZGEgZXNwZWNpZSBkZSAqSXJpcyo6ICpzZXRvc2EqLCAqdmVyc2ljb2xvciogeSAqdmlyZ2luaWNhKi4gQWwgZXhwbG9yYXJsYSB2ZW1vcyBxdWUgdG9kbyBlc3TDoSBlbiBvcmRlbiwgbGFzIGN1YXRybyB2YXJpYWJsZXMgY3VhbnRpdGF0aXZhcyBmdWVyb24gZGV0ZWN0YWRhcyBjb21vIHRhbCB5IGxhIMO6bmljYSB2YXJpYWJsZSBjYXRlZ8OzcmljYSBmdWUgYXNpZ25hZGEgY29ycmVjdGFtZW50ZQpgYGB7cn0KaGVhZChpcmlzKQpzdHIoaXJpcykKc3VtbWFyeShpcmlzKQpgYGAKCgojIyBQcnVlYmEgJFReMiQgZGUgSG90ZWxsaW5nCkVzIHVuYSBleHRlbnNpw7NuIG11bHRpdmFyaWFkYSBkZSBsYSBwcnVlYmEgVCBkZSBTdHVkZW50OyBwb3IgbG8gdGFudG8sIGVzIHVuYSBwcnVlYmEgcGFyYW3DqXRyaWNhLiBDb21wYXJlbW9zIHNpIGxhcyBlc3BlY2llcyAqdmVyc2ljb2xvciogeSAqdmlyZ2luaWNhKiBzb24gaWd1YWxlcy4gUGFyYSBlbGxvIGVzIGltcG9ydGFudGUgcmV2aXNhciBsb3Mgc3VwdWVzdG9zIGRlbCBhbsOhbGlzaXM6CgojIyMgTm9ybWFsaWRhZApgYGB7cn0KbGlicmFyeShNVk4pCm12bihpcmlzLCBzdWJzZXQgPSAiU3BlY2llcyIsIG12blRlc3QgPSAibWFyZGlhIiwgZGVzYyA9IEYpJG11bHRpdmFyaWF0ZU5vcm1hbGl0eQpgYGAKYGBge3J9Cm12bihpcmlzLCBzdWJzZXQgPSAiU3BlY2llcyIsIG12blRlc3QgPSAiaHoiLCBkZXNjID0gRikkbXVsdGl2YXJpYXRlTm9ybWFsaXR5CmBgYApgYGB7cn0KbXZuKGlyaXMsIHN1YnNldCA9ICJTcGVjaWVzIiwgbXZuVGVzdCA9ICJyb3lzdG9uIiwgZGVzYyA9IEYpJG11bHRpdmFyaWF0ZU5vcm1hbGl0eQpgYGAKCiMjIyBJZ3VhbGRhZCBkZSBkaXNwZXJzacOzbiBtdWx0aXZhcmlhZGEKQWwgYXBsaWNhciBsYSBwcnVlYmEgZ2xvYmFsIHZlbW9zIHF1ZSBhbCBwYXJlY2VyIG5vIGhheSBkaWZlcmVuY2lhcyBpbXBvcnRhbnRlcyBlbiBsYXMgZGlzcGVyc2lvbmVzIG11bHRpdmFyaWFkYXMKYGBge3J9CmxpYnJhcnkodmVnYW4pCmRpc3QubWF0IDwtIHZlZ2Rpc3QoaXJpc1ssMTo0XSwgbWV0aG9kID0gImV1Y2xpZGVhbiIsIHR5cGUgPSBjKCJtZWRpYW4iKSkKZ3JvdXBzIDwtIGFzLmNoYXJhY3RlcihpcmlzJFNwZWNpZXMpCmRpc3AubXYgPC0gYmV0YWRpc3BlcihkaXN0Lm1hdCwgZ3JvdXAgPSBncm91cHMsIHR5cGUgPSAibWVkaWFuIikgIyBSZWFsaXphciBlbCBwcm9jZWRpbWllbnRvCmRpc3AubXYKYW5vdmEoZGlzcC5tdikgIyBQcnVlYmEgZGUgaGlww7N0ZXNpcwpgYGAKTGEgcHJ1ZWJhIHBvc3QtaG9jIGNvbmZpcm1hIGxvcyByZXN1bHRhZG9zCmBgYHtyfQptb2QuSFNEIDwtIFR1a2V5SFNEKGRpc3AubXYpCm1vZC5IU0QgPC0gZGF0YS5mcmFtZShtb2QuSFNEJGdyb3VwLCBjb21wID0gZGltbmFtZXMobW9kLkhTRCRncm91cClbWzFdXSkKbW9kLkhTRApgYGAKCiMjIyBDb21wYXJhY2nDs24gTXVsdGl2YXJpYWRhOgpFeHRyYWVtb3MgZG9zIGdydXBvcyBhIGNvbXBhcmFyCmBgYHtyfQp2ZXJzaWNvbG9yIDwtIHN1YnNldChpcmlzLCAoU3BlY2llcyA9PSAidmVyc2ljb2xvciIpKVssMTo0XQp2aXJnaW5pY2EgPC0gc3Vic2V0KGlyaXMsIChTcGVjaWVzID09ICJ2aXJnaW5pY2EiKSlbLDE6NF0KCnZlcnNpLnZpcmcgPC0gc3Vic2V0KGlyaXMsIChTcGVjaWVzID09ICJ2ZXJzaWNvbG9yIikgfCAoU3BlY2llcyA9PSAidmlyZ2luaWNhIikpCmBgYAoKQXBsaWNhbW9zIGxhIHBydWViYToKYGBge3J9CmxpYnJhcnkoSG90ZWxsaW5nKQpob3QudDIgPC0gaG90ZWxsaW5nLnRlc3QoeCA9IHZpcmdpbmljYSwgeSA9IHZlcnNpY29sb3IpCmhvdC50MgpgYGAKCkFsIHBhcmVjZXIsIGxvcyBwcm9tZWRpb3MgZGUgbGFzIG1lZGljaW9uZXMgbXVsdGl2YXJpYWRhcyBzb24gZGlmZXJlbnRlcy4KCiMjIyBDb21wYXJhY2lvbmVzIHVuaXZhcmlhZGFzClJlYWxpemFyZW1vcyA0IGNvbXBhcmFjaW9uZXMgdW5pdmFyaWFkYXMgwr90aWVuZSBzZW50aWRvIGFwbGljYXIgdW5hIGNvcnJlY2Npw7NuIGRlIEJvbmZlcnJvbmk/IEFsZ28gYSBub3RhciBlcyBxdWUgbGEgcHJ1ZWJhIGFwbGljYWRhIGVuIGVzdGUgY2FzbyBlcyBsYSBwcnVlYmEgZGUgV2VsY2g7IGVzIGRlY2lyLCB1bmEgcHJ1ZWJhIGJham8gZWwgc3VwdWVzdG8gZGUgZGVzaWd1YWxkYWQgZGUgdmFyaWFuemFzIChtdWVzdHJhcyBoZXRlcm9jZWTDoXN0aWNhcykuIFBhcmEgYXBsaWNhciBsYSBwcnVlYmEgVCBkZSBTdHVkZW50IHNvbG8gaGF5IHF1ZSBhZ3JlZ2FyIGVsIGFyZ3VtZW50byBgZXF1YWwudmFyID0gVFJVRWAgYSBsYSBmdW5jacOzbi4KCmBgYHtyfQp0LnRlc3QoU2VwYWwuTGVuZ3RoflNwZWNpZXMsIHZlcnNpLnZpcmcpCmBgYAoKYGBge3J9CnQudGVzdChTZXBhbC5XaWR0aH5TcGVjaWVzLCB2ZXJzaS52aXJnKQpgYGAKCmBgYHtyfQp0LnRlc3QoUGV0YWwuTGVuZ3RoflNwZWNpZXMsIHZlcnNpLnZpcmcpCmBgYAoKYGBge3J9CnQudGVzdChQZXRhbC5XaWR0aH5TcGVjaWVzLCB2ZXJzaS52aXJnKQpgYGAKCiMjIEFuw6FsaXNpcyBNdWx0aXZhcmlhZG8gZGUgbGEgVmFyaWFuemEKRXh0ZW5zacOzbiBNdWx0aXZhcmlhZGEgZGVsIEFuw6FsaXNpcyBkZSBsYSBWYXJpYW56YTsgcG9yIGxvIHRhbnRvIGVzIGVsIGVxdWl2YWxlbnRlIGEgdW5hIHBydWViYSAkVF4yJCBkZSBIb3RlbGxpbmcgY29uIG3DoXMgZGUgZG9zIGdydXBvcyAoYWwgaWd1YWwgcXVlIGVsIEFOT1ZBIGNvbiByZXNwZWN0byBhIGxhIHBydWViYSB0IGRlIFN0dWRlbnQpCgpBaG9yYSBhcGxpcXVlbW9zIGxhIHBydWViYSB1dGlsaXphbmRvIGxhIGZ1bmNpw7NuIGBNYW5vdmEoKWAgZGUgbGEgbGlicmVyw61hIGBjYXJgCgpgYGB7cn0KbW9kZWwgPC0gbG0oY2JpbmQoU2VwYWwuTGVuZ3RoLAogICAgICAgICAgICAgICAgICBQZXRhbC5MZW5ndGgsCiAgICAgICAgICAgICAgICAgIFNlcGFsLldpZHRoLAogICAgICAgICAgICAgICAgICBQZXRhbC5XaWR0aCl+U3BlY2llcywgZGF0YSA9IGlyaXMpCk1hbm92YShtb2RlbCwgdGVzdC5zdGF0aXN0aWMgPSAiV2lsa3MiKQpgYGAKCmBgYHtyfQojIExhIGZvcm1hIHBvciBkZWZlY3RvIGRlIFIsIGNvbiBsYSB0cmF6YSBkZSBQaWxsYWkKcmVzLm1hbiA8LSBtYW5vdmEoY2JpbmQoU2VwYWwuTGVuZ3RoLCBQZXRhbC5MZW5ndGgsIFNlcGFsLldpZHRoLCBQZXRhbC5XaWR0aCl+U3BlY2llcywgZGF0YSA9IGlyaXMpCnN1bW1hcnkocmVzLm1hbikKYGBgCmBgYHtyfQpzdW1tYXJ5LmFvdihyZXMubWFuKQpgYGAKCkxhIHBydWViYSBwb3N0LWhvYyBlcyB1bmEgcHJ1ZWJhIEhTRCBkZSBUdWtleSBwb3IgY2FkYSB2YXJpYWJsZS4gCgpgYGB7cn0KVHVrZXlIU0QoYW92KFNlcGFsLldpZHRoflNwZWNpZXMsIGRhdGEgPSBpcmlzKSkKYGBgClZlYW1vcyB1biBncsOhZmljbyBkZSB2aW9sw61uIHBhcmEgY2FkYSB2YXJpYWJsZSBkZSBjYWRhIGVzcGVjaWU6CmBgYHtyfQpsaWJyYXJ5KGdyaWRFeHRyYSkKCnNlcGFsbC5wbG90IDwtIGdncGxvdChkYXRhID0gaXJpcywgYWVzKHggPSBTcGVjaWVzLCB5ID0gU2VwYWwuTGVuZ3RoLCBjb2xvdXIgPSBTcGVjaWVzKSkgKyAKICAgICAgICAgICAgICAgZ2VvbV92aW9saW4oKSArIAogICAgICAgICAgICAgICBnZW9tX2JveHBsb3Qod2lkdGggPSAwLjEpICsgCiAgICAgICAgICAgICAgIGJsYW5rX3RoZW1lKDEvMS42MSkgKwogICAgICAgICAgICAgICBsYWJzKHRpdGxlID0gIlNlcGFsIGxlbmd0aCIsCiAgICAgICAgICAgICAgICAgICAgeCA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICAgICAgICAgICAgICB5ID0gZWxlbWVudF9ibGFuaygpKQpzZXBhbHcucGxvdCA8LSBnZ3Bsb3QoZGF0YSA9IGlyaXMsIGFlcyh4ID0gU3BlY2llcywgeSA9IFNlcGFsLldpZHRoLCBjb2xvdXIgPSBTcGVjaWVzKSkgKyAKICAgICAgICAgICAgICAgZ2VvbV92aW9saW4oKSArIAogICAgICAgICAgICAgICBnZW9tX2JveHBsb3Qod2lkdGggPSAwLjEpICsgCiAgICAgICAgICAgICAgIGJsYW5rX3RoZW1lKDEvMS42MSkgKwogICAgICAgICAgICAgICBsYWJzKHRpdGxlID0gIlNlcGFsIHdpZHRoIiwKICAgICAgICAgICAgICAgICAgICB4ID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgICAgICAgICAgICAgIHkgPSBlbGVtZW50X2JsYW5rKCkpCnBldGFsbC5wbG90IDwtIGdncGxvdChkYXRhID0gaXJpcywgYWVzKHggPSBTcGVjaWVzLCB5ID0gUGV0YWwuTGVuZ3RoLCBjb2xvdXIgPSBTcGVjaWVzKSkgKyAKICAgICAgICAgICAgICAgZ2VvbV92aW9saW4oKSArIAogICAgICAgICAgICAgICBnZW9tX2JveHBsb3Qod2lkdGggPSAwLjEpICsgCiAgICAgICAgICAgICAgIGJsYW5rX3RoZW1lKDEvMS42MSkrCiAgICAgICAgICAgICAgIGxhYnModGl0bGUgPSAiUGV0YWwgbGVuZ3RoIiwKICAgICAgICAgICAgICAgICAgICB4ID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgICAgICAgICAgICAgIHkgPSBlbGVtZW50X2JsYW5rKCkpCnBldGFsdy5wbG90IDwtIGdncGxvdChkYXRhID0gaXJpcywgYWVzKHggPSBTcGVjaWVzLCB5ID0gUGV0YWwuV2lkdGgsIGNvbG91ciA9IFNwZWNpZXMpKSArIAogICAgICAgICAgICAgICBnZW9tX3Zpb2xpbigpICsgCiAgICAgICAgICAgICAgIGdlb21fYm94cGxvdCh3aWR0aCA9IDAuMSkgKyAKICAgICAgICAgICAgICAgYmxhbmtfdGhlbWUoMS8xLjYxKSsKICAgICAgICAgICAgICAgbGFicyh0aXRsZSA9ICJTZXBhbCB3aWR0aCIsCiAgICAgICAgICAgICAgICAgICAgeCA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICAgICAgICAgICAgICB5ID0gZWxlbWVudF9ibGFuaygpKQoKZ3JpZC5hcnJhbmdlKHNlcGFsbC5wbG90LCBzZXBhbHcucGxvdCwgcGV0YWxsLnBsb3QsIHBldGFsdy5wbG90KQpgYGAKCgpPIHZlYW1vcyB1biBncsOhZmljbyBkZSBjb29yZGVuYWRhcyBwYXJhbGVsYXMsIGVsIGN1YWwgbm9zIHBlcm1pdGUgYW5hbGl6YXIgbGFzIG1lZGljaW9uZXMgZGUgY2FkYSB2YXJpYWJsZSBkZSBjYWRhIGluZGl2aWR1byBlbiB1biBtaXNtbyBncsOhZmljbzoKCmBgYHtyfQpsaWJyYXJ5KEdHYWxseSkKY29vcmQucGxvdCA8LSBnZ3BhcmNvb3JkKGlyaXMsIAogICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1ucyA9IDE6NCwgCiAgICAgICAgICAgICAgICAgICAgICAgICBncm91cENvbHVtbiA9IDUsIAogICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1BvaW50cyA9IFQsIAogICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGUgPSAic3RkIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlciA9ICJhbnlDbGFzcyIsIAogICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGFMaW5lcyA9IDAuNSkgKyAKICAgICAgICAgICAgICAgYmxhbmtfdGhlbWUoMS8xLjYxKSArCiAgICAgICAgICAgICAgIGxhYnModGl0bGUgPSAiR3LDoWZpY28gZGUgY29vcmRlbmFkYXMgcGFyYWxlbGFzIiwKICAgICAgICAgICAgICAgICAgICBzdWJ0aXRsZSA9ICJWYWxvcmVzIGVzY2FsYWRvcyIsCiAgICAgICAgICAgICAgICAgICAgeSA9IGVsZW1lbnRfYmxhbmsoKSwKICAgICAgICAgICAgICAgICAgICB4ID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgICAgICAgICAgICAgIGNhcHRpb24gPSAiRGF0b3M6IElyaXMiKQpjb29yZC5wbG90CmBgYAoKIyMgQW7DoWxpc2lzIFBlcm11dGFjaW9uYWwgTXVsdGl2YXJpYWRvIGRlIGxhIFZhcmlhbnphOgpMb3MgcGFzb3MgYSBzZWd1aXIgc29uIGLDoXNpY2FtZW50ZSBsb3MgbWlzbW9zIHF1ZSBsb3MgcXVlIHNlZ3VpbW9zIHBhcmEgcmVhbGl6YXIgbGEgcHJ1ZWJhIGRlIGhvbW9nZW5laWRhZCBkZSBtYXRyaWNlcyBkZSBkaXNwZXJzacOzbi4gRXN0ZSBzdXB1ZXN0byBlcywgZGViaWRvIGEgbGEgYXByb3hpbWFjacOzbiBwZXJtdXRhY2lvbmFsLCAocG9zaWJsZW1lbnRlKSBlbCBzdXB1ZXN0byBtw6FzIGltcG9ydGFudGUgcGFyYSBlc3RhIHBydWViYS4gRXMgaW1wb3J0YW50ZSBub3RhciBxdWUgZXhpc3RlIHVuYSBjb3JyZWNjacOzbiBwYXJhIGdydXBvcyBjb24gdmFyaWFuemFzIG5vIGhvbW9nw6luZWFzLgoKYGBge3J9CnNldC5zZWVkKDEpCm4gPC0gMTAwICMgVGFtYcOxbyBkZSBtdWVzdHJhCgojIFZhbG9yZXMgb2JzZXJ2YWRvcwp0ciA8LSByYmlub20oMTAwLCAxLCAwLjUpICMgRGlzdHJpYnVjacOzbiBiaW5vbWlhbCBjb24gcCjDqXhpdG8pID0gNTAlCnkgPC0gMSArIHRyICsgcm5vcm0obiwgMCwgMykgI1ZhbG9yZXMgZGUgcmVzcHVlc3RhCgpzIDwtIHNhbXBsZSh0ciwgbGVuZ3RoKHRyKSwgRkFMU0UpICMgTXVlc3RyZW8gYWxlYXRvcmlvIHNpbiByZW1wbGF6byAKZGlmZihieSh5LCBzLCBtZWFuKSkgIyBQcm9tZWRpbyBkZSBsYXMgZGlmZXJlbmNpYXMKCiMgUGVybXV0YWNpb25lcwpkaXN0IDwtIGRhdGEuZnJhbWUoZiA9IHVubmFtZShyZXBsaWNhdGUoMjAwMCwgZGlmZihieSh5LCBzYW1wbGUodHIsIGxlbmd0aCh0ciksIEZBTFNFKSwgbWVhbikpKSkpCmBgYAoKYGBge3J9CnBlcm11dC5wbG90IDwtIGdncGxvdChkYXRhID0gZGlzdCwgYWVzKGYpKSArIAogICAgICAgICAgICAgICBnZW9tX2RlbnNpdHkoY29sb3IgPSAiZGVlcHNreWJsdWU0IiwgZmlsbCA9ICJkZWVwc2t5Ymx1ZTMiLCBhbHBoYSA9IDAuNSkgKyAKICAgICAgICAgICAgICAgZ2VvbV92bGluZSh4aW50ZXJjZXB0ID0gMS4zLCBjb2xvdXIgPSByZ2IoMTE4LDc4LDE0NCwgbWF4Q29sb3JWYWx1ZSA9IDI1NSkpICsgCiAgICAgICAgICAgICAgIGJsYW5rX3RoZW1lKCkgKwogICAgICAgICAgICAgICBsYWJzKHRpdGxlID0gIlJlc3VsdGFkb3MgZGUgdW4gZXhwZXJpbWVudG8gcGVybXV0YWNpb25hbCIsCiAgICAgICAgICAgICAgICAgICAgc3VidGl0bGUgPSAiRGlzdHJpYnVjacOzbiBkZSBsYXMgZGlmZXJlbmNpYXMgZW50cmUgZG9zIGdydXBvcyIsCiAgICAgICAgICAgICAgICAgICAgY2FwdGlvbiA9ICJEYXRvcyBzaW11bGFkb3MiLAogICAgICAgICAgICAgICAgICAgIHggPSBlbGVtZW50X2JsYW5rKCksCiAgICAgICAgICAgICAgICAgICAgeSA9IGVsZW1lbnRfYmxhbmsoKSkKcGVybXV0LnBsb3QKYGBgCgpBcGxpcXVlbW9zIGVudG9uY2VzIGxhIHBydWViYS4gUGFyYSBlbGxvIGxvIHByaW1lcm8gc2Vyw6EgY2FsY3VsYXIgbGEgbWF0cml6IGRlIGRpc3RhbmNpYXMgKGRlIG5vIHBhc2FyIHVuYSBtYXRyaXogZGUgZGlzdGFuY2lhcyBhIGxhIHBydWViYSBoYXLDoSBwb3IgZGVmYXVsdCBsYSBkaXNpbWlsYXJpZGFkIGRlIEJyYXktQ3VydGlzKQoKYGBge3J9CmRpc3QubWF0IDwtIHZlZ2Rpc3QoaXJpc1ssMTo0XSwgbWV0aG9kID0gImV1Y2xpZGVhbiIpICMgTWF0cml6IGRlIGRpc3RhbmNpYXMKZ3JwcyA8LSBpcmlzWyw1XSAjIEVzIHVuIGRhdGEuZnJhbWUgcXVlIGNvbnRpZW5lIGxvcyBkaXN0aW50b3Mgbml2ZWxlcyBkZSBhZ3J1cGFtaWVudG8sIGFuaWRhZG9zIG8gbm8KYGBgCgpBaG9yYSBwb2RlbW9zIGFwbGljYXIgZWwgUEVSTUFOT1ZBLiBEZSBsb3MgcmVzdWx0YWRvcyBwb2RlbW9zIG9ic2VydmFyIHF1ZSBsYSBwcmluY2lwYWwgZGl2aXNpw7NuIGVudHJlIGVzcGVjaWVzIGVzdMOhIGRhZGEgcG9yIGxhIGxvbmdpdHVkIGRlbCBzw6lwYWxvLCBzZWd1aWRhIHBvciBlbCBhbmNoby4gTGFzIGN1YXRybyB2YXJpYWJsZXMgZXhwbGljYW4gZWwgMTAwJSBkZWwgZXNwYWNpbyBtdWx0aXZhcmlhZG8gKCRSXjIkIGRlIGxvcyByZXNpZHVhbGVzID0gMCkuICJbLi4uXSBkaWZlcmVuY2lhcyBzaWduaWZpY2F0aXZhcyBlbiBsYSBsb25naXR1ZCBkZWwgc8OpcGFsbyAoRigxLCAxNDMpID0gNS4xKjEwXjE4OyBwIDwgMC4wMDEpIgpgYGB7cn0KYWRvbmlzMihkaXN0Lm1hdH5pcmlzJFNlcGFsLkxlbmd0aCppcmlzJFNlcGFsLldpZHRoK2lyaXMkUGV0YWwuTGVuZ3RoKmlyaXMkUGV0YWwuV2lkdGgsIAogICAgICAgIGRhdGEgPSBncnBzLCBwZXJtdXRhdGlvbnMgPSA5OTkpCmBgYAoKVmVhbW9zIGxhIGRpc3BlcnNpw7NuIG11bHRpdmFyaWFkYQpgYGB7cn0KcGxvdChiZXRhZGlzcGVyKGRpc3QubWF0LCBncnBzKSwgaHVsbCA9IEYsIGVsbGlwc2UgPSBUKQpgYGAKClBvZGVtb3MgdXRpbGl6YXIgdGFtYmnDqW4gdW4gRXNjYWxhbWllbnRvIE11bHRpLURpbWVuc2lvbmFsIE5vIFBhcmFtw6l0cmljby4gRXN0YSB0w6ljbmljYSBlcyBzaW1pbGFyIGFsIFBDQSBlbiBlbCBzZW50aWRvIGRlIHF1ZSBwcm95ZWN0YSB1biBlc3BhY2lvIGFsdGFtZW50ZSBkaW1lbnNpb25hbCBhIHVuIGVzcGFjaW8gY29uIG1lbm9zIGRpbWVuc2lvbmVzIChrKSwgdHJhdGFuZG8gZGUgcHJlc2VydmFyIGxhcyBkaXN0YW5jaWFzIGVudHJlIGNhZGEgcHVudG8uIEVuIHBvY2FzIHBhbGFicmFzLCBlcyB1bmEgImhvamEiIG8gImzDoW1pbmEiIGRlIHBvY2FzIGRpbWVuc2lvbmVzIGRlbnRybyBkZSB1biBlc3BhY2lvIGFsdGFtZW50ZSBkaW1lbnNpb25hbC4KCmBgYHtyfQppcmlzLm1kcyA8LSBtZXRhTURTKGRpc3QubWF0LCBkaXN0YW5jZSA9ICJldWNsaWRlYW4iLCBrID0gMiwgdHJhY2UgPSBGKQptZHMuZGltcyA8LSBkYXRhLmZyYW1lKE5NRFMxID0gaXJpcy5tZHMkcG9pbnRzWywxXSwgTk1EUzIgPSBpcmlzLm1kcyRwb2ludHNbLDJdKQoKbWRzLnBsb3QuZGF0YSA8LSBjYmluZChtZHMuZGltcywgaXJpcykKCiMgRXh0cmFlbW9zIGxhcyBjb3JyZWxhY2lvbmVzIGRlIGNhZGEgZmFjdG9yIGNvbiBjYWRhIGRpbWVuc2nDs24gcmVkdWNpZGEgKGZsZWNoYXMpCmZpdCA8LSBlbnZmaXQoaXJpcy5tZHMsIGlyaXMpCmFycm93IDwtIGRhdGEuZnJhbWUoZml0JHZlY3RvcnMkYXJyb3dzLCBSID0gZml0JHZlY3RvcnMkciwgUCA9IGZpdCR2ZWN0b3JzJHB2YWxzKQphcnJvd1siVmFyaWFibGUiXSA8LSByb3duYW1lcyhhcnJvdykKCmFycm93LnAgPC1zdWJzZXQoYXJyb3csIFAgPD0gMC4wNSkKYGBgCgpQb3N0ZXJpb3JtZW50ZSBwb2RlbW9zIGdyYWZpY2FybG8uIEVsICJlc3Ryw6lzIiByZXByZXNlbnRhIGxhIGZpZGVsaWRhZCBjb24gcmVzcGVjdG8gYWwgZXNwYWNpbyBvcmlnaW5hbDsgZW50cmUgbcOhcyBhbHRvIHNlYSwgbWF5b3JlcyBzZXLDoW4gbGFzIGRlZm9ybWFjaW9uZXMgKG1lbm9yIGZ1ZSBlbCDDqXhpdG8gZGUgcHJlc2VydmFyIGxhcyBkaXN0YW5jaWFzKS4gRW4gZ2VuZXJhbCwgdmFsb3JlcyBkZSBlc3Ryw6lzIG1lbm9yZXMgYSAwLjEgc2UgY29uc2lkZXJhbiBhY2VwdGFibGVzLCBtZW5vcmVzIGEgMC4wNSBjb21vIHVuYSBidWVuYSByZXByZXNlbnRhY2nDs24geSBwb3IgZW5jaW1hIGRlIDAuMyBpbmRpY2FuIHVuYSAib3JkZW5hY2nDs24iIGFyYml0cmFyaWEuIEVuIG51ZXN0cm8gZ3LDoWZpY28sIGVsIGVzdHLDqXMgZGUgMC4wMiBpbmRpY2EgcXVlIGxhIHJlcHJlc2VudGFjacOzbiBlcyBmaWRlZGlnbmEsIHF1ZSBsYSBtYXlvciBkaXZpc2nDs24gZW50cmUgZXNwZWNpZXMgc2UgZGEgZW4gZWwgZWplIHggKHVzdWFsbWVudGUpIHkgcXVlIGxhcyB2YXJpYWJsZXMgbcOhcyByZWxhY2lvbmFkYXMgY29uIGVzYSBzZXBhcmFjacOzbiBzb24gbGEgbG9uZ2l0dWQgeSBlbCBhbmNobyBkZWwgcMOpdGFsbywgbG8gY3VhbCBjb3JyZXNwb25kZSBwZXJmZWN0YW1lbnRlIGNvbiBsbyBlbmNvbnRyYWRvIHBvciBlbCBQRVJNQU5PVkEuCgpgYGB7cn0KbWRzLnBsb3QgPC0gZ2dwbG90KG1kcy5wbG90LmRhdGEsIGFlcyhOTURTMSwgTk1EUzIpKSArCiAgICAgICAgICAgIGdlb21fcG9pbnQoYWVzKGNvbG9yID0gU3BlY2llcyksIGFscGhhID0gMC43KSArCiAgICAgICAgICAgIHN0YXRfZWxsaXBzZShhZXMoZmlsbCA9IFNwZWNpZXMpLCB0eXBlID0gInQiLCBzaXplID0gMSwgZ2VvbSA9ICJwb2x5Z29uIiwgYWxwaGEgPSAwLjIpICsgCiAgICAgICAgICAgIGxhYnModGl0bGUgPSAiRXNjYWxhbWllbnRvIE11bHRpZGltZW5zaW9uYWwgbm8gbcOpdHJpY28gKE5NRFMpIiwKICAgICAgICAgICAgICAgICBzdWJ0aXRsZSA9IHBhc3RlKCdFc3Ryw6lzID0nLHJvdW5kKGlyaXMubWRzJHN0cmVzcywzKSksCiAgICAgICAgICAgICAgICAgY2FwdGlvbiA9ICJEYXRvczogSXJpcyIpICsKICAgICAgICAgICAgYmxhbmtfdGhlbWUoKSArIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJyaWdodCIpICsKICAgICAgICAgICAgZ2VvbV9zZWdtZW50KGRhdGEgPSBhcnJvdy5wLCAKICAgICAgICAgICAgICAgICAgICAgICAgIGFlcyh4PTAsIHk9MCwgeGVuZCA9IE5NRFMxLCB5ZW5kID0gTk1EUzIsIGx0eSA9IFZhcmlhYmxlKSwgCiAgICAgICAgICAgICAgICAgICAgICAgICBhcnJvdyA9IGFycm93KGxlbmd0aCA9IHVuaXQoLjIsICJjbSIpKmFycm93LnAkUikgI0ZsZWNoYXMgZXNjYWxhZGFzIHNlZ8O6biBzdSBSXjIKICAgICAgICAgICAgICAgICAgICAgICAgICkKCm1kcy5wbG90CmBgYAo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("c14_comps_mv.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
