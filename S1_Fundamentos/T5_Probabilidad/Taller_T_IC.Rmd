---
title: "Tarea Intervalos de Confianza"
author: "Arturo"
output: html_notebook
---

## Tarea:
Para la tarea de esta semana cargarán el archivo `Datos1.csv` con el código aquí incluído y, de manera similar a como se vio durante la clase, realizarán la estimación de la media, la desviación estándar y los intervalos de confianza (utilizando cualquiera de las formas aquí vistas) para diferentes tamaños de muestra (ojo a la función `sample()`). El objetivo es ver cómo cambian tanto la estimación puntual como la amplitud de los intervalos al incrementar el tamaño de muestra.

Parte **OPCIONAL**:Si quieres desafiarte un poco más, considera alguna de las variables Dieta o Periodo como un "estrato" dentro de la población y realiza las estimaciones con esa consideración. Puedes también intentar presentar los resultados de manera gráfica (estratificados o no). Una alternativa es usar un gráfico KDE y mostrar los límites como líneas verticales, otra alternativa es un gráfico similar al que se presentó en clase, con el número de muestras en el eje x y un gráfico con líneas de error para el eje y. Este apartado OPCIONAL no tiene una "respuesta correcta" ni será considerado para la evaluación, así que puedes experimentar y presentar (o no) los resultados de la manera en que tú consideres se resuelven los objetivos.

```{r}
df <- read.table(file.choose(), header = F, skip = 1, sep = ",")
colnames(df) <- c("Dieta", "Periodo", "Rep", "LT", "PT")
head(df)
```
## Cálculo de los estadísticos
Accesar al data.frame:
```{r}
df[ , "PT"] == df[ , 5] 
df$PT == df[ , 5]
```

A la función mean debemos de pasarle un vector con los datos para los cuales queremos calcular la media
```{r}
# Media
mean(df[ , "PT"])
mean(df[ , 5])
mean(df$PT)
```

```{r}
# Desviación estándar
sd(df$PT)
```

Intervalos de confianza:
```{r}
t.test(df$PT)
Rmisc::CI(df$PT, ci = 0.95) 
rcompanion::groupwiseMean(PT~1, data = df)
```

Variable = PT
n  | media | sd | Lim Inf | Lim Sup
3  |
43 |
100|

Muestreo aleatorio
```{r}
sample(df$PT, size = 3, replace = F)
```

## Cuerpo
IC en un objeto
```{r}
ic1 <- t.test(df$PT)
lims <- ic1$conf.int
```

Concatenar: El resultado es un vector
```{r}
v1 <- c(158, mean(df$PT), sd(df$PT), lims[1], lims[2])
v1
```

Muestreos:

En varios objetos
```{r}
# Muestreos
mn1 <- sample(df$PT, size = 3, replace = F)
mn2 <- sample(df$PT, size = 50, replace = F)
mn3 <- sample(df$PT, size = 158, replace = F)

# ICs
icn1 <- t.test(mn1, conf.level = 0.95)$conf.int
icn2 <- t.test(mn2, conf.level = 0.95)$conf.int
icn3 <- t.test(mn3, conf.level = 0.95)$conf.int

# media con t.test
t.test(mn1, conf.level = 0.95)$estimate
```


Data.frame:
1) LLenado por renglones:
```{r}
tabla <- data.frame(n = 3, media = mean(x = mn1), sd = sd(mn1, na.rm = T), lim_inf = icn1[1], lim_sup = icn1[2])
tabla <- rbind(tabla,
               data.frame(n = 50, media = mean(x = mn2), sd = sd(mn2, na.rm = T), lim_inf = icn2[1], lim_sup = icn2[2]))
tabla <- rbind(tabla,
               data.frame(n = 158, media = mean(x = mn3), sd = sd(mn3, na.rm = T), lim_inf = icn3[1], lim_sup = icn3[2]))
tabla
```

2) Llenado por columnas:
```{r}
# Vectores que formarán cada una de las columnas
n <- c(3, 50, 158)
medias <- c(mean(mn1),
            mean(mn2),
            mean(df$PT)
            )
sds <- c(sd(mn1),
         sd(mn2),
         sd(df$PT)
        )
lims_inf <- c(icn1[1], icn2[1], icn3[1])
lims_sup <- c(icn1[2], icn2[2], icn3[2])

# Ensamble del data.frame final:
df.final <- data.frame(n = n, media = medias, sd = sds, lim_inf = lims_inf, lim_sup = lims_sup)
df.final

# Utilizando cbind:
df.cbind <- data.frame(n = n)
df.cbind <- cbind(df.cbind, medias)
df.cbind
```

En un solo objeto (data.frame)

n | PT
3 | 0.81
3 | 0.5
3 | 0.8
50|
.
.
.
158|
.
.
.

```{r}
muestreos <- c(mn1, mn2, mn3)
id <- c(rep("A", length(mn1)), rep("B", length(mn2)), rep("C", length(mn3)))

muestreos_id <- data.frame(n = id, PT = muestreos)
muestreos_id
```
```{r}
df.grupos <- rcompanion::groupwiseMean(PT~n, data = muestreos_id)
df.grupos
```

```{r}
df.grupos[ , 4] <- sds
colnames(df.grupos) <- c("id", "n", "media", "sd", "Lim_inf", "Lim_sup")
df.grupos[, -c(1)]
```

